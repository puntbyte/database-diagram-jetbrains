<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="./vite.svg"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>web</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();class dn{onMessage;constructor(e){this.onMessage=e,window.addEventListener("message",t=>{const n=t.data;n&&typeof n.type=="string"&&this.onMessage(n)}),this.send({type:"READY"})}send(e){const t=JSON.stringify(e);window.cefQuery?window.cefQuery({request:t}):console.log("Bridge Dev Log:",e)}log(e){this.send({type:"LOG",level:"INFO",message:e})}}function Fe(u){return u.replace(/[^a-zA-Z0-9_]/g,"_")}function fn(u){return u.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"")}function Ze(u){const e=new Map;if(!u)return e;const t=u.split(",").map(n=>n.trim()).filter(Boolean);for(let n of t)if(n.includes(":")){const[r,...a]=n.split(":");e.set(r.trim().toLowerCase(),a.join(":").trim())}else e.set(n.toLowerCase(),"true");return e}function hn(u){const e={},n=/Project\s*(?:(?:"[^"]*")|(?:[\w]+))?\s*\{([\s\S]*?)\}/i.exec(u);return n&&n[1].split(`
`).forEach(o=>{const d=o.split(":");if(d.length>=2){const s=d[0].trim();let p=d.slice(1).join(":").trim();(p.startsWith("'")&&p.endsWith("'")||p.startsWith('"')&&p.endsWith('"'))&&(p=p.substring(1,p.length-1)),!isNaN(Number(p))&&p!==""?e[s]=Number(p):e[s]=p}}),e}function gt(u){const e=[],t=u.split(`
`).map(n=>n.trim()).filter(Boolean);for(let n of t){const r=/^(\(?\s*[\w\.,\s]+\s*\)?)(?:\s*\[(.*?)\])?$/i.exec(n);if(!r)continue;const a=r[1].replace(/^\(/,"").replace(/\)$/,"").split(",").map(d=>d.trim()).filter(Boolean),o=Ze(r[2]||"");e.push({columns:a,settings:Object.fromEntries(o),raw:n})}return e}function kt(u,e,t){const n=t.split(",").map(b=>b.trim());let r=!1,a=!1,o=!1,d=!1,s,p,m,f;for(const b of n){/pk|primary key/i.test(b)&&(r=!0),/unique/i.test(b)&&(a=!0),/not null/i.test(b)&&(o=!0);const L=/note:\s*(['"])([\s\S]*?)\1/i.exec(b);L&&(s=L[2]);const C=/default:\s*(['`])?([\s\S]*?)\1?/i.exec(b);C&&(p=C[2]);const y=/ref:\s*(<>|[<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/i.exec(b);y&&(d=!0,f={symbol:y[1],toTable:y[2],toColumn:y[3]})}return{name:u,type:e,isPk:r,isUnique:a,isNotNull:o,isFk:d,note:s,default:p,enumValues:m,inlineRef:f}}function mn(u){const e=[],t=u.split(`
`);for(let n of t){if(n=n.trim(),!n||n.startsWith("Note"))continue;const a=/^("?[\w]+"?)\s+([a-zA-Z0-9_()]+)(?:\s*\[(.*?)\])?/.exec(n);a&&e.push(kt(a[1].replace(/"/g,""),a[2],a[3]||""))}return{fields:e}}function Bt(u,e,t,n,r){const a=d=>d.replace(/"/g,"");let o="1:n";return t==="<"?o="1:n":t===">"?o="n:1":t==="-"?o="1:1":t==="<>"&&(o="m:n"),{fromTable:Fe(a(u)),fromColumn:a(e),toTable:Fe(a(n)),toColumn:a(r),type:o}}function pn(u){const e=[],t=/("?[\w.]+"?)\.("?[\w"]+"?)\s*(<>|[<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/g,n=/Ref\s*[^{:]*[:\{]\s*([^}]+)\s*\}?/gi;let r;for(;(r=n.exec(u))!==null;){const a=r[1];let o;for(;(o=t.exec(a))!==null;)e.push(Bt(o[1],o[2],o[3],o[4],o[5]))}return e}function vn(u){const e=[],t=[],n=new Map,r=/TablePartial\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/gi;let a;for(;(a=r.exec(u))!==null;){const s=a[1].replace(/"/g,""),p=a[2]||"",m=a[3]||"",f=/indexes\s*\{([\s\S]*?)\}/i.exec(m);let b=[],L=m;f&&(b=gt(f[1]),L=m.replace(f[0],""));const{fields:C}=mn(L);n.set(s,{name:s,settings:Ze(p),fields:C,indexes:b})}const o=/Table\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*(?:as\s+\w+\s*)?\{([\s\S]*?)\}/gi;let d;for(;(d=o.exec(u))!==null;){const s=d[1].replace(/"/g,""),p=d[2]||"",m=d[3]||"",f=Ze(p),b=/indexes\s*\{([\s\S]*?)\}/i.exec(m);let L=[],C=m;b&&(L=gt(b[1]),C=m.replace(b[0],""));const y=C.split(`
`),h=new Map,T=[],$=new Map,A=new Map;for(let k of y){const x=k.trim();if(!x)continue;if(x.startsWith("~")){const E=x.replace(/^~\s*/,"").trim(),N=n.get(E);if(N){for(const[M,v]of N.settings.entries())A.set(M,v);for(const M of N.fields){if(h.has(M.name)){const v=T.indexOf(M.name);v!==-1&&T.splice(v,1)}h.set(M.name,M),T.push(M.name)}for(const M of N.indexes)$.set(M.columns.join("|").toLowerCase(),M)}continue}const S=/^("?[\w]+"?)\s+([a-zA-Z0-9_()]+)(?:\s*\[(.*?)\])?/.exec(x);if(S){const E=S[1].replace(/"/g,""),N=kt(E,S[2],S[3]||"");if(h.has(N.name)){const M=T.indexOf(N.name);M!==-1&&T.splice(M,1)}h.set(N.name,N),T.push(N.name)}}for(const k of L)$.set(k.columns.join("|").toLowerCase(),k);for(const[k,x]of f.entries())A.set(k,x);const B=T.map(k=>h.get(k)).filter(Boolean);B.forEach(k=>{k.inlineRef&&t.push(Bt(s,k.name,k.inlineRef.symbol,k.inlineRef.toTable,k.inlineRef.toColumn))});const R=/Note:\s*(['"])([\s\S]*?)\1/i.exec(m);e.push({id:Fe(s),name:s,fields:B,note:R?R[2]:void 0,color:A.get("color")||void 0,width:A.has("width")?parseInt(A.get("width"),10):void 0,x:A.has("x")?parseInt(A.get("x"),10):void 0,y:A.has("y")?parseInt(A.get("y"),10):void 0,settings:Object.fromEntries(A),indexes:Array.from($.values())})}return{tables:e,inlineRelationships:t}}class gn{parse(e){const t=fn(e),n=hn(t),{tables:r,inlineRelationships:a}=vn(t),o=pn(t),d=[...a,...o];return{tables:r,relationships:d,projectSettings:n}}}const Ot={Key:`
    <svg viewBox="0 0 24 24" width="100%" height="100%" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
    </svg>`,Table:`
    <svg viewBox="0 0 24 24" width="100%" height="100%" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="3" y1="9" x2="21" y2="9"></line>
        <line x1="9" y1="21" x2="9" y2="9"></line>
    </svg>`};class yn{static create(e,t){const n=document.createElement("div");n.className="db-row",n.id=`col-${t}-${e.name}`,e.isUnique&&n.classList.add("indexed-row");const r=document.createElement("div");r.className="row-left";const a=document.createElement("span");a.className="key-icon",e.isPk||e.isFk?(a.innerHTML=Ot.Key,e.isPk&&e.isFk?(a.classList.add("pk-fk"),a.title="Primary & Foreign Key"):e.isPk?(a.classList.add("pk"),a.title="Primary Key"):(a.classList.add("fk"),a.title="Foreign Key")):a.classList.add("empty"),r.appendChild(a);const o=document.createElement("div");o.className="name-container";const d=document.createElement("span");if(d.className="field-name",d.innerText=e.name,o.appendChild(d),e.note){const f=document.createElement("div");f.className="field-note",f.innerText=e.note,o.appendChild(f)}r.appendChild(o);const s=document.createElement("div");s.className="row-right";const p=document.createElement("div");p.className="type-container";const m=document.createElement("span");if(m.className="field-type",e.isUnique&&m.classList.add("constrained-type"),m.innerText=e.type,p.appendChild(m),e.enumValues&&e.enumValues.length>0){const f=this.createBadge("ENUM","enum");f.title=`Enum values: ${e.enumValues.join(", ")}`,s.appendChild(f)}if(e.isUnique&&s.appendChild(this.createBadge("UQ","unique")),e.isNotNull&&s.appendChild(this.createBadge("NN","not-null")),e.default){const f=document.createElement("div");f.className="field-default",f.innerText=`default: ${e.default}`,p.appendChild(f)}return s.appendChild(p),n.appendChild(r),n.appendChild(s),n}static createBadge(e,t){const n=document.createElement("span");return n.className=`badge ${t}`,n.innerText=e,n}}class wn{static create(e){const t=document.createElement("div");t.className="db-table",t.id=`table-${e.id}`,t.dataset.tableName=e.name,e.width&&(t.style.width=`${e.width}px`);const n=document.createElement("div");n.className="db-table-header",e.color&&(n.style.backgroundColor=e.color);const[r,a]=e.name.includes(".")?e.name.split("."):["",e.name],o=document.createElement("div");o.className="header-title-wrapper";const d=document.createElement("span");d.className="table-icon",d.innerHTML=Ot.Table,o.appendChild(d);const s=document.createElement("span");s.className="title",s.innerText=a,o.appendChild(s),n.appendChild(o);const p=document.createElement("span");if(p.className="schema-banner",p.innerText=r||"public",n.appendChild(p),e.note){const f=document.createElement("div");f.className="table-note",f.innerText=e.note,n.appendChild(f)}t.appendChild(n),e.fields.forEach(f=>{t.appendChild(yn.create(f,e.id))});const m=document.createElement("div");return m.className="resize-handle",m.title="Drag to resize",t.appendChild(m),t}}class xn{static MIN_STRAIGHT=15;static MAX_STRAIGHT=40;static LABEL_OFFSET=25;static calculatePath(e,t,n,r,a,o,d="Curve"){const s=e.y+e.height/2,p=t.y+t.height/2,m={x:e.x+e.width,y:s},f={x:e.x,y:s},b={x:t.x+t.width,y:p},L={x:t.x,y:p},C=e.x<t.x+t.width&&e.x+e.width>t.x;let y,h,T,$;C?(y=m,h=b,T=1,$=1):e.x<t.x?(y=m,h=L,T=1,$=-1):(y=f,h=b,T=-1,$=1);const A=Math.abs(h.x-y.x),B=Math.max(this.MIN_STRAIGHT,Math.min(this.MAX_STRAIGHT,A/3)),R={x:y.x+B*T,y:y.y},k={x:h.x+B*$,y:h.y};if(C){const E=Math.max(40,Math.abs(h.y-y.y)*.4);R.x=Math.max(y.x,h.x)+E,k.x=R.x}let x="";switch(d){case"Rectilinear":case"RoundRectilinear":{const E=(R.x+k.x)/2,N={x:E,y:y.y},M={x:E,y:h.y};if(d==="Rectilinear")x=`M ${y.x} ${y.y} L ${N.x} ${N.y} L ${M.x} ${M.y} L ${h.x} ${h.y}`;else{const v=Math.min(15,Math.abs(M.y-N.y)/2,Math.abs(N.x-y.x)/2),Y=h.y>y.y?1:-1,G=N.x>y.x?1:-1,V=h.x>M.x?1:-1;x=`M ${y.x} ${y.y} 
               L ${N.x-v*G} ${N.y} 
               Q ${N.x} ${N.y} ${N.x} ${N.y+v*Y} 
               L ${M.x} ${M.y-v*Y} 
               Q ${M.x} ${M.y} ${M.x+v*V} ${M.y} 
               L ${h.x} ${h.y}`}break}case"Oblique":case"RoundOblique":{d==="Oblique"?x=`M ${y.x} ${y.y} L ${R.x} ${R.y} L ${k.x} ${k.y} L ${h.x} ${h.y}`:x=`M ${y.x} ${y.y} 
               L ${R.x} ${R.y} 
               Q ${(R.x+k.x)/2} ${(R.y+k.y)/2} ${k.x} ${k.y} 
               L ${h.x} ${h.y}`;break}default:{x=`M ${y.x} ${y.y} C ${R.x} ${R.y}, ${k.x} ${k.y}, ${h.x} ${h.y}`;break}}const w=this.getLabelPos(y,R),S=this.getLabelPos(h,k);return{d:x,start:y,end:h,labelStart:w,labelEnd:S,fromId:n,toId:r,fromTableId:a,toTableId:o}}static getLabelPos(e,t){const n=t.x-e.x,r=t.y-e.y,a=Math.sqrt(n*n+r*r),o=this.LABEL_OFFSET/(a||1);return{x:e.x+n*o,y:e.y+r*o}}}class bn{static createGroup(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","g");n.classList.add("connection-group"),n.dataset.from=e.fromId,n.dataset.to=e.toId,n.dataset.fromTable=e.fromTableId,n.dataset.toTable=e.toTableId;const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",e.d),r.classList.add("relation-hit-area"),n.appendChild(r);const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",e.d),a.classList.add("relation-line-base"),n.appendChild(a);const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",e.d),o.classList.add("relation-line-flow"),n.appendChild(o),this.createLabels(e,t).forEach(s=>n.appendChild(s)),n}static createLabels(e,t){const n=this.getLabelText(t);return n?[this.createLabelBadge(n.from,e.labelStart.x,e.labelStart.y),this.createLabelBadge(n.to,e.labelEnd.x,e.labelEnd.y)]:[]}static createLabelBadge(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","g");r.classList.add("relation-label-group");const a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(t-9).toString()),a.setAttribute("y",(n-7).toString()),a.setAttribute("width","18"),a.setAttribute("height","14"),a.setAttribute("rx","4"),a.classList.add("label-bg");const o=document.createElementNS("http://www.w3.org/2000/svg","text");return o.setAttribute("x",t.toString()),o.setAttribute("y",(n+1).toString()),o.classList.add("relation-label-text"),o.textContent=e,r.appendChild(a),r.appendChild(o),r}static getLabelText(e){switch(e){case"1:n":return{from:"1",to:"n"};case"n:1":return{from:"n",to:"1"};case"1:1":return{from:"1",to:"1"};case"m:n":return{from:"m",to:"n"};default:return null}}}class yt{static create(e){const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx",e.x.toString()),t.setAttribute("cy",e.y.toString()),t.setAttribute("r","3.5"),t.classList.add("anchor-port"),t}}class wt{svgLayer;scale=1;container;currentRelationships=[];currentLineStyle="Curve";constructor(e){this.container=e,this.svgLayer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgLayer.classList.add("connection-layer"),e.appendChild(this.svgLayer),this.setupInteractions()}updateScale(e){this.scale=e}setLineStyle(e){this.currentLineStyle=e,this.draw(this.currentRelationships)}draw(e){this.currentRelationships=e,this.svgLayer.innerHTML="",e.forEach(t=>this.drawOne(t))}drawOne(e){const t=`col-${e.fromTable}-${e.fromColumn}`,n=`col-${e.toTable}-${e.toColumn}`,r=document.getElementById(t),a=document.getElementById(n);if(!r||!a)return;const o=this.getRelativeRect(r),d=this.getRelativeRect(a),s=xn.calculatePath(o,d,t,n,`table-${e.fromTable}`,`table-${e.toTable}`,this.currentLineStyle),p=bn.createGroup(s,e.type);this.svgLayer.appendChild(p);const m=yt.create(s.start);m.dataset.anchorId=t,this.svgLayer.appendChild(m);const f=yt.create(s.end);f.dataset.anchorId=n,this.svgLayer.appendChild(f)}getRelativeRect(e){const t=e.getBoundingClientRect(),n=this.svgLayer.getBoundingClientRect();return{x:(t.left-n.left)/this.scale,y:(t.top-n.top)/this.scale,width:t.width/this.scale,height:t.height/this.scale}}setupInteractions(){this.container.addEventListener("mouseover",e=>this.handleHover(e,!0)),this.container.addEventListener("mouseout",e=>this.handleHover(e,!1))}handleHover(e,t){if(!t){this.clearHighlights();return}const n=e.target,r=n.closest(".connection-group");if(r){this.activateConnection(r);return}const a=n.closest(".db-row");if(a&&a.id){this.activateColumn(a.id);return}const o=n.closest(".db-table");if(o&&o.id){this.activateTable(o.id);return}}clearHighlights(){document.querySelectorAll(".highlighted").forEach(t=>t.classList.remove("highlighted"))}activateConnection(e){e.classList.add("highlighted");const t=e.dataset.from,n=e.dataset.to;t&&this.setHighlight(t),n&&this.setHighlight(n),this.highlightAnchorsForLine(t,n)}activateColumn(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from="${e}"], [data-to="${e}"]`).forEach(n=>{n.classList.add("highlighted");const r=n;r.dataset.from!==e&&this.setHighlight(r.dataset.from),r.dataset.to!==e&&this.setHighlight(r.dataset.to),this.highlightAnchorsForLine(r.dataset.from,r.dataset.to)})}activateTable(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from-table="${e}"], [data-to-table="${e}"]`).forEach(n=>{n.classList.add("highlighted");const r=n;this.setHighlight(r.dataset.from),this.setHighlight(r.dataset.to),this.highlightAnchorsForLine(r.dataset.from,r.dataset.to)})}setHighlight(e){if(!e)return;const t=document.getElementById(e);t&&t.classList.add("highlighted")}highlightAnchorsForLine(e,t){e&&this.svgLayer.querySelectorAll(`[data-anchor-id="${e}"]`).forEach(r=>r.classList.add("highlighted")),t&&this.svgLayer.querySelectorAll(`[data-anchor-id="${t}"]`).forEach(r=>r.classList.add("highlighted"))}}class Sn{activeEl=null;mode="NONE";initialMouse={x:0,y:0};initialVal={x:0,y:0,width:0};scale=1;relationships=[];connectionManager;onUpdate;constructor(e,t,n){this.connectionManager=t,this.onUpdate=n,e.addEventListener("mousedown",r=>this.onMouseDown(r)),window.addEventListener("mousemove",r=>this.onMouseMove(r)),window.addEventListener("mouseup",()=>this.onMouseUp())}updateConnectionManager(e){this.connectionManager=e}setRelationships(e){this.relationships=e}updateScale(e){this.scale=e}onMouseDown(e){const t=e.target;if(t.classList.contains("resize-handle")){const r=t.closest(".db-table");r&&this.startResize(r,e);return}const n=t.closest(".db-table-header");if(n){const r=n.parentElement;r&&this.startDrag(r,e);return}}startDrag(e,t){this.mode="DRAG",this.activeEl=e,this.initialVal.x=e.offsetLeft,this.initialVal.y=e.offsetTop,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("dragging")}startResize(e,t){this.mode="RESIZE",this.activeEl=e,this.initialVal.width=e.offsetWidth,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("resizing"),document.body.style.cursor="col-resize"}onMouseMove(e){if(this.activeEl){if(this.mode==="DRAG"){const t=(e.clientX-this.initialMouse.x)/this.scale,n=(e.clientY-this.initialMouse.y)/this.scale;this.activeEl.style.left=`${this.initialVal.x+t}px`,this.activeEl.style.top=`${this.initialVal.y+n}px`,this.activeEl.style.transform="none",this.connectionManager.draw(this.relationships)}else if(this.mode==="RESIZE"){const t=(e.clientX-this.initialMouse.x)/this.scale,n=Math.max(200,this.initialVal.width+t);this.activeEl.style.width=`${n}px`,this.connectionManager.draw(this.relationships)}}}onMouseUp(){if(!this.activeEl)return;const e=this.activeEl,t=e.querySelector(".title"),n=e.dataset&&e.dataset.tableName||(t?t.textContent||"":e.id.replace("table-",""));if(n){const r=Math.round(parseInt(e.style.left||"0",10)),a=Math.round(parseInt(e.style.top||"0",10)),o=Math.round(e.getBoundingClientRect().width/this.scale);this.onUpdate(n,r,a,o)}e.classList.remove("dragging"),e.classList.remove("resizing"),document.body.style.cursor="",this.activeEl=null,this.mode="NONE"}}function En(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var le={exports:{}},xt;function Mn(){if(xt)return le.exports;xt=1,le.exports=u,le.exports.addWheelListener=u,le.exports.removeWheelListener=e;function u(t,n,r){t.addEventListener("wheel",n,r)}function e(t,n,r){t.removeEventListener("wheel",n,r)}return le.exports}var ue={exports:{}},$e,bt;function Tn(){if(bt)return $e;bt=1;var u=4,e=.001,t=1e-7,n=10,r=11,a=1/(r-1),o=typeof Float32Array=="function";function d(y,h){return 1-3*h+3*y}function s(y,h){return 3*h-6*y}function p(y){return 3*y}function m(y,h,T){return((d(h,T)*y+s(h,T))*y+p(h))*y}function f(y,h,T){return 3*d(h,T)*y*y+2*s(h,T)*y+p(h)}function b(y,h,T,$,A){var B,R,k=0;do R=h+(T-h)/2,B=m(R,$,A)-y,B>0?T=R:h=R;while(Math.abs(B)>t&&++k<n);return R}function L(y,h,T,$){for(var A=0;A<u;++A){var B=f(h,T,$);if(B===0)return h;var R=m(h,T,$)-y;h-=R/B}return h}function C(y){return y}return $e=function(h,T,$,A){if(!(0<=h&&h<=1&&0<=$&&$<=1))throw new Error("bezier x values must be in [0, 1] range");if(h===T&&$===A)return C;for(var B=o?new Float32Array(r):new Array(r),R=0;R<r;++R)B[R]=m(R*a,h,$);function k(x){for(var w=0,S=1,E=r-1;S!==E&&B[S]<=x;++S)w+=a;--S;var N=(x-B[S])/(B[S+1]-B[S]),M=w+N*a,v=f(M,h,$);return v>=e?L(x,M,h,$):v===0?M:b(x,w,w+a,h,$)}return function(w){return w===0?0:w===1?1:m(k(w),T,A)}},$e}var St;function Ln(){if(St)return ue.exports;St=1;var u=Tn(),e={ease:u(.25,.1,.25,1),easeIn:u(.42,0,1,1),easeOut:u(0,0,.58,1),easeInOut:u(.42,0,.58,1),linear:u(0,0,1,1)};ue.exports=t,ue.exports.makeAggregateRaf=d,ue.exports.sharedScheduler=d();function t(s,p,m){var f=Object.create(null),b=Object.create(null);m=m||{};var L=typeof m.easing=="function"?m.easing:e[m.easing];L||(m.easing&&console.warn("Unknown easing function in amator: "+m.easing),L=e.ease);var C=typeof m.step=="function"?m.step:n,y=typeof m.done=="function"?m.done:n,h=r(m.scheduler),T=Object.keys(p);T.forEach(function(S){f[S]=s[S],b[S]=p[S]-s[S]});var $=typeof m.duration=="number"?m.duration:400,A=Math.max(1,$*.06),B,R=0;return B=h.next(x),{cancel:k};function k(){h.cancel(B),B=0}function x(){var S=L(R/A);R+=1,w(S),R<=A?(B=h.next(x),C(s)):(B=0,setTimeout(function(){y(s)},0))}function w(S){T.forEach(function(E){s[E]=b[E]*S+f[E]})}}function n(){}function r(s){if(!s){var p=typeof window<"u"&&window.requestAnimationFrame;return p?a():o()}if(typeof s.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof s.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return s}function a(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function o(){return{next:function(s){return setTimeout(s,1e3/60)},cancel:function(s){return clearTimeout(s)}}}function d(){var s=new Set,p=new Set,m=0;return{next:b,cancel:b,clearAll:f};function f(){s.clear(),p.clear(),cancelAnimationFrame(m),m=0}function b(y){p.add(y),L()}function L(){m||(m=requestAnimationFrame(C))}function C(){m=0;var y=p;p=s,s=y,s.forEach(function(h){h()}),s.clear()}}return ue.exports}var ze,Et;function Cn(){if(Et)return ze;Et=1;function u(n){t(n);const r=e(n);return n.on=r.on,n.off=r.off,n.fire=r.fire,n}function e(n){let r=Object.create(null);return{on:function(a,o,d){if(typeof o!="function")throw new Error("callback is expected to be a function");let s=r[a];return s||(s=r[a]=[]),s.push({callback:o,ctx:d}),n},off:function(a,o){if(typeof a>"u")return r=Object.create(null),n;if(r[a])if(typeof o!="function")delete r[a];else{const d=r[a];for(let s=0;s<d.length;++s)d[s].callback===o&&d.splice(s,1)}return n},fire:function(a){const o=r[a];if(!o)return n;let d;arguments.length>1&&(d=Array.prototype.slice.call(arguments,1));for(let s=0;s<o.length;++s){const p=o[s];p.callback.apply(p.ctx,d)}return n}}}function t(n){if(!n)throw new Error("Eventify cannot use falsy object as events subject");const r=["on","fire","off"];for(let a=0;a<r.length;++a)if(n.hasOwnProperty(r[a]))throw new Error("Subject cannot be eventified, since it already has property '"+r[a]+"'")}return ze=u,ze}var Ie,Mt;function Nn(){if(Mt)return Ie;Mt=1,Ie=u;function u(n,r,a){typeof a!="object"&&(a={});var o=typeof a.minVelocity=="number"?a.minVelocity:5,d=typeof a.amplitude=="number"?a.amplitude:.25,s=typeof a.cancelAnimationFrame=="function"?a.cancelAnimationFrame:e(),p=typeof a.requestAnimationFrame=="function"?a.requestAnimationFrame:t(),m,f,b=342,L,C,y,h,T,$,A,B;return{start:k,stop:w,cancel:R};function R(){s(L),s(B)}function k(){m=n(),h=A=C=T=0,f=new Date,s(L),s(B),L=p(x)}function x(){var E=Date.now(),N=E-f;f=E;var M=n(),v=M.x-m.x,Y=M.y-m.y;m=M;var G=1e3/(1+N);C=.8*v*G+.2*C,T=.8*Y*G+.2*T,L=p(x)}function w(){s(L),s(B);var E=n();y=E.x,$=E.y,f=Date.now(),(C<-o||C>o)&&(h=d*C,y+=h),(T<-o||T>o)&&(A=d*T,$+=A),B=p(S)}function S(){var E=Date.now()-f,N=!1,M=0,v=0;h&&(M=-h*Math.exp(-E/b),M>.5||M<-.5?N=!0:M=h=0),A&&(v=-A*Math.exp(-E/b),v>.5||v<-.5?N=!0:v=A=0),N&&(r(y+M,$+v),B=p(S))}}function e(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function t(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(n){return setTimeout(n,16)}}return Ie}var De,Tt;function An(){if(Tt)return De;Tt=1,De=u;function u(n){if(n)return{capture:t,release:t};var r,a,o,d=!1;return{capture:s,release:p};function s(m){d=!0,a=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=e,r=m,r.ondragstart=e}function p(){d&&(d=!1,window.document.onselectstart=a,r&&(r.ondragstart=o))}}function e(n){return n.stopPropagation(),!1}function t(){}return De}var qe,Lt;function Rn(){if(Lt)return qe;Lt=1,qe=u;function u(){this.x=0,this.y=0,this.scale=1}return qe}var we={exports:{}},Ct;function kn(){if(Ct)return we.exports;Ct=1,we.exports=u,we.exports.canAttach=e;function u(t,n){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var r=t.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");n.disableKeyboardInteraction||r.setAttribute("tabindex",0);var a={getBBox:d,getScreenCTM:s,getOwner:o,applyTransform:m,initTransform:p};return a;function o(){return r}function d(){var f=t.getBBox();return{left:f.x,top:f.y,width:f.width,height:f.height}}function s(){var f=r.getCTM();return f||r.getScreenCTM()}function p(f){var b=t.getCTM();b===null&&(b=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),f.x=b.e,f.y=b.f,f.scale=b.a,r.removeAttributeNS(null,"viewBox")}function m(f){t.setAttribute("transform","matrix("+f.scale+" 0 0 "+f.scale+" "+f.x+" "+f.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return we.exports}var xe={exports:{}},Nt;function Bn(){if(Nt)return xe.exports;Nt=1,xe.exports=u,xe.exports.canAttach=e;function u(t,n){var r=e(t);if(!r)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var a=t.parentElement;t.scrollTop=0,n.disableKeyboardInteraction||a.setAttribute("tabindex",0);var o={getBBox:s,getOwner:d,applyTransform:p};return o;function d(){return a}function s(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function p(m){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+m.scale+", 0, 0, "+m.scale+", "+m.x+", "+m.y+")"}}function e(t){return t&&t.parentElement&&t.style}return xe.exports}var Pe,At;function On(){if(At)return Pe;At=1;var u=Mn(),e=Ln(),t=Cn(),n=Nn(),r=An(),a=r(),o=r(!0),d=Rn(),s=kn(),p=Bn(),m=1,f=1.75,b=300,L=200;Pe=C;function C(x,w){w=w||{};var S=w.controller;if(S||(s.canAttach(x)?S=s(x,w):p.canAttach(x)&&(S=p(x,w))),!S)throw new Error("Cannot create panzoom for the current type of dom element");var E=S.getOwner(),N={x:0,y:0},M=!1,v=new d;S.initTransform&&S.initTransform(v);var Y=typeof w.filterKey=="function"?w.filterKey:T,G=typeof w.pinchSpeed=="number"?w.pinchSpeed:1,V=w.bounds,D=typeof w.maxZoom=="number"?w.maxZoom:Number.POSITIVE_INFINITY,P=typeof w.minZoom=="number"?w.minZoom:0,F=typeof w.boundsPadding=="number"?w.boundsPadding:.05,Z=typeof w.zoomDoubleClickSpeed=="number"?w.zoomDoubleClickSpeed:f,Se=w.beforeWheel||T,te=w.beforeMouseDown||T,Ee=typeof w.zoomSpeed=="number"?w.zoomSpeed:m,W=y(w.transformOrigin),Me=w.enableTextSelection?o:a;$(V),w.autocenter&&Pt();var ne,je=0,_e=0,re=0,He=null,Ye=new Date,Te,ie=!1,ae=!1,j,_,Le,Ce,Ne,H;"smoothScroll"in w&&!w.smoothScroll?H=R():H=n(Gt,en,w.smoothScroll);var Ae,oe,de,fe=!1;Qe();var he={dispose:tn,moveBy:Q,moveTo:Re,smoothMoveTo:Jt,centerOn:Qt,zoomTo:ge,zoomAbs:me,smoothZoom:ve,smoothZoomAbs:ln,showRectangle:qt,pause:zt,resume:It,isPaused:Dt,getTransform:Ft,getMinZoom:Zt,setMinZoom:jt,getMaxZoom:_t,setMaxZoom:Ht,getTransformOrigin:Yt,setTransformOrigin:Vt,getZoomSpeed:Wt,setZoomSpeed:Ut};t(he);var Ve=typeof w.initialX=="number"?w.initialX:v.x,We=typeof w.initialY=="number"?w.initialY:v.y,Ue=typeof w.initialZoom=="number"?w.initialZoom:v.scale;return(Ve!=v.x||We!=v.y||Ue!=v.scale)&&me(Ve,We,Ue),he;function zt(){Je(),fe=!0}function It(){fe&&(Qe(),fe=!1)}function Dt(){return fe}function qt(i){var c=E.getBoundingClientRect(),l=X(c.width,c.height),g=i.right-i.left,O=i.bottom-i.top;if(!Number.isFinite(g)||!Number.isFinite(O))throw new Error("Invalid rectangle");var z=l.x/g,I=l.y/O,q=Math.min(z,I);v.x=-(i.left+g/2)*q+l.x/2,v.y=-(i.top+O/2)*q+l.y/2,v.scale=q}function X(i,c){if(S.getScreenCTM){var l=S.getScreenCTM(),g=l.a,O=l.d,z=l.e,I=l.f;N.x=i*g-z,N.y=c*O-I}else N.x=i,N.y=c;return N}function Pt(){var i,c,l=0,g=0,O=Xe();if(O)l=O.left,g=O.top,i=O.right-O.left,c=O.bottom-O.top;else{var z=E.getBoundingClientRect();i=z.width,c=z.height}var I=S.getBBox();if(!(I.width===0||I.height===0)){var q=c/I.height,ee=i/I.width,K=Math.min(ee,q);v.x=-(I.left+I.width/2)*K+i/2+l,v.y=-(I.top+I.height/2)*K+c/2+g,v.scale=K}}function Ft(){return v}function Zt(){return P}function jt(i){P=i}function _t(){return D}function Ht(i){D=i}function Yt(){return W}function Vt(i){W=y(i)}function Wt(){return Ee}function Ut(i){if(!Number.isFinite(i))throw new Error("Zoom speed should be a number");Ee=i}function Gt(){return{x:v.x,y:v.y}}function Re(i,c){v.x=i,v.y=c,ke(),J("pan"),Be()}function Ge(i,c){Re(v.x+i,v.y+c)}function ke(){var i=Xe();if(i){var c=!1,l=Xt(),g=i.left-l.right;return g>0&&(v.x+=g,c=!0),g=i.right-l.left,g<0&&(v.x+=g,c=!0),g=i.top-l.bottom,g>0&&(v.y+=g,c=!0),g=i.bottom-l.top,g<0&&(v.y+=g,c=!0),c}}function Xe(){if(V){if(typeof V=="boolean"){var i=E.getBoundingClientRect(),c=i.width,l=i.height;return{left:c*F,top:l*F,right:c*(1-F),bottom:l*(1-F)}}return V}}function Xt(){var i=S.getBBox(),c=Kt(i.left,i.top);return{left:c.x,top:c.y,right:i.width*v.scale+c.x,bottom:i.height*v.scale+c.y}}function Kt(i,c){return{x:i*v.scale+v.x,y:c*v.scale+v.y}}function Be(){M=!0,ne=window.requestAnimationFrame(nn)}function Ke(i,c,l){if(B(i)||B(c)||B(l))throw new Error("zoom requires valid numbers");var g=v.scale*l;if(g<P){if(v.scale===P)return;l=P/v.scale}if(g>D){if(v.scale===D)return;l=D/v.scale}var O=X(i,c);if(v.x=O.x-l*(O.x-v.x),v.y=O.y-l*(O.y-v.y),V&&F===1&&P===1)v.scale*=l,ke();else{var z=ke();z||(v.scale*=l)}J("zoom"),Be()}function me(i,c,l){var g=l/v.scale;Ke(i,c,g)}function Qt(i){var c=i.ownerSVGElement;if(!c)throw new Error("ui element is required to be within the scene");var l=i.getBoundingClientRect(),g=l.left+l.width/2,O=l.top+l.height/2,z=c.getBoundingClientRect(),I=z.width/2-g,q=z.height/2-O;Q(I,q,!0)}function Jt(i,c){Q(i-v.x,c-v.y,!0)}function Q(i,c,l){if(!l)return Ge(i,c);Ae&&Ae.cancel();var g={x:0,y:0},O={x:i,y:c},z=0,I=0;Ae=e(g,O,{step:function(q){Ge(q.x-z,q.y-I),z=q.x,I=q.y}})}function en(i,c){ye(),Re(i,c)}function tn(){Je()}function Qe(){E.addEventListener("mousedown",st,{passive:!1}),E.addEventListener("dblclick",ot,{passive:!1}),E.addEventListener("touchstart",tt,{passive:!1}),E.addEventListener("keydown",et,{passive:!1}),u.addWheelListener(E,ft,{passive:!1}),Be()}function Je(){u.removeWheelListener(E,ft),E.removeEventListener("mousedown",st),E.removeEventListener("keydown",et),E.removeEventListener("dblclick",ot),E.removeEventListener("touchstart",tt),ne&&(window.cancelAnimationFrame(ne),ne=0),H.cancel(),ut(),dt(),Me.release(),Oe()}function nn(){M&&rn()}function rn(){M=!1,S.applyTransform(v),J("transform"),ne=0}function et(i){var c=0,l=0,g=0;if(i.keyCode===38?l=1:i.keyCode===40?l=-1:i.keyCode===37?c=1:i.keyCode===39?c=-1:i.keyCode===189||i.keyCode===109?g=1:(i.keyCode===187||i.keyCode===107)&&(g=-1),!Y(i,c,l,g)){if(c||l){i.preventDefault(),i.stopPropagation();var O=E.getBoundingClientRect(),z=Math.min(O.width,O.height),I=.05,q=z*I*c,ee=z*I*l;Q(q,ee)}if(g){var K=ht(g*100),z=W?ce():an();ge(z.x,z.y,K)}}}function an(){var i=E.getBoundingClientRect();return{x:i.width/2,y:i.height/2}}function tt(i){if(on(i),se(),i.touches.length===1)return cn(i,i.touches[0]);i.touches.length===2&&(Ne=at(i.touches[0],i.touches[1]),de=!0,nt())}function on(i){w.onTouch&&!w.onTouch(i)||(i.stopPropagation(),i.preventDefault())}function sn(i){se(),!(w.onDoubleClick&&!w.onDoubleClick(i))&&(i.preventDefault(),i.stopPropagation())}function cn(i){_e=new Date;var c=i.touches[0],l=U(c);Te=l;var g=X(l.x,l.y);j=g.x,_=g.y,Le=j,Ce=_,H.cancel(),nt()}function nt(){ie||(ie=!0,document.addEventListener("touchmove",rt),document.addEventListener("touchend",pe),document.addEventListener("touchcancel",pe))}function rt(i){if(i.touches.length===1){i.stopPropagation();var c=i.touches[0],l=U(c),g=X(l.x,l.y),O=g.x-j,z=g.y-_;O!==0&&z!==0&&mt(),j=g.x,_=g.y,Q(O,z)}else if(i.touches.length===2){de=!0;var I=i.touches[0],q=i.touches[1],ee=at(I,q),K=1+(ee/Ne-1)*G,pt=U(I),vt=U(q);if(j=(pt.x+vt.x)/2,_=(pt.y+vt.y)/2,W){var l=ce();j=l.x,_=l.y}ge(j,_,K),Ne=ee,i.stopPropagation(),i.preventDefault()}}function se(){re&&(clearTimeout(re),re=0)}function it(i){if(w.onClick){se();var c=j-Le,l=_-Ce,g=Math.sqrt(c*c+l*l);g>5||(re=setTimeout(function(){re=0,w.onClick(i)},b))}}function pe(i){if(se(),i.touches.length>0){var c=U(i.touches[0]),l=X(c.x,c.y);j=l.x,_=l.y}else{var g=new Date;if(g-je<b)if(W){var c=ce();ve(c.x,c.y,Z)}else ve(Te.x,Te.y,Z);else g-_e<L&&it(i);je=g,Oe(),dt()}}function at(i,c){var l=i.clientX-c.clientX,g=i.clientY-c.clientY;return Math.sqrt(l*l+g*g)}function ot(i){sn(i);var c=U(i);W&&(c=ce()),ve(c.x,c.y,Z)}function st(i){if(se(),!te(i)){if(He=i,Ye=new Date,ie)return i.stopPropagation(),!1;var c=i.button===1&&window.event!==null||i.button===0;if(c){H.cancel();var l=U(i),g=X(l.x,l.y);return Le=j=g.x,Ce=_=g.y,document.addEventListener("mousemove",ct),document.addEventListener("mouseup",lt),Me.capture(i.target||i.srcElement),!1}}}function ct(i){if(!ie){mt();var c=U(i),l=X(c.x,c.y),g=l.x-j,O=l.y-_;j=l.x,_=l.y,Q(g,O)}}function lt(){var i=new Date;i-Ye<L&&it(He),Me.release(),Oe(),ut()}function ut(){document.removeEventListener("mousemove",ct),document.removeEventListener("mouseup",lt),ae=!1}function dt(){document.removeEventListener("touchmove",rt),document.removeEventListener("touchend",pe),document.removeEventListener("touchcancel",pe),ae=!1,de=!1,ie=!1}function ft(i){if(!Se(i)){H.cancel();var c=i.deltaY;i.deltaMode>0&&(c*=100);var l=ht(c);if(l!==1){var g=W?ce():U(i);ge(g.x,g.y,l),i.preventDefault()}}}function U(i){var c,l,g=E.getBoundingClientRect();return c=i.clientX-g.left,l=i.clientY-g.top,{x:c,y:l}}function ve(i,c,l){var g=v.scale,O={scale:g},z={scale:l*g};H.cancel(),ye(),oe=e(O,z,{step:function(I){me(i,c,I.scale)},done:un})}function ln(i,c,l){var g=v.scale,O={scale:g},z={scale:l};H.cancel(),ye(),oe=e(O,z,{step:function(I){me(i,c,I.scale)}})}function ce(){var i=E.getBoundingClientRect();return{x:i.width*W.x,y:i.height*W.y}}function ge(i,c,l){return H.cancel(),ye(),Ke(i,c,l)}function ye(){oe&&(oe.cancel(),oe=null)}function ht(i){var c=Math.sign(i),l=Math.min(.25,Math.abs(Ee*i/128));return 1-c*l}function mt(){ae||(J("panstart"),ae=!0,H.start())}function Oe(){ae&&(de||H.stop(),J("panend"))}function un(){J("zoomend")}function J(i){he.fire(i,he)}}function y(x){if(x){if(typeof x=="object")return(!A(x.x)||!A(x.y))&&h(x),x;h()}}function h(x){throw console.error(x),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function T(){}function $(x){var w=typeof x;if(!(w==="undefined"||w==="boolean")){var S=A(x.left)&&A(x.top)&&A(x.bottom)&&A(x.right);if(!S)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function A(x){return Number.isFinite(x)}function B(x){return Number.isNaN?Number.isNaN(x):x!==x}function R(){return{start:T,stop:T,cancel:T}}function k(){if(typeof document>"u")return;var x=document.getElementsByTagName("script");if(!x)return;for(var w,S=0;S<x.length;++S){var E=x[S];if(E.src&&E.src.match(/\bpanzoom(\.min)?\.js/)){w=E;break}}if(!w)return;var N=w.getAttribute("query");if(!N)return;var M=w.getAttribute("name")||"pz",v=Date.now();Y();function Y(){var D=document.querySelector(N);if(!D){var P=Date.now(),F=P-v;if(F<2e3){setTimeout(Y,100);return}console.error("Cannot find the panzoom element",M);return}var Z=G(w);console.log(Z),window[M]=C(D,Z)}function G(D){for(var P=D.attributes,F={},Z=0;Z<P.length;++Z){var Se=P[Z],te=V(Se);te&&(F[te.name]=te.value)}return F}function V(D){if(D.name){var P=D.name[0]==="p"&&D.name[1]==="z"&&D.name[2]==="-";if(P){var F=D.name.substr(3),Z=JSON.parse(D.value);return{name:F,value:Z}}}}}return k(),Pe}var $n=On();const zn=En($n);class In{pz;currentScale=1;currentX=0;currentY=0;constructor(e,t,n){this.pz=zn(e,{maxZoom:3,minZoom:.2,bounds:!1,beforeMouseDown:d=>d.target.closest(".db-table")!==null});const r=d=>{const s=d.getTransform();this.currentScale=s.scale,this.currentX=s.x||0,this.currentY=s.y||0,t(this.currentScale),n&&n(this.currentScale,this.currentX,this.currentY)};this.pz.on("zoom",r),this.pz.on("pan",r);const a=window.innerWidth/2,o=window.innerHeight/2;this.pz.moveTo(-a,-o),this.currentX=-a,this.currentY=-o,n&&n(1,-a,-o)}getScale(){return this.currentScale}getTransform(){return{scale:this.currentScale,x:this.currentX,y:this.currentY}}setTransform(e,t,n){this.pz.moveTo(t,n),this.pz.zoomAbs(0,0,e),this.currentScale=e,this.currentX=t,this.currentY=n}zoomIn(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,1.25)}zoomOut(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,.8)}resetView(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.moveTo(-e,-t),this.pz.zoomAbs(0,0,1),this.currentScale=1,this.currentX=-e,this.currentY=-t}dispose(){this.pz.dispose()}}class Rt{el;container;constructor(e,t,n){this.container=e,this.el=document.createElement("div"),this.el.className="schema-hud";const r=document.createElement("div");r.className="hud-group";const a=this.createButton("+","Zoom In");a.onclick=()=>t.zoomIn();const o=this.createButton("−","Zoom Out");o.onclick=()=>t.zoomOut();const d=this.createButton("⌂","Reset View");d.onclick=()=>t.resetView(),r.append(a,o,d);const s=document.createElement("div");s.className="hud-group";const p=document.createElement("select");p.className="hud-select",p.title="Connection Line Style",[{value:"Curve",text:"Curve"},{value:"Rectilinear",text:"Rectilinear"},{value:"RoundRectilinear",text:"Round Rectilinear"},{value:"Oblique",text:"Oblique"},{value:"RoundOblique",text:"Round Oblique"}].forEach(L=>{const C=document.createElement("option");C.value=L.value,C.innerText=L.text,p.appendChild(C)}),p.onchange=L=>{const C=L.target.value;n.setLineStyle(C),this.dispatchProjectSettingsChange({lineStyle:C})},s.appendChild(p);const f=document.createElement("div");f.className="hud-group";const b=this.createButton("▓","Toggle Grid");b.title="Toggle grid",b.dataset.state="off",b.onclick=()=>{const C=!(b.dataset.state==="on");b.dataset.state=C?"on":"off",C?this.container.querySelector(".schema-wrapper")?.classList.add("grid-visible"):this.container.querySelector(".schema-wrapper")?.classList.remove("grid-visible"),this.dispatchProjectSettingsChange({showGrid:C})},f.appendChild(b),this.el.append(f,s,r),e.appendChild(this.el)}createButton(e,t){const n=document.createElement("button");return n.className="hud-btn",n.innerText=e,n.title=t,n}dispatchProjectSettingsChange(e){const t=new CustomEvent("project-settings-changed",{detail:e});this.container.dispatchEvent(t)}}class Dn{container;wrapper;connectionManager;dragManager;panZoomManager;hud;parsers={dbml:new gn};constructor(e,t,n){this.container=document.getElementById(e),this.wrapper=document.createElement("div"),this.wrapper.className="schema-wrapper",this.container.appendChild(this.wrapper),this.connectionManager=new wt(this.wrapper),this.dragManager=new Sn(this.wrapper,this.connectionManager,t),this.panZoomManager=new In(this.wrapper,r=>{this.dragManager.updateScale(r),this.connectionManager.updateScale(r)},(r,a,o)=>{this.dragManager.updateScale(r),this.connectionManager.updateScale(r),n&&n(r,a,o)}),this.hud=new Rt(this.container,this.panZoomManager,this.connectionManager)}render(e,t){if(this.wrapper.innerHTML="",this.connectionManager=new wt(this.wrapper),this.dragManager.updateConnectionManager(this.connectionManager),this.connectionManager.updateScale(this.panZoomManager.getScale()),this.container.querySelector(".schema-hud")?.remove(),this.hud=new Rt(this.container,this.panZoomManager,this.connectionManager),!!t.trim())try{let n=(e||"").toLowerCase().trim();n.startsWith(".")&&(n=n.slice(1));const r=this.parsers[n];if(!r)throw new Error(`Unsupported format: ${e}`);const{tables:a,relationships:o,projectSettings:d}=r.parse(t);if(d){if(d.zoom!==void 0||d.panX!==void 0){const b=d.zoom||1,L=d.panX||0,C=d.panY||0;this.panZoomManager.setTransform(b,L,C)}(d.showGrid==="true"||d.showGrid===!0)&&this.wrapper.classList.add("grid-visible"),d.lineStyle&&this.connectionManager.setLineStyle(d.lineStyle)}const s=350,p=300,m=3;a.forEach((f,b)=>{const L=wn.create(f);this.wrapper.appendChild(L);let C=f.x!==void 0?f.x:50+b%m*s,y=f.y!==void 0?f.y:50+Math.floor(b/m)*p;if(L.style.left=`${C}px`,L.style.top=`${y}px`,f.width&&(L.style.width=`${f.width}px`),f.color){const h=L.querySelector(".db-table-header");h&&(h.style.backgroundColor=f.color)}}),this.dragManager.setRelationships(o),setTimeout(()=>{this.connectionManager.draw(o)},0)}catch(n){console.error(n),this.wrapper.innerHTML=`<div class="error">Error: ${n.message}</div>`}}}const be=new dn(u=>{switch(u.type){case"UPDATE_CONTENT":$t.render(u.format,u.content);break;case"UPDATE_THEME":Pn(u.theme);break}}),$t=new Dn("app",(u,e,t,n)=>{be.send({type:"UPDATE_TABLE_POS",tableName:u,x:e,y:t,width:n})},(u,e,t)=>{be.send({type:"UPDATE_PROJECT_SETTINGS",settings:{zoom:u,panX:Math.round(e),panY:Math.round(t)}})}),qn=document.getElementById("app");qn.addEventListener("project-settings-changed",u=>{const e=u.detail||{},t=$t.panZoomManager?.getTransform?.()||{scale:1,x:0,y:0};be.send({type:"UPDATE_PROJECT_SETTINGS",settings:{lineStyle:e.lineStyle,showGrid:e.showGrid,zoom:e.zoom??t.scale,panX:e.panX??Math.round(t.x),panY:e.panY??Math.round(t.y)}})});function Pn(u){u==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")}be.log("Webview Initialized & Ready");</script>
  <style rel="stylesheet" crossorigin>.db-table{position:absolute;top:0;left:0;min-width:200px;width:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 6px #0000001a;z-index:1;display:flex;flex-direction:column}.db-table.dragging,.db-table.resizing{box-shadow:0 10px 15px #0003;z-index:100}.db-table.dragging{cursor:grabbing}.db-table.resizing{cursor:col-resize}.db-table-header{background:var(--header-bg);color:var(--header-text);padding:10px;font-weight:700;border-top-left-radius:7px;border-top-right-radius:7px;cursor:grab;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:8px}.db-table-header:active{cursor:grabbing}.header-title-wrapper{display:flex;align-items:center;gap:6px}.table-icon{width:16px;height:16px;display:flex;opacity:.9}.table-icon svg{width:100%;height:100%;stroke-width:2.5px}.title{font-size:15px;line-height:1.2}.schema-banner{background:#fff3;padding:2px 6px;border-radius:4px;font-size:12px}.table-note{font-size:11px;color:#fffc;margin-top:4px;width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.resize-handle{position:absolute;top:0;right:0;width:12px;height:100%;cursor:col-resize;z-index:50;background:transparent;border-right:4px solid rgba(0,0,0,.1);transition:all .2s;border-top-right-radius:8px;border-bottom-right-radius:8px}.resize-handle:hover,.db-table.resizing .resize-handle{background-color:#3b82f61a;border-right:4px solid var(--header-bg)}body.dark .resize-handle{border-right:4px solid rgba(255,255,255,.1)}body.dark .resize-handle:hover{border-right:4px solid var(--header-bg)}.db-row{display:flex;justify-content:space-between;padding:8px;border-bottom:1px solid var(--table-border);font-size:13px;line-height:1.4;position:relative;transition:background-color .15s ease}.db-row:hover{background-color:#7d7d7d0d}.db-row:last-child{border-bottom:none;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.indexed-row{background:linear-gradient(to right,rgba(var(--header-rgb),.08),transparent)}.row-left{display:flex;align-items:flex-start;gap:8px;flex:1;min-width:0;padding-right:8px}.key-icon{width:12px;height:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px}.key-icon svg{width:100%;height:100%}.key-icon.pk{color:#eab308}.key-icon.fk{color:#3b82f6}.key-icon.pk-fk{color:#22c55e}.key-icon.empty{width:16px}.name-container{display:flex;flex-direction:column;overflow:hidden}.field-name{font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.field-note{font-size:11px;color:var(--text-secondary);margin-top:2px;line-height:1.2;font-style:italic;opacity:.8}.row-right{display:flex;align-items:flex-start;justify-content:flex-end;gap:6px;flex-shrink:0}.type-container{display:flex;flex-direction:column;align-items:flex-end}.field-type{color:var(--text-secondary);font-size:11px;font-family:SF Mono,Monaco,Menlo,Courier New,monospace;text-align:right;background:#9696961a;padding:1px 4px;border-radius:4px}.constrained-type{text-decoration-color:var(--header-bg);text-decoration-thickness:2px}.field-default{font-size:10px;color:var(--text-secondary);opacity:.7;text-align:right;margin-top:2px;max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.badge{font-size:9px;height:16px;padding:0 6px;display:flex;align-items:center;justify-content:center;border-radius:10px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;box-shadow:0 1px 2px #0000000d}.badge.unique{background:#f3e8ff;color:#7e22ce;border:1px solid rgba(126,34,206,.1)}.badge.not-null{background:#f3f4f6;color:#4b5563;border:1px solid rgba(75,85,99,.1)}.badge.enum{background:#ecfdf5;color:#047857;border:1px solid rgba(4,120,87,.1)}body.dark .db-row:hover{background-color:#ffffff0d}body.dark .field-type{background:#ffffff14;color:#a1a1aa}body.dark .badge.unique{background:#3b0764;color:#d8b4fe;border-color:#581c87}body.dark .badge.not-null{background:#374151;color:#e5e7eb;border-color:#4b5563}body.dark .badge.enum{background:#064e3b;color:#6ee7b7;border-color:#065f46}@keyframes flashHighlight{0%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}50%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 12px rgba(var(--header-rgb),.4)}to{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}}.db-row.highlighted{background-color:rgba(var(--header-rgb),.1);color:var(--text-primary);animation:flashHighlight 1.5s infinite;z-index:10}.db-table.highlighted{border-color:var(--header-bg);animation:flashTable 1.5s infinite;z-index:20}@keyframes flashTable{0%{box-shadow:0 4px 6px #0000001a}50%{box-shadow:0 0 15px rgba(var(--header-rgb),.6)}to{box-shadow:0 4px 6px #0000001a}}.connection-layer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:visible}.connection-group{pointer-events:auto;cursor:pointer}.relation-hit-area{fill:none;stroke:transparent;stroke-width:20px}.relation-line-base{fill:none;stroke:var(--line-color);stroke-width:2px;stroke-linecap:round;transition:stroke .3s,stroke-width .3s}.relation-line-flow{fill:none;stroke:var(--header-bg);stroke-width:2px;stroke-linecap:round;stroke-dasharray:15 150;opacity:.4;animation:flowAnimation 5s linear infinite}@keyframes flowAnimation{to{stroke-dashoffset:-165}}@keyframes continuousFlow{to{stroke-dashoffset:-24}}.connection-group.highlighted .relation-line-base{stroke:var(--header-bg);stroke-width:3px;opacity:.5}.connection-group.highlighted .relation-line-flow{opacity:1;stroke-width:3px;stroke-dasharray:12 12;animation:continuousFlow .8s linear infinite;filter:drop-shadow(0 0 4px var(--header-bg))}.anchor-port{fill:var(--bg-color);stroke:var(--line-color);stroke-width:2px;transition:all .3s}.anchor-port.highlighted{stroke:var(--header-bg);fill:var(--header-bg);r:5px;filter:drop-shadow(0 0 3px var(--header-bg))}.label-bg{fill:var(--bg-color);stroke:var(--table-border);transition:all .3s}.connection-group.highlighted .label-bg{stroke:var(--header-bg);fill:#fff}.relation-label-text{font-size:10px;font-weight:700;fill:var(--text-secondary);text-anchor:middle;dominant-baseline:middle;pointer-events:none}.connection-group.highlighted .relation-label-text{fill:var(--header-bg)}.schema-hud{position:absolute;bottom:20px;left:20px;right:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 12px #00000026;display:flex;flex-direction:column-reverse;align-items:flex-start;padding:8px;gap:8px;z-index:1000;-webkit-user-select:none;user-select:none}.hud-group{display:flex;gap:6px;align-items:center}.hud-group+.hud-group{border-top:1px solid var(--table-border);padding-top:8px;margin-top:6px}.hud-btn{background:transparent;border:1px solid transparent;color:var(--text-primary);border-radius:4px;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;cursor:pointer;transition:all .12s}.hud-btn:hover{background:rgba(var(--header-rgb),.06);color:var(--header-bg)}.hud-select{background:var(--bg-color);color:var(--text-primary);border:1px solid var(--table-border);border-radius:4px;padding:4px 8px;font-size:12px;outline:none;cursor:pointer}.schema-wrapper.grid-visible{background-image:linear-gradient(to right,var(--line-color) 1px,transparent 1px),linear-gradient(to bottom,var(--line-color) 1px,transparent 1px);background-size:20px 20px}:root{--bg-color: #f4f4f4;--table-bg: #ffffff;--table-border: #d1d5db;--header-bg: #3b82f6;--header-rgb: 59, 130, 246;--header-text: #ffffff;--text-primary: #1f2937;--text-secondary: #6b7280;--line-color: #9ca3af}body.dark{--bg-color: #1e1e1e;--table-bg: #2b2d30;--table-border: #4e5256;--header-bg: #3574f0;--header-rgb: 53, 116, 240;--header-text: #ffffff;--text-primary: #d1d5db;--text-secondary: #9ca3af;--line-color: #6b7280}body{margin:0;background:var(--bg-color);color:var(--text-primary);font-family:sans-serif;overflow:hidden}#app{width:100vw;height:100vh;overflow:hidden}.schema-wrapper{width:100%;height:100%;transform-origin:0 0;position:relative}</style>
</head>

<body>
<div id="app"></div>
</body>

</html>
