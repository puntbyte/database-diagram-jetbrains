<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="./vite.svg"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>web</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();class un{onMessage;constructor(e){this.onMessage=e,window.addEventListener("message",t=>{const n=t.data;n&&typeof n.type=="string"&&this.onMessage(n)}),this.send({type:"READY"})}send(e){const t=JSON.stringify(e);window.cefQuery?window.cefQuery({request:t}):console.log("Bridge Dev Log:",e)}log(e){this.send({type:"LOG",level:"INFO",message:e})}}function Pe(h){return h.replace(/[^a-zA-Z0-9_]/g,"_")}function dn(h){return h.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"")}function Fe(h){const e=new Map;if(!h)return e;const t=h.split(",").map(n=>n.trim()).filter(Boolean);for(let n of t)if(n.includes(":")){const[r,...a]=n.split(":");e.set(r.trim().toLowerCase(),a.join(":").trim())}else e.set(n.toLowerCase(),"true");return e}function fn(h){const e={},n=/Project\s*(?:(?:"[^"]*")|(?:[\w]+))?\s*\{([\s\S]*?)\}/i.exec(h);return n&&n[1].split(`
`).forEach(o=>{const u=o.split(":");if(u.length>=2){const s=u[0].trim();let p=u.slice(1).join(":").trim();(p.startsWith("'")&&p.endsWith("'")||p.startsWith('"')&&p.endsWith('"'))&&(p=p.substring(1,p.length-1)),!isNaN(Number(p))&&p!==""?e[s]=Number(p):e[s]=p}}),e}function gt(h){const e=[],t=h.split(`
`).map(n=>n.trim()).filter(Boolean);for(let n of t){const r=/^(\(?\s*[\w\.,\s]+\s*\)?)(?:\s*\[(.*?)\])?$/i.exec(n);if(!r)continue;const a=r[1].replace(/^\(/,"").replace(/\)$/,"").split(",").map(u=>u.trim()).filter(Boolean),o=Fe(r[2]||"");e.push({columns:a,settings:Object.fromEntries(o),raw:n})}return e}function kt(h,e,t){const n=t.split(",").map(b=>b.trim());let r=!1,a=!1,o=!1,u=!1,s,p,m,d;for(const b of n){/pk|primary key/i.test(b)&&(r=!0),/unique/i.test(b)&&(a=!0),/not null/i.test(b)&&(o=!0);const L=/note:\s*(['"])([\s\S]*?)\1/i.exec(b);L&&(s=L[2]);const C=/default:\s*(['`])?([\s\S]*?)\1?/i.exec(b);C&&(p=C[2]);const y=/ref:\s*(<>|[<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/i.exec(b);y&&(u=!0,d={symbol:y[1],toTable:y[2],toColumn:y[3]})}return{name:h,type:e,isPk:r,isUnique:a,isNotNull:o,isFk:u,note:s,default:p,enumValues:m,inlineRef:d}}function hn(h){const e=[],t=h.split(`
`);for(let n of t){if(n=n.trim(),!n||n.startsWith("Note"))continue;const a=/^("?[\w]+"?)\s+([a-zA-Z0-9_()]+)(?:\s*\[(.*?)\])?/.exec(n);a&&e.push(kt(a[1].replace(/"/g,""),a[2],a[3]||""))}return{fields:e}}function Bt(h,e,t,n,r){const a=u=>u.replace(/"/g,"");let o="1:n";return t==="<"?o="1:n":t===">"?o="n:1":t==="-"?o="1:1":t==="<>"&&(o="m:n"),{fromTable:Pe(a(h)),fromColumn:a(e),toTable:Pe(a(n)),toColumn:a(r),type:o}}function mn(h){const e=[],t=/("?[\w.]+"?)\.("?[\w"]+"?)\s*(<>|[<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/g,n=/Ref\s*[^{:]*[:\{]\s*([^}]+)\s*\}?/gi;let r;for(;(r=n.exec(h))!==null;){const a=r[1];let o;for(;(o=t.exec(a))!==null;)e.push(Bt(o[1],o[2],o[3],o[4],o[5]))}return e}function pn(h){const e=[],t=[],n=new Map,r=/TablePartial\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/gi;let a;for(;(a=r.exec(h))!==null;){const s=a[1].replace(/"/g,""),p=a[2]||"",m=a[3]||"",d=/indexes\s*\{([\s\S]*?)\}/i.exec(m);let b=[],L=m;d&&(b=gt(d[1]),L=m.replace(d[0],""));const{fields:C}=hn(L);n.set(s,{name:s,settings:Fe(p),fields:C,indexes:b})}const o=/Table\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*(?:as\s+\w+\s*)?\{([\s\S]*?)\}/gi;let u;for(;(u=o.exec(h))!==null;){const s=u[1].replace(/"/g,""),p=u[2]||"",m=u[3]||"",d=Fe(p),b=/indexes\s*\{([\s\S]*?)\}/i.exec(m);let L=[],C=m;b&&(L=gt(b[1]),C=m.replace(b[0],""));const y=C.split(`
`),f=new Map,T=[],O=new Map,A=new Map;for(let k of y){const x=k.trim();if(!x)continue;if(x.startsWith("~")){const E=x.replace(/^~\s*/,"").trim(),N=n.get(E);if(N){for(const[M,v]of N.settings.entries())A.set(M,v);for(const M of N.fields){if(f.has(M.name)){const v=T.indexOf(M.name);v!==-1&&T.splice(v,1)}f.set(M.name,M),T.push(M.name)}for(const M of N.indexes)O.set(M.columns.join("|").toLowerCase(),M)}continue}const S=/^("?[\w]+"?)\s+([a-zA-Z0-9_()]+)(?:\s*\[(.*?)\])?/.exec(x);if(S){const E=S[1].replace(/"/g,""),N=kt(E,S[2],S[3]||"");if(f.has(N.name)){const M=T.indexOf(N.name);M!==-1&&T.splice(M,1)}f.set(N.name,N),T.push(N.name)}}for(const k of L)O.set(k.columns.join("|").toLowerCase(),k);for(const[k,x]of d.entries())A.set(k,x);const B=T.map(k=>f.get(k)).filter(Boolean);B.forEach(k=>{k.inlineRef&&t.push(Bt(s,k.name,k.inlineRef.symbol,k.inlineRef.toTable,k.inlineRef.toColumn))});const R=/Note:\s*(['"])([\s\S]*?)\1/i.exec(m);e.push({id:Pe(s),name:s,fields:B,note:R?R[2]:void 0,color:A.get("color")||void 0,width:A.has("width")?parseInt(A.get("width"),10):void 0,x:A.has("x")?parseInt(A.get("x"),10):void 0,y:A.has("y")?parseInt(A.get("y"),10):void 0,settings:Object.fromEntries(A),indexes:Array.from(O.values())})}return{tables:e,inlineRelationships:t}}class vn{parse(e){const t=dn(e),n=fn(t),{tables:r,inlineRelationships:a}=pn(t),o=mn(t),u=[...a,...o];return{tables:r,relationships:u,projectSettings:n}}}const $t={Key:`
    <svg viewBox="0 0 24 24" width="100%" height="100%" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
    </svg>`,Table:`
    <svg viewBox="0 0 24 24" width="100%" height="100%" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="3" y1="9" x2="21" y2="9"></line>
        <line x1="9" y1="21" x2="9" y2="9"></line>
    </svg>`};class gn{static create(e,t){const n=document.createElement("div");n.className="db-row",n.id=`col-${t}-${e.name}`,e.isUnique&&n.classList.add("indexed-row");const r=document.createElement("div");r.className="row-left";const a=document.createElement("span");a.className="key-icon",e.isPk||e.isFk?(a.innerHTML=$t.Key,e.isPk&&e.isFk?(a.classList.add("pk-fk"),a.title="Primary & Foreign Key"):e.isPk?(a.classList.add("pk"),a.title="Primary Key"):(a.classList.add("fk"),a.title="Foreign Key")):a.classList.add("empty"),r.appendChild(a);const o=document.createElement("div");o.className="name-container";const u=document.createElement("span");if(u.className="field-name",u.innerText=e.name,o.appendChild(u),e.note){const d=document.createElement("div");d.className="field-note",d.innerText=e.note,o.appendChild(d)}r.appendChild(o);const s=document.createElement("div");s.className="row-right";const p=document.createElement("div");p.className="type-container";const m=document.createElement("span");if(m.className="field-type",e.isUnique&&m.classList.add("constrained-type"),m.innerText=e.type,p.appendChild(m),e.enumValues&&e.enumValues.length>0){const d=this.createBadge("ENUM","enum");d.title=`Enum values: ${e.enumValues.join(", ")}`,s.appendChild(d)}if(e.isUnique&&s.appendChild(this.createBadge("UQ","unique")),e.isNotNull&&s.appendChild(this.createBadge("NN","not-null")),e.default){const d=document.createElement("div");d.className="field-default",d.innerText=`default: ${e.default}`,p.appendChild(d)}return s.appendChild(p),n.appendChild(r),n.appendChild(s),n}static createBadge(e,t){const n=document.createElement("span");return n.className=`badge ${t}`,n.innerText=e,n}}class yn{static create(e){const t=document.createElement("div");t.className="db-table",t.id=`table-${e.id}`,t.dataset.tableName=e.name,e.width&&(t.style.width=`${e.width}px`);const n=document.createElement("div");n.className="db-table-header",e.color&&(n.style.backgroundColor=e.color);const[r,a]=e.name.includes(".")?e.name.split("."):["",e.name],o=document.createElement("div");o.className="header-title-wrapper";const u=document.createElement("span");u.className="table-icon",u.innerHTML=$t.Table,o.appendChild(u);const s=document.createElement("span");s.className="title",s.innerText=a,o.appendChild(s),n.appendChild(o);const p=document.createElement("span");if(p.className="schema-banner",p.innerText=r||"public",n.appendChild(p),e.note){const d=document.createElement("div");d.className="table-note",d.innerText=e.note,n.appendChild(d)}t.appendChild(n),e.fields.forEach(d=>{t.appendChild(gn.create(d,e.id))});const m=document.createElement("div");return m.className="resize-handle",m.title="Drag to resize",t.appendChild(m),t}}class wn{static MIN_STRAIGHT=15;static MAX_STRAIGHT=40;static LABEL_OFFSET=25;static calculatePath(e,t,n,r,a,o,u="Curve"){const s=e.y+e.height/2,p=t.y+t.height/2,m={x:e.x+e.width,y:s},d={x:e.x,y:s},b={x:t.x+t.width,y:p},L={x:t.x,y:p},C=e.x<t.x+t.width&&e.x+e.width>t.x;let y,f,T,O;C?(y=m,f=b,T=1,O=1):e.x<t.x?(y=m,f=L,T=1,O=-1):(y=d,f=b,T=-1,O=1);const A=Math.abs(f.x-y.x),B=Math.max(this.MIN_STRAIGHT,Math.min(this.MAX_STRAIGHT,A/3)),R={x:y.x+B*T,y:y.y},k={x:f.x+B*O,y:f.y};if(C){const E=Math.max(40,Math.abs(f.y-y.y)*.4);R.x=Math.max(y.x,f.x)+E,k.x=R.x}let x="";switch(u){case"Rectilinear":case"RoundRectilinear":{const E=(R.x+k.x)/2,N={x:E,y:y.y},M={x:E,y:f.y};if(u==="Rectilinear")x=`M ${y.x} ${y.y} L ${N.x} ${N.y} L ${M.x} ${M.y} L ${f.x} ${f.y}`;else{const v=Math.min(15,Math.abs(M.y-N.y)/2,Math.abs(N.x-y.x)/2),W=f.y>y.y?1:-1,G=N.x>y.x?1:-1,_=f.x>M.x?1:-1;x=`M ${y.x} ${y.y} 
               L ${N.x-v*G} ${N.y} 
               Q ${N.x} ${N.y} ${N.x} ${N.y+v*W} 
               L ${M.x} ${M.y-v*W} 
               Q ${M.x} ${M.y} ${M.x+v*_} ${M.y} 
               L ${f.x} ${f.y}`}break}case"Oblique":case"RoundOblique":{u==="Oblique"?x=`M ${y.x} ${y.y} L ${R.x} ${R.y} L ${k.x} ${k.y} L ${f.x} ${f.y}`:x=`M ${y.x} ${y.y} 
               L ${R.x} ${R.y} 
               Q ${(R.x+k.x)/2} ${(R.y+k.y)/2} ${k.x} ${k.y} 
               L ${f.x} ${f.y}`;break}default:{x=`M ${y.x} ${y.y} C ${R.x} ${R.y}, ${k.x} ${k.y}, ${f.x} ${f.y}`;break}}const w=this.getLabelPos(y,R),S=this.getLabelPos(f,k);return{d:x,start:y,end:f,labelStart:w,labelEnd:S,fromId:n,toId:r,fromTableId:a,toTableId:o}}static getLabelPos(e,t){const n=t.x-e.x,r=t.y-e.y,a=Math.sqrt(n*n+r*r),o=this.LABEL_OFFSET/(a||1);return{x:e.x+n*o,y:e.y+r*o}}}class xn{static createGroup(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","g");n.classList.add("connection-group"),n.dataset.from=e.fromId,n.dataset.to=e.toId,n.dataset.fromTable=e.fromTableId,n.dataset.toTable=e.toTableId;const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",e.d),r.classList.add("relation-hit-area"),n.appendChild(r);const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",e.d),a.classList.add("relation-line-base"),n.appendChild(a);const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",e.d),o.classList.add("relation-line-flow"),n.appendChild(o),this.createLabels(e,t).forEach(s=>n.appendChild(s)),n}static createLabels(e,t){const n=this.getLabelText(t);return n?[this.createLabelBadge(n.from,e.labelStart.x,e.labelStart.y),this.createLabelBadge(n.to,e.labelEnd.x,e.labelEnd.y)]:[]}static createLabelBadge(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","g");r.classList.add("relation-label-group");const a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("x",(t-9).toString()),a.setAttribute("y",(n-7).toString()),a.setAttribute("width","18"),a.setAttribute("height","14"),a.setAttribute("rx","4"),a.classList.add("label-bg");const o=document.createElementNS("http://www.w3.org/2000/svg","text");return o.setAttribute("x",t.toString()),o.setAttribute("y",(n+1).toString()),o.classList.add("relation-label-text"),o.textContent=e,r.appendChild(a),r.appendChild(o),r}static getLabelText(e){switch(e){case"1:n":return{from:"1",to:"n"};case"n:1":return{from:"n",to:"1"};case"1:1":return{from:"1",to:"1"};case"m:n":return{from:"m",to:"n"};default:return null}}}class yt{static create(e){const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx",e.x.toString()),t.setAttribute("cy",e.y.toString()),t.setAttribute("r","3.5"),t.classList.add("anchor-port"),t}}class wt{svgLayer;scale=1;container;currentRelationships=[];currentLineStyle="Curve";constructor(e){this.container=e,this.svgLayer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgLayer.classList.add("connection-layer"),e.appendChild(this.svgLayer),this.setupInteractions()}updateScale(e){this.scale=e}setLineStyle(e){this.currentLineStyle=e,this.draw(this.currentRelationships)}draw(e){this.currentRelationships=e,this.svgLayer.innerHTML="",e.forEach(t=>this.drawOne(t))}drawOne(e){const t=`col-${e.fromTable}-${e.fromColumn}`,n=`col-${e.toTable}-${e.toColumn}`,r=document.getElementById(t),a=document.getElementById(n);if(!r||!a)return;const o=this.getRelativeRect(r),u=this.getRelativeRect(a),s=wn.calculatePath(o,u,t,n,`table-${e.fromTable}`,`table-${e.toTable}`,this.currentLineStyle),p=xn.createGroup(s,e.type);this.svgLayer.appendChild(p);const m=yt.create(s.start);m.dataset.anchorId=t,this.svgLayer.appendChild(m);const d=yt.create(s.end);d.dataset.anchorId=n,this.svgLayer.appendChild(d)}getRelativeRect(e){const t=e.getBoundingClientRect(),n=this.svgLayer.getBoundingClientRect();return{x:(t.left-n.left)/this.scale,y:(t.top-n.top)/this.scale,width:t.width/this.scale,height:t.height/this.scale}}setupInteractions(){this.container.addEventListener("mouseover",e=>this.handleHover(e,!0)),this.container.addEventListener("mouseout",e=>this.handleHover(e,!1))}handleHover(e,t){if(!t){this.clearHighlights();return}const n=e.target,r=n.closest(".connection-group");if(r){this.activateConnection(r);return}const a=n.closest(".db-row");if(a&&a.id){this.activateColumn(a.id);return}const o=n.closest(".db-table");if(o&&o.id){this.activateTable(o.id);return}}clearHighlights(){document.querySelectorAll(".highlighted").forEach(t=>t.classList.remove("highlighted"))}activateConnection(e){e.classList.add("highlighted");const t=e.dataset.from,n=e.dataset.to;t&&this.setHighlight(t),n&&this.setHighlight(n),this.highlightAnchorsForLine(t,n)}activateColumn(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from="${e}"], [data-to="${e}"]`).forEach(n=>{n.classList.add("highlighted");const r=n;r.dataset.from!==e&&this.setHighlight(r.dataset.from),r.dataset.to!==e&&this.setHighlight(r.dataset.to),this.highlightAnchorsForLine(r.dataset.from,r.dataset.to)})}activateTable(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from-table="${e}"], [data-to-table="${e}"]`).forEach(n=>{n.classList.add("highlighted");const r=n;this.setHighlight(r.dataset.from),this.setHighlight(r.dataset.to),this.highlightAnchorsForLine(r.dataset.from,r.dataset.to)})}setHighlight(e){if(!e)return;const t=document.getElementById(e);t&&t.classList.add("highlighted")}highlightAnchorsForLine(e,t){e&&this.svgLayer.querySelectorAll(`[data-anchor-id="${e}"]`).forEach(r=>r.classList.add("highlighted")),t&&this.svgLayer.querySelectorAll(`[data-anchor-id="${t}"]`).forEach(r=>r.classList.add("highlighted"))}}class bn{activeEl=null;mode="NONE";initialMouse={x:0,y:0};initialVal={x:0,y:0,width:0};scale=1;relationships=[];connectionManager;onUpdate;constructor(e,t,n){this.connectionManager=t,this.onUpdate=n,e.addEventListener("mousedown",r=>this.onMouseDown(r)),window.addEventListener("mousemove",r=>this.onMouseMove(r)),window.addEventListener("mouseup",()=>this.onMouseUp())}updateConnectionManager(e){this.connectionManager=e}setRelationships(e){this.relationships=e}updateScale(e){this.scale=e}onMouseDown(e){const t=e.target;if(t.classList.contains("resize-handle")){const r=t.closest(".db-table");r&&this.startResize(r,e);return}const n=t.closest(".db-table-header");if(n){const r=n.parentElement;r&&this.startDrag(r,e);return}}startDrag(e,t){this.mode="DRAG",this.activeEl=e,this.initialVal.x=e.offsetLeft,this.initialVal.y=e.offsetTop,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("dragging")}startResize(e,t){this.mode="RESIZE",this.activeEl=e,this.initialVal.width=e.offsetWidth,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("resizing"),document.body.style.cursor="col-resize"}onMouseMove(e){if(this.activeEl){if(this.mode==="DRAG"){const t=(e.clientX-this.initialMouse.x)/this.scale,n=(e.clientY-this.initialMouse.y)/this.scale;this.activeEl.style.left=`${this.initialVal.x+t}px`,this.activeEl.style.top=`${this.initialVal.y+n}px`,this.activeEl.style.transform="none",this.connectionManager.draw(this.relationships)}else if(this.mode==="RESIZE"){const t=(e.clientX-this.initialMouse.x)/this.scale,n=Math.max(200,this.initialVal.width+t);this.activeEl.style.width=`${n}px`,this.connectionManager.draw(this.relationships)}}}onMouseUp(){if(!this.activeEl)return;const e=this.activeEl,t=e.querySelector(".title"),n=e.dataset&&e.dataset.tableName||(t?t.textContent||"":e.id.replace("table-",""));if(n){const r=Math.round(parseInt(e.style.left||"0",10)),a=Math.round(parseInt(e.style.top||"0",10)),o=Math.round(e.getBoundingClientRect().width/this.scale);this.onUpdate(n,r,a,o)}e.classList.remove("dragging"),e.classList.remove("resizing"),document.body.style.cursor="",this.activeEl=null,this.mode="NONE"}}function Sn(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var le={exports:{}},xt;function En(){if(xt)return le.exports;xt=1,le.exports=h,le.exports.addWheelListener=h,le.exports.removeWheelListener=e;function h(t,n,r){t.addEventListener("wheel",n,r)}function e(t,n,r){t.removeEventListener("wheel",n,r)}return le.exports}var ue={exports:{}},$e,bt;function Mn(){if(bt)return $e;bt=1;var h=4,e=.001,t=1e-7,n=10,r=11,a=1/(r-1),o=typeof Float32Array=="function";function u(y,f){return 1-3*f+3*y}function s(y,f){return 3*f-6*y}function p(y){return 3*y}function m(y,f,T){return((u(f,T)*y+s(f,T))*y+p(f))*y}function d(y,f,T){return 3*u(f,T)*y*y+2*s(f,T)*y+p(f)}function b(y,f,T,O,A){var B,R,k=0;do R=f+(T-f)/2,B=m(R,O,A)-y,B>0?T=R:f=R;while(Math.abs(B)>t&&++k<n);return R}function L(y,f,T,O){for(var A=0;A<h;++A){var B=d(f,T,O);if(B===0)return f;var R=m(f,T,O)-y;f-=R/B}return f}function C(y){return y}return $e=function(f,T,O,A){if(!(0<=f&&f<=1&&0<=O&&O<=1))throw new Error("bezier x values must be in [0, 1] range");if(f===T&&O===A)return C;for(var B=o?new Float32Array(r):new Array(r),R=0;R<r;++R)B[R]=m(R*a,f,O);function k(x){for(var w=0,S=1,E=r-1;S!==E&&B[S]<=x;++S)w+=a;--S;var N=(x-B[S])/(B[S+1]-B[S]),M=w+N*a,v=d(M,f,O);return v>=e?L(x,M,f,O):v===0?M:b(x,w,w+a,f,O)}return function(w){return w===0?0:w===1?1:m(k(w),T,A)}},$e}var St;function Tn(){if(St)return ue.exports;St=1;var h=Mn(),e={ease:h(.25,.1,.25,1),easeIn:h(.42,0,1,1),easeOut:h(0,0,.58,1),easeInOut:h(.42,0,.58,1),linear:h(0,0,1,1)};ue.exports=t,ue.exports.makeAggregateRaf=u,ue.exports.sharedScheduler=u();function t(s,p,m){var d=Object.create(null),b=Object.create(null);m=m||{};var L=typeof m.easing=="function"?m.easing:e[m.easing];L||(m.easing&&console.warn("Unknown easing function in amator: "+m.easing),L=e.ease);var C=typeof m.step=="function"?m.step:n,y=typeof m.done=="function"?m.done:n,f=r(m.scheduler),T=Object.keys(p);T.forEach(function(S){d[S]=s[S],b[S]=p[S]-s[S]});var O=typeof m.duration=="number"?m.duration:400,A=Math.max(1,O*.06),B,R=0;return B=f.next(x),{cancel:k};function k(){f.cancel(B),B=0}function x(){var S=L(R/A);R+=1,w(S),R<=A?(B=f.next(x),C(s)):(B=0,setTimeout(function(){y(s)},0))}function w(S){T.forEach(function(E){s[E]=b[E]*S+d[E]})}}function n(){}function r(s){if(!s){var p=typeof window<"u"&&window.requestAnimationFrame;return p?a():o()}if(typeof s.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof s.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return s}function a(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function o(){return{next:function(s){return setTimeout(s,1e3/60)},cancel:function(s){return clearTimeout(s)}}}function u(){var s=new Set,p=new Set,m=0;return{next:b,cancel:b,clearAll:d};function d(){s.clear(),p.clear(),cancelAnimationFrame(m),m=0}function b(y){p.add(y),L()}function L(){m||(m=requestAnimationFrame(C))}function C(){m=0;var y=p;p=s,s=y,s.forEach(function(f){f()}),s.clear()}}return ue.exports}var Oe,Et;function Ln(){if(Et)return Oe;Et=1;function h(n){t(n);const r=e(n);return n.on=r.on,n.off=r.off,n.fire=r.fire,n}function e(n){let r=Object.create(null);return{on:function(a,o,u){if(typeof o!="function")throw new Error("callback is expected to be a function");let s=r[a];return s||(s=r[a]=[]),s.push({callback:o,ctx:u}),n},off:function(a,o){if(typeof a>"u")return r=Object.create(null),n;if(r[a])if(typeof o!="function")delete r[a];else{const u=r[a];for(let s=0;s<u.length;++s)u[s].callback===o&&u.splice(s,1)}return n},fire:function(a){const o=r[a];if(!o)return n;let u;arguments.length>1&&(u=Array.prototype.slice.call(arguments,1));for(let s=0;s<o.length;++s){const p=o[s];p.callback.apply(p.ctx,u)}return n}}}function t(n){if(!n)throw new Error("Eventify cannot use falsy object as events subject");const r=["on","fire","off"];for(let a=0;a<r.length;++a)if(n.hasOwnProperty(r[a]))throw new Error("Subject cannot be eventified, since it already has property '"+r[a]+"'")}return Oe=h,Oe}var Ie,Mt;function Cn(){if(Mt)return Ie;Mt=1,Ie=h;function h(n,r,a){typeof a!="object"&&(a={});var o=typeof a.minVelocity=="number"?a.minVelocity:5,u=typeof a.amplitude=="number"?a.amplitude:.25,s=typeof a.cancelAnimationFrame=="function"?a.cancelAnimationFrame:e(),p=typeof a.requestAnimationFrame=="function"?a.requestAnimationFrame:t(),m,d,b=342,L,C,y,f,T,O,A,B;return{start:k,stop:w,cancel:R};function R(){s(L),s(B)}function k(){m=n(),f=A=C=T=0,d=new Date,s(L),s(B),L=p(x)}function x(){var E=Date.now(),N=E-d;d=E;var M=n(),v=M.x-m.x,W=M.y-m.y;m=M;var G=1e3/(1+N);C=.8*v*G+.2*C,T=.8*W*G+.2*T,L=p(x)}function w(){s(L),s(B);var E=n();y=E.x,O=E.y,d=Date.now(),(C<-o||C>o)&&(f=u*C,y+=f),(T<-o||T>o)&&(A=u*T,O+=A),B=p(S)}function S(){var E=Date.now()-d,N=!1,M=0,v=0;f&&(M=-f*Math.exp(-E/b),M>.5||M<-.5?N=!0:M=f=0),A&&(v=-A*Math.exp(-E/b),v>.5||v<-.5?N=!0:v=A=0),N&&(r(y+M,O+v),B=p(S))}}function e(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function t(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(n){return setTimeout(n,16)}}return Ie}var ze,Tt;function Nn(){if(Tt)return ze;Tt=1,ze=h;function h(n){if(n)return{capture:t,release:t};var r,a,o,u=!1;return{capture:s,release:p};function s(m){u=!0,a=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=e,r=m,r.ondragstart=e}function p(){u&&(u=!1,window.document.onselectstart=a,r&&(r.ondragstart=o))}}function e(n){return n.stopPropagation(),!1}function t(){}return ze}var qe,Lt;function An(){if(Lt)return qe;Lt=1,qe=h;function h(){this.x=0,this.y=0,this.scale=1}return qe}var we={exports:{}},Ct;function Rn(){if(Ct)return we.exports;Ct=1,we.exports=h,we.exports.canAttach=e;function h(t,n){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var r=t.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");n.disableKeyboardInteraction||r.setAttribute("tabindex",0);var a={getBBox:u,getScreenCTM:s,getOwner:o,applyTransform:m,initTransform:p};return a;function o(){return r}function u(){var d=t.getBBox();return{left:d.x,top:d.y,width:d.width,height:d.height}}function s(){var d=r.getCTM();return d||r.getScreenCTM()}function p(d){var b=t.getCTM();b===null&&(b=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),d.x=b.e,d.y=b.f,d.scale=b.a,r.removeAttributeNS(null,"viewBox")}function m(d){t.setAttribute("transform","matrix("+d.scale+" 0 0 "+d.scale+" "+d.x+" "+d.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return we.exports}var xe={exports:{}},Nt;function kn(){if(Nt)return xe.exports;Nt=1,xe.exports=h,xe.exports.canAttach=e;function h(t,n){var r=e(t);if(!r)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var a=t.parentElement;t.scrollTop=0,n.disableKeyboardInteraction||a.setAttribute("tabindex",0);var o={getBBox:s,getOwner:u,applyTransform:p};return o;function u(){return a}function s(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function p(m){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+m.scale+", 0, 0, "+m.scale+", "+m.x+", "+m.y+")"}}function e(t){return t&&t.parentElement&&t.style}return xe.exports}var De,At;function Bn(){if(At)return De;At=1;var h=En(),e=Tn(),t=Ln(),n=Cn(),r=Nn(),a=r(),o=r(!0),u=An(),s=Rn(),p=kn(),m=1,d=1.75,b=300,L=200;De=C;function C(x,w){w=w||{};var S=w.controller;if(S||(s.canAttach(x)?S=s(x,w):p.canAttach(x)&&(S=p(x,w))),!S)throw new Error("Cannot create panzoom for the current type of dom element");var E=S.getOwner(),N={x:0,y:0},M=!1,v=new u;S.initTransform&&S.initTransform(v);var W=typeof w.filterKey=="function"?w.filterKey:T,G=typeof w.pinchSpeed=="number"?w.pinchSpeed:1,_=w.bounds,q=typeof w.maxZoom=="number"?w.maxZoom:Number.POSITIVE_INFINITY,P=typeof w.minZoom=="number"?w.minZoom:0,F=typeof w.boundsPadding=="number"?w.boundsPadding:.05,Z=typeof w.zoomDoubleClickSpeed=="number"?w.zoomDoubleClickSpeed:d,be=w.beforeWheel||T,te=w.beforeMouseDown||T,Se=typeof w.zoomSpeed=="number"?w.zoomSpeed:m,Y=y(w.transformOrigin),Ee=w.enableTextSelection?o:a;O(_),w.autocenter&&Dt();var ne,je=0,He=0,re=0,Ve=null,We=new Date,Me,ie=!1,ae=!1,j,H,Te,Le,Ce,V;"smoothScroll"in w&&!w.smoothScroll?V=R():V=n(Ut,Jt,w.smoothScroll);var Ne,oe,de,fe=!1;Qe();var he={dispose:en,moveBy:Q,moveTo:Ae,smoothMoveTo:Qt,centerOn:Kt,zoomTo:ge,zoomAbs:me,smoothZoom:ve,smoothZoomAbs:cn,showRectangle:qt,pause:Ot,resume:It,isPaused:zt,getTransform:Pt,getMinZoom:Ft,setMinZoom:Zt,getMaxZoom:jt,setMaxZoom:Ht,getTransformOrigin:Vt,setTransformOrigin:Wt,getZoomSpeed:_t,setZoomSpeed:Yt};t(he);var _e=typeof w.initialX=="number"?w.initialX:v.x,Ye=typeof w.initialY=="number"?w.initialY:v.y,Ue=typeof w.initialZoom=="number"?w.initialZoom:v.scale;return(_e!=v.x||Ye!=v.y||Ue!=v.scale)&&me(_e,Ye,Ue),he;function Ot(){Je(),fe=!0}function It(){fe&&(Qe(),fe=!1)}function zt(){return fe}function qt(i){var c=E.getBoundingClientRect(),l=X(c.width,c.height),g=i.right-i.left,$=i.bottom-i.top;if(!Number.isFinite(g)||!Number.isFinite($))throw new Error("Invalid rectangle");var I=l.x/g,z=l.y/$,D=Math.min(I,z);v.x=-(i.left+g/2)*D+l.x/2,v.y=-(i.top+$/2)*D+l.y/2,v.scale=D}function X(i,c){if(S.getScreenCTM){var l=S.getScreenCTM(),g=l.a,$=l.d,I=l.e,z=l.f;N.x=i*g-I,N.y=c*$-z}else N.x=i,N.y=c;return N}function Dt(){var i,c,l=0,g=0,$=Xe();if($)l=$.left,g=$.top,i=$.right-$.left,c=$.bottom-$.top;else{var I=E.getBoundingClientRect();i=I.width,c=I.height}var z=S.getBBox();if(!(z.width===0||z.height===0)){var D=c/z.height,ee=i/z.width,K=Math.min(ee,D);v.x=-(z.left+z.width/2)*K+i/2+l,v.y=-(z.top+z.height/2)*K+c/2+g,v.scale=K}}function Pt(){return v}function Ft(){return P}function Zt(i){P=i}function jt(){return q}function Ht(i){q=i}function Vt(){return Y}function Wt(i){Y=y(i)}function _t(){return Se}function Yt(i){if(!Number.isFinite(i))throw new Error("Zoom speed should be a number");Se=i}function Ut(){return{x:v.x,y:v.y}}function Ae(i,c){v.x=i,v.y=c,Re(),J("pan"),ke()}function Ge(i,c){Ae(v.x+i,v.y+c)}function Re(){var i=Xe();if(i){var c=!1,l=Gt(),g=i.left-l.right;return g>0&&(v.x+=g,c=!0),g=i.right-l.left,g<0&&(v.x+=g,c=!0),g=i.top-l.bottom,g>0&&(v.y+=g,c=!0),g=i.bottom-l.top,g<0&&(v.y+=g,c=!0),c}}function Xe(){if(_){if(typeof _=="boolean"){var i=E.getBoundingClientRect(),c=i.width,l=i.height;return{left:c*F,top:l*F,right:c*(1-F),bottom:l*(1-F)}}return _}}function Gt(){var i=S.getBBox(),c=Xt(i.left,i.top);return{left:c.x,top:c.y,right:i.width*v.scale+c.x,bottom:i.height*v.scale+c.y}}function Xt(i,c){return{x:i*v.scale+v.x,y:c*v.scale+v.y}}function ke(){M=!0,ne=window.requestAnimationFrame(tn)}function Ke(i,c,l){if(B(i)||B(c)||B(l))throw new Error("zoom requires valid numbers");var g=v.scale*l;if(g<P){if(v.scale===P)return;l=P/v.scale}if(g>q){if(v.scale===q)return;l=q/v.scale}var $=X(i,c);if(v.x=$.x-l*($.x-v.x),v.y=$.y-l*($.y-v.y),_&&F===1&&P===1)v.scale*=l,Re();else{var I=Re();I||(v.scale*=l)}J("zoom"),ke()}function me(i,c,l){var g=l/v.scale;Ke(i,c,g)}function Kt(i){var c=i.ownerSVGElement;if(!c)throw new Error("ui element is required to be within the scene");var l=i.getBoundingClientRect(),g=l.left+l.width/2,$=l.top+l.height/2,I=c.getBoundingClientRect(),z=I.width/2-g,D=I.height/2-$;Q(z,D,!0)}function Qt(i,c){Q(i-v.x,c-v.y,!0)}function Q(i,c,l){if(!l)return Ge(i,c);Ne&&Ne.cancel();var g={x:0,y:0},$={x:i,y:c},I=0,z=0;Ne=e(g,$,{step:function(D){Ge(D.x-I,D.y-z),I=D.x,z=D.y}})}function Jt(i,c){ye(),Ae(i,c)}function en(){Je()}function Qe(){E.addEventListener("mousedown",st,{passive:!1}),E.addEventListener("dblclick",ot,{passive:!1}),E.addEventListener("touchstart",tt,{passive:!1}),E.addEventListener("keydown",et,{passive:!1}),h.addWheelListener(E,ft,{passive:!1}),ke()}function Je(){h.removeWheelListener(E,ft),E.removeEventListener("mousedown",st),E.removeEventListener("keydown",et),E.removeEventListener("dblclick",ot),E.removeEventListener("touchstart",tt),ne&&(window.cancelAnimationFrame(ne),ne=0),V.cancel(),ut(),dt(),Ee.release(),Be()}function tn(){M&&nn()}function nn(){M=!1,S.applyTransform(v),J("transform"),ne=0}function et(i){var c=0,l=0,g=0;if(i.keyCode===38?l=1:i.keyCode===40?l=-1:i.keyCode===37?c=1:i.keyCode===39?c=-1:i.keyCode===189||i.keyCode===109?g=1:(i.keyCode===187||i.keyCode===107)&&(g=-1),!W(i,c,l,g)){if(c||l){i.preventDefault(),i.stopPropagation();var $=E.getBoundingClientRect(),I=Math.min($.width,$.height),z=.05,D=I*z*c,ee=I*z*l;Q(D,ee)}if(g){var K=ht(g*100),I=Y?ce():rn();ge(I.x,I.y,K)}}}function rn(){var i=E.getBoundingClientRect();return{x:i.width/2,y:i.height/2}}function tt(i){if(an(i),se(),i.touches.length===1)return sn(i,i.touches[0]);i.touches.length===2&&(Ce=at(i.touches[0],i.touches[1]),de=!0,nt())}function an(i){w.onTouch&&!w.onTouch(i)||(i.stopPropagation(),i.preventDefault())}function on(i){se(),!(w.onDoubleClick&&!w.onDoubleClick(i))&&(i.preventDefault(),i.stopPropagation())}function sn(i){He=new Date;var c=i.touches[0],l=U(c);Me=l;var g=X(l.x,l.y);j=g.x,H=g.y,Te=j,Le=H,V.cancel(),nt()}function nt(){ie||(ie=!0,document.addEventListener("touchmove",rt),document.addEventListener("touchend",pe),document.addEventListener("touchcancel",pe))}function rt(i){if(i.touches.length===1){i.stopPropagation();var c=i.touches[0],l=U(c),g=X(l.x,l.y),$=g.x-j,I=g.y-H;$!==0&&I!==0&&mt(),j=g.x,H=g.y,Q($,I)}else if(i.touches.length===2){de=!0;var z=i.touches[0],D=i.touches[1],ee=at(z,D),K=1+(ee/Ce-1)*G,pt=U(z),vt=U(D);if(j=(pt.x+vt.x)/2,H=(pt.y+vt.y)/2,Y){var l=ce();j=l.x,H=l.y}ge(j,H,K),Ce=ee,i.stopPropagation(),i.preventDefault()}}function se(){re&&(clearTimeout(re),re=0)}function it(i){if(w.onClick){se();var c=j-Te,l=H-Le,g=Math.sqrt(c*c+l*l);g>5||(re=setTimeout(function(){re=0,w.onClick(i)},b))}}function pe(i){if(se(),i.touches.length>0){var c=U(i.touches[0]),l=X(c.x,c.y);j=l.x,H=l.y}else{var g=new Date;if(g-je<b)if(Y){var c=ce();ve(c.x,c.y,Z)}else ve(Me.x,Me.y,Z);else g-He<L&&it(i);je=g,Be(),dt()}}function at(i,c){var l=i.clientX-c.clientX,g=i.clientY-c.clientY;return Math.sqrt(l*l+g*g)}function ot(i){on(i);var c=U(i);Y&&(c=ce()),ve(c.x,c.y,Z)}function st(i){if(se(),!te(i)){if(Ve=i,We=new Date,ie)return i.stopPropagation(),!1;var c=i.button===1&&window.event!==null||i.button===0;if(c){V.cancel();var l=U(i),g=X(l.x,l.y);return Te=j=g.x,Le=H=g.y,document.addEventListener("mousemove",ct),document.addEventListener("mouseup",lt),Ee.capture(i.target||i.srcElement),!1}}}function ct(i){if(!ie){mt();var c=U(i),l=X(c.x,c.y),g=l.x-j,$=l.y-H;j=l.x,H=l.y,Q(g,$)}}function lt(){var i=new Date;i-We<L&&it(Ve),Ee.release(),Be(),ut()}function ut(){document.removeEventListener("mousemove",ct),document.removeEventListener("mouseup",lt),ae=!1}function dt(){document.removeEventListener("touchmove",rt),document.removeEventListener("touchend",pe),document.removeEventListener("touchcancel",pe),ae=!1,de=!1,ie=!1}function ft(i){if(!be(i)){V.cancel();var c=i.deltaY;i.deltaMode>0&&(c*=100);var l=ht(c);if(l!==1){var g=Y?ce():U(i);ge(g.x,g.y,l),i.preventDefault()}}}function U(i){var c,l,g=E.getBoundingClientRect();return c=i.clientX-g.left,l=i.clientY-g.top,{x:c,y:l}}function ve(i,c,l){var g=v.scale,$={scale:g},I={scale:l*g};V.cancel(),ye(),oe=e($,I,{step:function(z){me(i,c,z.scale)},done:ln})}function cn(i,c,l){var g=v.scale,$={scale:g},I={scale:l};V.cancel(),ye(),oe=e($,I,{step:function(z){me(i,c,z.scale)}})}function ce(){var i=E.getBoundingClientRect();return{x:i.width*Y.x,y:i.height*Y.y}}function ge(i,c,l){return V.cancel(),ye(),Ke(i,c,l)}function ye(){oe&&(oe.cancel(),oe=null)}function ht(i){var c=Math.sign(i),l=Math.min(.25,Math.abs(Se*i/128));return 1-c*l}function mt(){ae||(J("panstart"),ae=!0,V.start())}function Be(){ae&&(de||V.stop(),J("panend"))}function ln(){J("zoomend")}function J(i){he.fire(i,he)}}function y(x){if(x){if(typeof x=="object")return(!A(x.x)||!A(x.y))&&f(x),x;f()}}function f(x){throw console.error(x),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function T(){}function O(x){var w=typeof x;if(!(w==="undefined"||w==="boolean")){var S=A(x.left)&&A(x.top)&&A(x.bottom)&&A(x.right);if(!S)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function A(x){return Number.isFinite(x)}function B(x){return Number.isNaN?Number.isNaN(x):x!==x}function R(){return{start:T,stop:T,cancel:T}}function k(){if(typeof document>"u")return;var x=document.getElementsByTagName("script");if(!x)return;for(var w,S=0;S<x.length;++S){var E=x[S];if(E.src&&E.src.match(/\bpanzoom(\.min)?\.js/)){w=E;break}}if(!w)return;var N=w.getAttribute("query");if(!N)return;var M=w.getAttribute("name")||"pz",v=Date.now();W();function W(){var q=document.querySelector(N);if(!q){var P=Date.now(),F=P-v;if(F<2e3){setTimeout(W,100);return}console.error("Cannot find the panzoom element",M);return}var Z=G(w);console.log(Z),window[M]=C(q,Z)}function G(q){for(var P=q.attributes,F={},Z=0;Z<P.length;++Z){var be=P[Z],te=_(be);te&&(F[te.name]=te.value)}return F}function _(q){if(q.name){var P=q.name[0]==="p"&&q.name[1]==="z"&&q.name[2]==="-";if(P){var F=q.name.substr(3),Z=JSON.parse(q.value);return{name:F,value:Z}}}}}return k(),De}var $n=Bn();const On=Sn($n);class In{pz;currentScale=1;currentX=0;currentY=0;constructor(e,t,n){this.pz=On(e,{maxZoom:3,minZoom:.2,bounds:!1,beforeMouseDown:u=>u.target.closest(".db-table")!==null});const r=u=>{const s=u.getTransform();this.currentScale=s.scale,this.currentX=s.x||0,this.currentY=s.y||0,t(this.currentScale),n&&n(this.currentScale,this.currentX,this.currentY)};this.pz.on("zoom",r),this.pz.on("pan",r);const a=window.innerWidth/2,o=window.innerHeight/2;this.pz.moveTo(-a,-o),this.currentX=-a,this.currentY=-o,n&&n(1,-a,-o)}getScale(){return this.currentScale}getTransform(){return{scale:this.currentScale,x:this.currentX,y:this.currentY}}setTransform(e,t,n){this.pz.moveTo(t,n),this.pz.zoomAbs(0,0,e),this.currentScale=e,this.currentX=t,this.currentY=n}zoomIn(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,1.25)}zoomOut(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,.8)}resetView(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.moveTo(-e,-t),this.pz.zoomAbs(0,0,1),this.currentScale=1,this.currentX=-e,this.currentY=-t}dispose(){this.pz.dispose()}}class Rt{el;container;constructor(e,t,n){this.container=e,this.el=document.createElement("div"),this.el.className="schema-hud";const r=document.createElement("div");r.className="hud-group";const a=this.createButton("+","Zoom In");a.onclick=()=>t.zoomIn();const o=this.createButton("−","Zoom Out");o.onclick=()=>t.zoomOut();const u=this.createButton("⌂","Reset View");u.onclick=()=>t.resetView(),r.append(a,o,u);const s=document.createElement("div");s.className="hud-group";const p=document.createElement("select");p.className="hud-select",p.title="Connection Line Style",[{value:"Curve",text:"Curve"},{value:"Rectilinear",text:"Rectilinear"},{value:"RoundRectilinear",text:"Round Rectilinear"},{value:"Oblique",text:"Oblique"},{value:"RoundOblique",text:"Round Oblique"}].forEach(L=>{const C=document.createElement("option");C.value=L.value,C.innerText=L.text,p.appendChild(C)}),p.onchange=L=>{const C=L.target.value;n.setLineStyle(C),this.dispatchProjectSettingsChange({lineStyle:C})},s.appendChild(p);const d=document.createElement("div");d.className="hud-group";const b=this.createButton("▓","Toggle Grid");b.title="Toggle grid",b.dataset.state="off",b.onclick=()=>{const C=!(b.dataset.state==="on");b.dataset.state=C?"on":"off",C?this.container.querySelector(".schema-wrapper")?.classList.add("grid-visible"):this.container.querySelector(".schema-wrapper")?.classList.remove("grid-visible"),this.dispatchProjectSettingsChange({showGrid:C})},d.appendChild(b),this.el.append(d,s,r),e.appendChild(this.el)}createButton(e,t){const n=document.createElement("button");return n.className="hud-btn",n.innerText=e,n.title=t,n}dispatchProjectSettingsChange(e){const t=new CustomEvent("project-settings-changed",{detail:e});this.container.dispatchEvent(t)}}class zn{container;wrapper;connectionManager;dragManager;panZoomManager;hud;parsers={dbml:new vn};constructor(e,t,n){this.container=document.getElementById(e),this.wrapper=document.createElement("div"),this.wrapper.className="schema-wrapper",this.container.appendChild(this.wrapper),this.connectionManager=new wt(this.wrapper),this.dragManager=new bn(this.wrapper,this.connectionManager,t),this.panZoomManager=new In(this.wrapper,r=>{this.dragManager.updateScale(r),this.connectionManager.updateScale(r)},(r,a,o)=>{this.dragManager.updateScale(r),this.connectionManager.updateScale(r),n&&n(r,a,o)}),this.hud=new Rt(this.container,this.panZoomManager,this.connectionManager)}render(e,t){if(this.wrapper.innerHTML="",this.connectionManager=new wt(this.wrapper),this.dragManager.updateConnectionManager(this.connectionManager),this.connectionManager.updateScale(this.panZoomManager.getScale()),this.container.querySelector(".schema-hud")?.remove(),this.hud=new Rt(this.container,this.panZoomManager,this.connectionManager),!!t.trim())try{let n=(e||"").toLowerCase().trim();n.startsWith(".")&&(n=n.slice(1));const r=this.parsers[n];if(!r)throw new Error(`Unsupported format: ${e}`);const{tables:a,relationships:o,projectSettings:u}=r.parse(t);if(u){if(u.zoom!==void 0||u.panX!==void 0){const b=u.zoom||1,L=u.panX||0,C=u.panY||0;this.panZoomManager.setTransform(b,L,C)}(u.showGrid==="true"||u.showGrid===!0)&&this.wrapper.classList.add("grid-visible"),u.lineStyle&&this.connectionManager.setLineStyle(u.lineStyle)}const s=350,p=300,m=3;a.forEach((d,b)=>{const L=yn.create(d);this.wrapper.appendChild(L);let C=d.x!==void 0?d.x:50+b%m*s,y=d.y!==void 0?d.y:50+Math.floor(b/m)*p;if(L.style.left=`${C}px`,L.style.top=`${y}px`,d.width&&(L.style.width=`${d.width}px`),d.color){const f=L.querySelector(".db-table-header");f&&(f.style.backgroundColor=d.color)}}),this.dragManager.setRelationships(o),setTimeout(()=>{this.connectionManager.draw(o)},0)}catch(n){console.error(n),this.wrapper.innerHTML=`<div class="error">Error: ${n.message}</div>`}}}const Ze=new un(h=>{switch(h.type){case"UPDATE_CONTENT":qn.render(h.format,h.content);break;case"UPDATE_THEME":Pn(h.theme);break}}),qn=new zn("app",(h,e,t,n)=>{Ze.send({type:"UPDATE_TABLE_POS",tableName:h,x:e,y:t,width:n})}),Dn=document.getElementById("app");Dn.addEventListener("project-settings-changed",h=>{const e=h.detail||{};Ze.send({type:"UPDATE_PROJECT_SETTINGS",settings:{lineStyle:e.lineStyle,showGrid:e.showGrid}})});function Pn(h){h==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")}Ze.log("Webview Initialized & Ready");</script>
  <style rel="stylesheet" crossorigin>.db-table{position:absolute;top:0;left:0;min-width:200px;width:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 6px #0000001a;z-index:1;display:flex;flex-direction:column}.db-table.dragging,.db-table.resizing{box-shadow:0 10px 15px #0003;z-index:100}.db-table.dragging{cursor:grabbing}.db-table.resizing{cursor:col-resize}.db-table-header{background:var(--header-bg);color:var(--header-text);padding:10px;font-weight:700;border-top-left-radius:7px;border-top-right-radius:7px;cursor:grab;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:8px}.db-table-header:active{cursor:grabbing}.header-title-wrapper{display:flex;align-items:center;gap:6px}.table-icon{width:16px;height:16px;display:flex;opacity:.9}.table-icon svg{width:100%;height:100%;stroke-width:2.5px}.title{font-size:15px;line-height:1.2}.schema-banner{background:#fff3;padding:2px 6px;border-radius:4px;font-size:12px}.table-note{font-size:11px;color:#fffc;margin-top:4px;width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.resize-handle{position:absolute;top:0;right:0;width:12px;height:100%;cursor:col-resize;z-index:50;background:transparent;border-right:4px solid rgba(0,0,0,.1);transition:all .2s;border-top-right-radius:8px;border-bottom-right-radius:8px}.resize-handle:hover,.db-table.resizing .resize-handle{background-color:#3b82f61a;border-right:4px solid var(--header-bg)}body.dark .resize-handle{border-right:4px solid rgba(255,255,255,.1)}body.dark .resize-handle:hover{border-right:4px solid var(--header-bg)}.db-row{display:flex;justify-content:space-between;padding:8px;border-bottom:1px solid var(--table-border);font-size:13px;line-height:1.4;position:relative;transition:background-color .15s ease}.db-row:hover{background-color:#7d7d7d0d}.db-row:last-child{border-bottom:none;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.indexed-row{background:linear-gradient(to right,rgba(var(--header-rgb),.08),transparent)}.row-left{display:flex;align-items:flex-start;gap:8px;flex:1;min-width:0;padding-right:8px}.key-icon{width:12px;height:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px}.key-icon svg{width:100%;height:100%}.key-icon.pk{color:#eab308}.key-icon.fk{color:#3b82f6}.key-icon.pk-fk{color:#22c55e}.key-icon.empty{width:16px}.name-container{display:flex;flex-direction:column;overflow:hidden}.field-name{font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.field-note{font-size:11px;color:var(--text-secondary);margin-top:2px;line-height:1.2;font-style:italic;opacity:.8}.row-right{display:flex;align-items:flex-start;justify-content:flex-end;gap:6px;flex-shrink:0}.type-container{display:flex;flex-direction:column;align-items:flex-end}.field-type{color:var(--text-secondary);font-size:11px;font-family:SF Mono,Monaco,Menlo,Courier New,monospace;text-align:right;background:#9696961a;padding:1px 4px;border-radius:4px}.constrained-type{text-decoration-color:var(--header-bg);text-decoration-thickness:2px}.field-default{font-size:10px;color:var(--text-secondary);opacity:.7;text-align:right;margin-top:2px;max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.badge{font-size:9px;height:16px;padding:0 6px;display:flex;align-items:center;justify-content:center;border-radius:10px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;box-shadow:0 1px 2px #0000000d}.badge.unique{background:#f3e8ff;color:#7e22ce;border:1px solid rgba(126,34,206,.1)}.badge.not-null{background:#f3f4f6;color:#4b5563;border:1px solid rgba(75,85,99,.1)}.badge.enum{background:#ecfdf5;color:#047857;border:1px solid rgba(4,120,87,.1)}body.dark .db-row:hover{background-color:#ffffff0d}body.dark .field-type{background:#ffffff14;color:#a1a1aa}body.dark .badge.unique{background:#3b0764;color:#d8b4fe;border-color:#581c87}body.dark .badge.not-null{background:#374151;color:#e5e7eb;border-color:#4b5563}body.dark .badge.enum{background:#064e3b;color:#6ee7b7;border-color:#065f46}@keyframes flashHighlight{0%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}50%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 12px rgba(var(--header-rgb),.4)}to{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}}.db-row.highlighted{background-color:rgba(var(--header-rgb),.1);color:var(--text-primary);animation:flashHighlight 1.5s infinite;z-index:10}.db-table.highlighted{border-color:var(--header-bg);animation:flashTable 1.5s infinite;z-index:20}@keyframes flashTable{0%{box-shadow:0 4px 6px #0000001a}50%{box-shadow:0 0 15px rgba(var(--header-rgb),.6)}to{box-shadow:0 4px 6px #0000001a}}.connection-layer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:visible}.connection-group{pointer-events:auto;cursor:pointer}.relation-hit-area{fill:none;stroke:transparent;stroke-width:20px}.relation-line-base{fill:none;stroke:var(--line-color);stroke-width:2px;stroke-linecap:round;transition:stroke .3s,stroke-width .3s}.relation-line-flow{fill:none;stroke:var(--header-bg);stroke-width:2px;stroke-linecap:round;stroke-dasharray:15 150;opacity:.4;animation:flowAnimation 5s linear infinite}@keyframes flowAnimation{to{stroke-dashoffset:-165}}@keyframes continuousFlow{to{stroke-dashoffset:-24}}.connection-group.highlighted .relation-line-base{stroke:var(--header-bg);stroke-width:3px;opacity:.5}.connection-group.highlighted .relation-line-flow{opacity:1;stroke-width:3px;stroke-dasharray:12 12;animation:continuousFlow .8s linear infinite;filter:drop-shadow(0 0 4px var(--header-bg))}.anchor-port{fill:var(--bg-color);stroke:var(--line-color);stroke-width:2px;transition:all .3s}.anchor-port.highlighted{stroke:var(--header-bg);fill:var(--header-bg);r:5px;filter:drop-shadow(0 0 3px var(--header-bg))}.label-bg{fill:var(--bg-color);stroke:var(--table-border);transition:all .3s}.connection-group.highlighted .label-bg{stroke:var(--header-bg);fill:#fff}.relation-label-text{font-size:10px;font-weight:700;fill:var(--text-secondary);text-anchor:middle;dominant-baseline:middle;pointer-events:none}.connection-group.highlighted .relation-label-text{fill:var(--header-bg)}.schema-hud{position:absolute;bottom:20px;left:20px;right:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 12px #00000026;display:flex;flex-direction:column-reverse;align-items:flex-start;padding:8px;gap:8px;z-index:1000;-webkit-user-select:none;user-select:none}.hud-group{display:flex;gap:6px;align-items:center}.hud-group+.hud-group{border-top:1px solid var(--table-border);padding-top:8px;margin-top:6px}.hud-btn{background:transparent;border:1px solid transparent;color:var(--text-primary);border-radius:4px;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;cursor:pointer;transition:all .12s}.hud-btn:hover{background:rgba(var(--header-rgb),.06);color:var(--header-bg)}.hud-select{background:var(--bg-color);color:var(--text-primary);border:1px solid var(--table-border);border-radius:4px;padding:4px 8px;font-size:12px;outline:none;cursor:pointer}.schema-wrapper.grid-visible{background-image:linear-gradient(to right,var(--line-color) 1px,transparent 1px),linear-gradient(to bottom,var(--line-color) 1px,transparent 1px);background-size:20px 20px}:root{--bg-color: #f4f4f4;--table-bg: #ffffff;--table-border: #d1d5db;--header-bg: #3b82f6;--header-rgb: 59, 130, 246;--header-text: #ffffff;--text-primary: #1f2937;--text-secondary: #6b7280;--line-color: #9ca3af}body.dark{--bg-color: #1e1e1e;--table-bg: #2b2d30;--table-border: #4e5256;--header-bg: #3574f0;--header-rgb: 53, 116, 240;--header-text: #ffffff;--text-primary: #d1d5db;--text-secondary: #9ca3af;--line-color: #6b7280}body{margin:0;background:var(--bg-color);color:var(--text-primary);font-family:sans-serif;overflow:hidden}#app{width:100vw;height:100vh;overflow:hidden}.schema-wrapper{width:100%;height:100%;transform-origin:0 0;position:relative}</style>
</head>

<body>
<div id="app"></div>
</body>

</html>
