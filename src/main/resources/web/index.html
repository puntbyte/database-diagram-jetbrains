<!-- web/index.html -->
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="./vite.svg"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>web</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();class fn{onMessage;constructor(e){this.onMessage=e,window.addEventListener("message",t=>{const r=t.data;r&&typeof r.type=="string"&&this.onMessage(r)}),this.send({type:"READY"})}send(e){const t=JSON.stringify(e);window.cefQuery?window.cefQuery({request:t}):console.log("Bridge Dev Log:",e)}log(e){this.send({type:"LOG",level:"INFO",message:e})}}function re(m){return m.replace(/[^a-zA-Z0-9_]/g,"_")}function mn(m){return m.replace(/\/\*[\s\S]*?\*\//g,"").split(`
`).map(t=>{if(t.trim().startsWith("///"))return t;const n=t.indexOf("//");return n!==-1?t[n+2]==="/"?t:t.substring(0,n):t}).join(`
`)}function oe(m){const e=new Map;if(!m)return e;const t=[];let r="",n=!1;for(let o=0;o<m.length;o++){const c=m[o];(c==="'"||c==='"')&&(n=!n),c===","&&!n?(t.push(r.trim()),r=""):r+=c}r.trim()&&t.push(r.trim());for(let o of t){if(!o)continue;const c=o.indexOf(":");if(c!==-1){const s=o.substring(0,c).trim(),a=o.substring(c+1).trim();e.set(s.toLowerCase(),a)}else e.set(o.toLowerCase(),"true")}return e}function pn(m,e){const r=m.substring(0,e).split(`
`),n=[];for(let o=r.length-1;o>=0;o--){const c=r[o].trim();if(c)if(c.startsWith("///"))n.unshift(c.replace(/^\/\/\/\s?/,""));else break}return n.length>0?n.join(`
`):void 0}function xt(m){const e=m.trim(),t=/^(.*)\.\((.*)\)$/.exec(e);if(t){const c=t[1],s=t[2];return{table:re(c),columns:s.split(",").map(a=>a.trim())}}const r=e.split(".");if(r.length<2)return null;const n=r.pop(),o=r.join(".");return{table:re(o),columns:[n]}}function gn(m){const e={},r=/Project\s*(?:(?:"[^"]*")|(?:[\w]+))?\s*\{([\s\S]*?)\}/i.exec(m);if(r){const n=r[1],o={line_style:"lineStyle",show_grid:"showGrid",grid_size:"gridSize",database_type:"databaseType",note:"note"},c=/(\w+)\s*:\s*(?:'''([\s\S]*?)'''|'([^']*)'|([^ \n}]+))/g;let s;for(;(s=c.exec(n))!==null;){const a=s[1],l=s[2],d=s[3],h=s[4],x=o[a]||a;let u=l||d||h;u==="true"&&(u=!0),u==="false"&&(u=!1),!isNaN(Number(u))&&u!==""&&typeof u=="string"&&(u.includes("'")||(u=Number(u))),e[x]=u}}return e}function yt(m){const e=[],t=m.split(`
`).map(r=>r.trim()).filter(Boolean);for(let r of t){const n=/^(\(?\s*[\w\.,\s]+\s*\)?)(?:\s*\[(.*?)\])?$/i.exec(r);if(!n)continue;const o=n[1].replace(/^\(/,"").replace(/\)$/,"").split(",").map(s=>s.trim()).filter(Boolean),c=oe(n[2]||"");e.push({columns:o,settings:Object.fromEntries(c),raw:r})}return e}function wt(m,e,t,r){const n=oe(t);let o=n.has("pk")||n.has("primary key"),c=n.has("unique"),s=n.has("not null"),a=r;if(n.has("note")){let x=n.get("note");x.startsWith("'")&&x.endsWith("'")||x.startsWith('"')&&x.endsWith('"')?a=x.substring(1,x.length-1):a=x}let l=n.get("default");l&&(l.startsWith("'")&&l.endsWith("'")||l.startsWith("`")&&l.endsWith("`"))&&(l=l.substring(1,l.length-1));let d=!1,h;if(n.has("ref")){const x=n.get("ref"),u=/([<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/i.exec(x);u&&(d=!0,h={symbol:u[1],toTable:u[2],toColumn:u[3]})}return{name:m,type:e,isPk:o,isUnique:c,isNotNull:s,isFk:d,note:a,default:l,enumValues:void 0,inlineRef:h}}function zt(m,e,t,r,n,o){let c="1:n";return t==="<"?c="1:n":t===">"?c="n:1":t==="-"?c="1:1":t==="<>"&&(c="m:n"),{fromTable:m,fromColumns:e,toTable:r,toColumns:n,type:c,settings:o?Object.fromEntries(o):void 0}}function vn(m){const e=[],t=/Ref\s*(?:[a-zA-Z0-9_]+)?\s*\{([\s\S]*?)\}/gi;let r;for(;(r=t.exec(m))!==null;){const o=r[1];bt(o,e)}const n=/Ref\s*(?:[a-zA-Z0-9_]+)?\s*:\s*(.*)/gi;for(;(r=n.exec(m))!==null;){const o=r[1];bt(o,e)}return e}function bt(m,e){const t=m.split(`
`);for(let r of t){if(r=r.trim(),!r||r.startsWith("//"))continue;const o=/^(.*?)\s*(<>|[<>=-])\s*(.*)$/.exec(r);if(!o)continue;const c=o[1].trim(),s=o[2],a=o[3].trim();let l=a,d="";const h=a.indexOf("[");if(h!==-1){l=a.substring(0,h).trim();const v=a.lastIndexOf("]");v!==-1&&(d=a.substring(h+1,v))}const x=xt(c),u=xt(l),C=oe(d);x&&u&&e.push(zt(x.table,x.columns,s,u.table,u.columns,C))}}function xn(m){const e=[],t=[],r=new Map,n=/TablePartial\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/gi;let o;for(;(o=n.exec(m))!==null;){const a=o[1].replace(/"/g,""),l=o[2]||"",d=o[3]||"",h=/indexes\s*\{([\s\S]*?)\}/i.exec(d);let x=[],u=d;h&&(x=yt(h[1]),u=d.replace(h[0],""));const C=[],v=u.split(`
`);let y=[];for(let w of v){const b=w.trim();if(b.startsWith("///")){y.push(b.replace(/^\/\/\/\s?/,""));continue}if(!b||b.startsWith("Note"))continue;const T=/^("?[\w]+"?)\s+([a-zA-Z0-9_()\[\]]+)(?:\s*\[(.*?)\])?/.exec(b);if(T){const I=y.length>0?y.join(`
`):void 0;C.push(wt(T[1].replace(/"/g,""),T[2],T[3]||"",I)),y=[]}}r.set(a,{name:a,settings:oe(l),fields:C,indexes:x})}const c=/Table\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*(?:as\s+\w+\s*)?\{([\s\S]*?)\}/gi;let s;for(;(s=c.exec(m))!==null;){const a=s.index,l=pn(m,a),d=s[1].replace(/"/g,""),h=s[2]||"",x=s[3]||"",u=oe(h),C=/indexes\s*\{([\s\S]*?)\}/i.exec(x);let v=[],y=x;C&&(v=yt(C[1]),y=x.replace(C[0],""));const b=/^\s*Note(?:\s*:\s*|\s+)(['"])([\s\S]*?)\1/im.exec(y);let N;b&&(N=b[2],y=y.replace(b[0],""));const T=new Map,I=[],q=new Set,E=new Map,L=new Map,R=y.split(`
`);let M=[];for(let p of R){const V=p.trim();if(V.startsWith("///")){M.push(V.replace(/^\/\/\/\s?/,""));continue}if(!V)continue;if(V.startsWith("~")){const A=V.substring(1).trim(),F=r.get(A);if(F){for(const[z,Z]of F.settings)E.set(z,Z);for(const z of F.indexes){const Z=z.columns.join(",").toLowerCase();L.set(Z,z)}for(const z of F.fields)q.has(z.name)||(T.has(z.name)?T.set(z.name,z):(T.set(z.name,z),I.push(z.name)))}M=[];continue}const B=/^("?[\w]+"?)\s+([a-zA-Z0-9_()\[\]]+)(?:\s*\[(.*?)\])?/.exec(V);if(B){const A=B[1].replace(/"/g,""),F=B[2],z=B[3]||"",Z=M.length>0?M.join(`
`):void 0,K=wt(A,F,z,Z);q.add(A),T.has(A)?T.set(A,K):(T.set(A,K),I.push(A)),M=[]}}for(const[p,V]of u)E.set(p,V);for(const p of v){const V=p.columns.join(",").toLowerCase();L.set(V,p)}const $=I.map(p=>T.get(p));let O=l;if(E.has("note")){let p=E.get("note");(p.startsWith("'")&&p.endsWith("'")||p.startsWith('"')&&p.endsWith('"'))&&(p=p.substring(1,p.length-1)),O=p}else N&&(O=N);$.forEach(p=>{p.inlineRef&&t.push(zt(re(d),[p.name],p.inlineRef.symbol,re(p.inlineRef.toTable),[p.inlineRef.toColumn]))}),e.push({id:re(d),name:d,fields:$,note:O,color:E.get("color")||void 0,width:E.has("width")?parseInt(E.get("width"),10):void 0,x:E.has("x")?parseInt(E.get("x"),10):void 0,y:E.has("y")?parseInt(E.get("y"),10):void 0,settings:Object.fromEntries(E),indexes:Array.from(L.values())})}return{tables:e,inlineRelationships:t}}function yn(m){const e=[],t=/Note\s+(\w+)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/g;let r;for(;(r=t.exec(m))!==null;){const n=r[1],o=r[2]||"";let c=r[3].trim();c.startsWith("'''")&&c.endsWith("'''")?c=c.substring(3,c.length-3):c.startsWith("'")&&c.endsWith("'")&&(c=c.substring(1,c.length-1));const s=oe(o);e.push({id:re(n),name:n,content:c.trim(),x:s.has("x")?parseInt(s.get("x"),10):0,y:s.has("y")?parseInt(s.get("y"),10):0,width:s.has("width")?parseInt(s.get("width"),10):250,color:s.get("color")||"#fff9c4"})}return e}class wn{parse(e){const t=mn(e),r=gn(t),{tables:n,inlineRelationships:o}=xn(t),c=vn(t),s=[...o,...c],a=yn(t);return{tables:n,relationships:s,projectSettings:r,notes:a}}}const bn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" width="800px" height="800px" viewBox="0 0 24 24"><path d="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>`,Ln=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M4 9L20 9M8 9V20M6.2 20H17.8C18.9201 20 19.4802 20 19.908 19.782C20.2843 19.5903 20.5903 19.2843 20.782 18.908C21 18.4802 21 17.9201 21 16.8V7.2C21 6.0799 21 5.51984 20.782 5.09202C20.5903 4.71569 20.2843 4.40973 19.908 4.21799C19.4802 4 18.9201 4 17.8 4H6.2C5.0799 4 4.51984 4 4.09202 4.21799C3.71569 4.40973 3.40973 4.71569 3.21799 5.09202C3 5.51984 3 6.07989 3 7.2V16.8C3 17.9201 3 18.4802 3.21799 18.908C3.40973 19.2843 3.71569 19.5903 4.09202 19.782C4.51984 20 5.07989 20 6.2 20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Sn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M6 12H18M12 6V18" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Cn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M6 12L18 12" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,En=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M15 4V7C15 8.10457 15.8954 9 17 9H20M9 4V7C9 8.10457 8.10457 9 7 9H4M15 20V17C15 15.8954 15.8954 15 17 15H20M9 20V17C9 15.8954 8.10457 15 7 15H4" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Mn=`<?xml version="1.0" encoding="utf-8"?>
\r\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">\r
  <title>grid</title>\r
  <g id="Layer_2" data-name="Layer 2">\r
    <g id="invisible_box" data-name="invisible box">\r
      <rect width="48" height="48" fill="none"/>\r
    </g>\r
    <g id="icons_Q2" data-name="icons Q2">\r
      <path d="M44,26a2,2,0,0,0,0-4H38V14h6a2,2,0,0,0,0-4H38V4a2,2,0,0,0-4,0v6H26V4a2,2,0,0,0-4,0v6H14V4a2,2,0,0,0-4,0v6H4a2,2,0,0,0,0,4h6v8H4a2,2,0,0,0,0,4h6v8H4a2,2,0,0,0,0,4h6v6a2,2,0,0,0,4,0V38h8v6a2,2,0,0,0,4,0V38h8v6a2,2,0,0,0,4,0V38h6a2,2,0,0,0,0-4H38V26ZM34,14v8H26V14ZM14,14h8v8H14Zm0,20V26h8v8Zm20,0H26V26h8Z"/>\r
    </g>\r
  </g>\r
</svg>`,Tn=`<?xml version="1.0" encoding="UTF-8"?>\r
\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\r
    <title>up_fill</title>\r
    <g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\r
        <g id="Arrow" transform="translate(-434.000000, -48.000000)">\r
            <g id="up_fill" transform="translate(434.000000, 48.000000)">\r
                <path d="M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z" id="MingCute" fill-rule="nonzero">
\r</path>\r
                <path d="M10.9393,7.93932 C11.5251,7.35354 12.4749,7.35354 13.0607,7.93932 L18.7175,13.5962 C19.3033,14.182 19.3033,15.1317 18.7175,15.7175 C18.1317,16.3033 17.182,16.3033 16.5962,15.7175 L12,11.1213 L7.40381,15.7175 C6.81802,16.3033 5.86827,16.3033 5.28248,15.7175 C4.6967,15.1317 4.6967,14.182 5.28249,13.5962 L10.9393,7.93932 Z" id="路径" fill="#09244B">
\r</path>\r
            </g>\r
        </g>\r
    </g>\r
</svg>`,J={Key:bn,Table:Ln,ZoomIn:Sn,ZoomOut:Cn,Center:En,Grid:Mn,ChevronUp:Tn};class Nn{static create(e,t){const r=document.createElement("div");r.className="db-row",r.id=`col-${t}-${e.name}`,e.isUnique&&r.classList.add("indexed-row");const n=document.createElement("div");n.className="row-left";const o=document.createElement("span");o.className="key-icon",e.isPk||e.isFk?(o.innerHTML=J.Key,e.isPk&&e.isFk?(o.classList.add("pk-fk"),o.title="Primary & Foreign Key"):e.isPk?(o.classList.add("pk"),o.title="Primary Key"):(o.classList.add("fk"),o.title="Foreign Key")):o.classList.add("empty"),n.appendChild(o);const c=document.createElement("div");c.className="name-container";const s=document.createElement("span");if(s.className="field-name",s.innerText=e.name,c.appendChild(s),e.note){const h=document.createElement("div");h.className="field-note",h.innerText=e.note,c.appendChild(h)}n.appendChild(c);const a=document.createElement("div");a.className="row-right";const l=document.createElement("div");l.className="type-container";const d=document.createElement("span");if(d.className="field-type",e.isUnique&&d.classList.add("constrained-type"),d.innerText=e.type,l.appendChild(d),e.enumValues&&e.enumValues.length>0){const h=this.createBadge("ENUM","enum");h.title=`Enum values: ${e.enumValues.join(", ")}`,a.appendChild(h)}if(e.isUnique&&a.appendChild(this.createBadge("UQ","unique")),e.isNotNull&&a.appendChild(this.createBadge("NN","not-null")),e.default){const h=document.createElement("div");h.className="field-default",h.innerText=`default: ${e.default}`,l.appendChild(h)}return a.appendChild(l),r.appendChild(n),r.appendChild(a),r}static createBadge(e,t){const r=document.createElement("span");return r.className=`badge ${t}`,r.innerText=e,r}}class Rn{static create(e){const t=document.createElement("div");t.className="db-table",t.id=`table-${e.id}`,t.dataset.tableName=e.name;const r=e.color||"var(--header-bg)";t.style.setProperty("--table-main-color",r),e.width&&(t.style.width=`${e.width}px`);const[n,o]=e.name.includes(".")?e.name.split("."):["",e.name],c=document.createElement("div");c.className="semantic-overlay";const s=document.createElement("div");s.className="overlay-text",s.innerText=o,c.appendChild(s),t.appendChild(c);const a=document.createElement("div");a.className="db-table-header";const l=document.createElement("div");l.className="header-title-wrapper";const d=document.createElement("span");d.className="table-icon",d.innerHTML=J.Table,l.appendChild(d);const h=document.createElement("span");h.className="title",h.innerText=o,l.appendChild(h),a.appendChild(l);const x=document.createElement("span");if(x.className="schema-banner",x.innerText=n||"public",a.appendChild(x),e.note){const C=document.createElement("div");C.className="table-note",C.innerText=e.note,a.appendChild(C)}t.appendChild(a),e.fields.forEach(C=>{t.appendChild(Nn.create(C,e.id))});const u=document.createElement("div");return u.className="resize-handle",u.title="Drag to resize",t.appendChild(u),t}}class An{static MIN_STRAIGHT=20;static MAX_STRAIGHT=80;static LANE_WIDTH=10;static LABEL_OFFSET=25;static MIN_U_TURN_OFFSET=30;static U_TURN_FACTOR=.2;static calculatePath(e,t,r,n,o,c,s,a){const l=(H,B,A)=>A<=1?H.y+H.height/2:H.y+H.height*(B+1)/(A+1),d=l(e,a.fromColIndex,a.fromColTotal),h=l(t,a.toColIndex,a.toColTotal),x={x:e.x+e.width,y:d},u={x:e.x,y:d},C={x:t.x+t.width,y:h},v={x:t.x,y:h},y=e.x<t.x+t.width&&e.x+e.width>t.x;let w,b,N,T;y?(w=x,b=C,N=1,T=1):e.x<t.x?(w=x,b=v,N=1,T=-1):(w=u,b=C,N=-1,T=1);const I=s==="Rectilinear"||s==="RoundRectilinear",q=Math.abs(b.x-w.x);let E=Math.max(this.MIN_STRAIGHT,Math.min(this.MAX_STRAIGHT,q/2));const L=E+(I?a.fromLaneIndex*this.LANE_WIDTH:0),R=E+(I?a.toLaneIndex*this.LANE_WIDTH:0),M={x:w.x+L*N,y:w.y},$={x:b.x+R*T,y:b.y};if(y){const H=Math.max(this.MIN_U_TURN_OFFSET,Math.abs(b.y-w.y)*this.U_TURN_FACTOR),B=I?Math.max(a.fromLaneIndex,a.toLaneIndex)*this.LANE_WIDTH:0;M.x=Math.max(w.x,b.x)+H+B,$.x=M.x}let O="";switch(s){case"Rectilinear":case"RoundRectilinear":{const H=(M.x+$.x)/2,B={x:H,y:w.y},A={x:H,y:b.y};if(s==="Rectilinear")O=`M ${w.x} ${w.y} L ${B.x} ${B.y} L ${A.x} ${A.y} L ${b.x} ${b.y}`;else{const F=Math.min(12,Math.abs(A.y-B.y)/2,Math.abs(B.x-w.x)/2),z=b.y>w.y?1:-1,Z=B.x>w.x?1:-1,K=b.x>A.x?1:-1;O=`M ${w.x} ${w.y} 
               L ${B.x-F*Z} ${B.y} 
               Q ${B.x} ${B.y} ${B.x} ${B.y+F*z} 
               L ${A.x} ${A.y-F*z} 
               Q ${A.x} ${A.y} ${A.x+F*K} ${A.y} 
               L ${b.x} ${b.y}`}break}case"Oblique":O=`M ${w.x} ${w.y} L ${M.x} ${M.y} L ${$.x} ${$.y} L ${b.x} ${b.y}`;break;case"RoundOblique":O=`M ${w.x} ${w.y} 
             L ${M.x} ${M.y} 
             Q ${(M.x+$.x)/2} ${(M.y+$.y)/2} ${$.x} ${$.y} 
             L ${b.x} ${b.y}`;break;default:O=`M ${w.x} ${w.y} C ${M.x} ${M.y}, ${$.x} ${$.y}, ${b.x} ${b.y}`;break}const p=this.getLabelPos(w,M,a.fromStagger),V=this.getLabelPos(b,$,a.toStagger);return{d:O,start:w,end:b,labelStart:{text:a.fromLabel,pos:p},labelEnd:{text:a.toLabel,pos:V},fromId:r,toId:n,fromTableId:o,toTableId:c}}static getLabelPos(e,t,r){const n=t.x-e.x,o=t.y-e.y,c=Math.sqrt(n*n+o*o),a=(this.LABEL_OFFSET+r*18)/(c||1);return{x:e.x+n*a,y:e.y+o*a}}}class In{static createGroup(e){const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.classList.add("connection-group"),t.dataset.from=e.fromId,t.dataset.to=e.toId,t.dataset.fromTable=e.fromTableId,t.dataset.toTable=e.toTableId;const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",e.d),r.classList.add("relation-hit-area"),t.appendChild(r);const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",e.d),n.classList.add("relation-line-base"),t.appendChild(n);const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",e.d),o.classList.add("relation-line-flow"),t.appendChild(o),this.createLabels(e).forEach(s=>t.appendChild(s)),t}static createLabels(e){const t=[];return e.labelStart.text&&t.push(this.createLabelBadge(e.labelStart.text,e.labelStart.pos.x,e.labelStart.pos.y)),e.labelEnd.text&&t.push(this.createLabelBadge(e.labelEnd.text,e.labelEnd.pos.x,e.labelEnd.pos.y)),t}static createLabelBadge(e,t,r){const n=document.createElementNS("http://www.w3.org/2000/svg","g");n.classList.add("relation-label-group");const o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttribute("x",(t-9).toString()),o.setAttribute("y",(r-7).toString()),o.setAttribute("width","18"),o.setAttribute("height","14"),o.setAttribute("rx","4"),o.classList.add("label-bg");const c=document.createElementNS("http://www.w3.org/2000/svg","text");return c.setAttribute("x",t.toString()),c.setAttribute("y",(r+1).toString()),c.classList.add("relation-label-text"),c.textContent=e,n.appendChild(o),n.appendChild(c),n}}class Lt{static create(e){const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx",e.x.toString()),t.setAttribute("cy",e.y.toString()),t.setAttribute("r","3.5"),t.classList.add("anchor-port"),t}}class St{svgLayer;scale=1;container;currentRelationships=[];currentLineStyle="Curve";constructor(e){this.container=e,this.svgLayer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgLayer.classList.add("connection-layer"),e.appendChild(this.svgLayer),this.setupInteractions()}updateScale(e){this.scale=e}setLineStyle(e){this.currentLineStyle=e,this.draw(this.currentRelationships)}draw(e){this.currentRelationships=e,this.svgLayer.innerHTML="";const t=new Map,r=new Map;e.forEach(s=>{const a=Math.max(1,Math.min(s.fromColumns.length,s.toColumns.length)),l=[];for(let d=0;d<a;d++)l.push({fromColIndex:0,fromColTotal:1,toColIndex:0,toColTotal:1,fromLaneIndex:0,toLaneIndex:0,fromLabel:null,fromStagger:0,toLabel:null,toStagger:0});r.set(s,l)});const n=s=>{if(!t.has(s)){const a=document.getElementById(s);a&&t.set(s,this.getRelativeRect(a))}return t.get(s)},o=new Map,c=new Map;e.forEach(s=>{const a=Math.min(s.fromColumns.length,s.toColumns.length);for(let l=0;l<a;l++){const d=s.fromColumns[l],h=s.toColumns[l],x=`col-${s.fromTable}-${d}`,u=`col-${s.toTable}-${h}`,C=n(x),v=n(u);if(!C||!v)continue;const y=l===0,w=y?this.getLabelString(s.type,!0):"",b=y?this.getLabelString(s.type,!1):"";o.has(x)||o.set(x,[]),o.get(x).push({rel:s,colPairIndex:l,isFrom:!0,rect:C,otherY:v.y+v.height/2,label:w}),o.has(u)||o.set(u,[]),o.get(u).push({rel:s,colPairIndex:l,isFrom:!1,rect:v,otherY:C.y+C.height/2,label:b});const N=C.x<v.x?"right":"left",T=v.x<C.x?"right":"left",I=`${s.fromTable}-${N}`,q=`${s.toTable}-${T}`,E={rel:s,colPairIndex:l,isFrom:!0,rect:C,otherY:v.y+v.height/2,label:""},L={rel:s,colPairIndex:l,isFrom:!1,rect:v,otherY:C.y+C.height/2,label:""};c.has(I)||c.set(I,[]),c.get(I).push(E),c.has(q)||c.set(q,[]),c.get(q).push(L)}});for(const s of o.values()){s.sort((h,x)=>h.otherY-x.otherY);const a=s.length,l=new Set;let d=0;s.forEach((h,x)=>{const u=r.get(h.rel)?.[h.colPairIndex];if(!u)return;let C=null,v=0;h.label&&(l.has(h.label)?(C=h.label,v=0):(l.add(h.label),C=h.label,v=d++)),h.isFrom?(u.fromColIndex=x,u.fromColTotal=a,u.fromLabel=C,u.fromStagger=v):(u.toColIndex=x,u.toColTotal=a,u.toLabel=C,u.toStagger=v)})}for(const[s,a]of c.entries()){if(a.length<=1)continue;const l=a.reduce((x,u)=>x+u.rect.y,0)/a.length,h=a.reduce((x,u)=>x+u.otherY,0)/a.length>l;a.sort((x,u)=>Math.abs(x.rect.y-u.rect.y)>1?x.rect.y-u.rect.y:x.otherY-u.otherY),a.forEach((x,u)=>{const C=r.get(x.rel)?.[x.colPairIndex];if(!C)return;const v=h?a.length-1-u:u;x.isFrom?C.fromLaneIndex=v:C.toLaneIndex=v})}e.forEach(s=>{const a=Math.min(s.fromColumns.length,s.toColumns.length);for(let l=0;l<a;l++){const d=`col-${s.fromTable}-${s.fromColumns[l]}`,h=`col-${s.toTable}-${s.toColumns[l]}`,x=t.get(d),u=t.get(h),C=r.get(s)?.[l];if(x&&u&&C){const v=An.calculatePath(x,u,d,h,`table-${s.fromTable}`,`table-${s.toTable}`,this.currentLineStyle,C),y=In.createGroup(v);if(s.settings&&s.settings.color){const N=s.settings.color,T=y.querySelector(".relation-line-base"),I=y.querySelector(".relation-line-flow");T&&(T.style.stroke=N),I&&(I.style.stroke=N)}this.svgLayer.appendChild(y);const w=Lt.create(v.start);w.dataset.anchorId=d,this.svgLayer.appendChild(w);const b=Lt.create(v.end);b.dataset.anchorId=h,this.svgLayer.appendChild(b)}}})}getLabelString(e,t){const r=e.split(":");return t?r[0]:r[1]}getRelativeRect(e){const t=e.getBoundingClientRect(),r=this.svgLayer.getBoundingClientRect();return{x:(t.left-r.left)/this.scale,y:(t.top-r.top)/this.scale,width:t.width/this.scale,height:t.height/this.scale}}setupInteractions(){this.container.addEventListener("mouseover",e=>this.handleHover(e,!0)),this.container.addEventListener("mouseout",e=>this.handleHover(e,!1))}handleHover(e,t){if(!t){this.clearHighlights();return}const r=e.target,n=r.closest(".connection-group");if(n){this.activateConnection(n);return}const o=r.closest(".db-row");if(o&&o.id){this.activateColumn(o.id);return}const c=r.closest(".db-table");if(c&&c.id){this.activateTable(c.id);return}}clearHighlights(){document.querySelectorAll(".highlighted").forEach(t=>t.classList.remove("highlighted"))}activateConnection(e){e.classList.add("highlighted");const t=e.dataset.from,r=e.dataset.to;t&&this.setHighlight(t),r&&this.setHighlight(r),this.highlightAnchorsForLine(t,r)}activateColumn(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from="${e}"], [data-to="${e}"]`).forEach(r=>{r.classList.add("highlighted");const n=r;n.dataset.from!==e&&this.setHighlight(n.dataset.from),n.dataset.to!==e&&this.setHighlight(n.dataset.to),this.highlightAnchorsForLine(n.dataset.from,n.dataset.to)})}activateTable(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from-table="${e}"], [data-to-table="${e}"]`).forEach(r=>{r.classList.add("highlighted");const n=r;this.setHighlight(n.dataset.from),this.setHighlight(n.dataset.to),this.highlightAnchorsForLine(n.dataset.from,n.dataset.to)})}setHighlight(e){if(!e)return;const t=document.getElementById(e);t&&t.classList.add("highlighted")}highlightAnchorsForLine(e,t){e&&this.svgLayer.querySelectorAll(`[data-anchor-id="${e}"]`).forEach(n=>n.classList.add("highlighted")),t&&this.svgLayer.querySelectorAll(`[data-anchor-id="${t}"]`).forEach(n=>n.classList.add("highlighted"))}}class kn{activeEl=null;mode="NONE";initialMouse={x:0,y:0};initialVal={x:0,y:0,width:0,height:0};scale=1;relationships=[];connectionManager;onUpdate;wrapper;constructor(e,t,r){this.wrapper=e,this.connectionManager=t,this.onUpdate=r,e.addEventListener("mousedown",n=>this.onMouseDown(n)),window.addEventListener("mousemove",n=>this.onMouseMove(n)),window.addEventListener("mouseup",()=>this.onMouseUp())}updateConnectionManager(e){this.connectionManager=e}setRelationships(e){this.relationships=e}updateScale(e){this.scale=e}onMouseDown(e){const t=e.target;if(t.classList.contains("resize-handle")){const n=t.parentElement;n&&this.startResize(n,e);return}if(t.closest(".db-table-header")||t.closest(".semantic-overlay")){const n=t.closest(".db-table");n&&this.startDrag(n,e);return}const r=t.closest(".sticky-note");if(r){this.startDrag(r,e);return}}startDrag(e,t){this.mode="DRAG",this.activeEl=e,this.initialVal.x=e.offsetLeft,this.initialVal.y=e.offsetTop,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("dragging")}startResize(e,t){this.mode="RESIZE",this.activeEl=e,this.initialVal.width=e.offsetWidth,this.initialVal.height=e.offsetHeight,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("resizing"),document.body.style.cursor="nwse-resize"}onMouseMove(e){if(!this.activeEl)return;const t=(e.clientX-this.initialMouse.x)/this.scale,r=(e.clientY-this.initialMouse.y)/this.scale;if(this.mode==="DRAG")this.activeEl.style.left=`${this.initialVal.x+t}px`,this.activeEl.style.top=`${this.initialVal.y+r}px`,this.activeEl.style.transform="none",this.activeEl.classList.contains("db-table")&&this.connectionManager.draw(this.relationships);else if(this.mode==="RESIZE"){const n=Math.max(100,this.initialVal.width+t);if(this.activeEl.style.width=`${n}px`,this.activeEl.classList.contains("sticky-note")){const o=Math.max(100,this.initialVal.height+r);this.activeEl.style.height=`${o}px`}this.activeEl.classList.contains("db-table")&&this.connectionManager.draw(this.relationships)}}onMouseUp(){if(!this.activeEl)return;const e=this.activeEl,t=Math.round(parseInt(e.style.left||"0",10)),r=Math.round(parseInt(e.style.top||"0",10)),n=Math.round(e.getBoundingClientRect().width/this.scale),o=Math.round(e.getBoundingClientRect().height/this.scale);if(e.classList.contains("db-table")){const c=e.querySelector(".title"),s=e.dataset&&e.dataset.tableName||(c?c.textContent||"":e.id.replace("table-",""));s&&this.onUpdate(s,t,r,n)}else if(e.classList.contains("sticky-note")){const c=e.dataset.noteId||e.id.replace("note-",""),s=new CustomEvent("note-pos-changed",{detail:{name:c,x:t,y:r,width:n,height:o},bubbles:!0});this.wrapper.dispatchEvent(s)}e.classList.remove("dragging"),e.classList.remove("resizing"),document.body.style.cursor="",this.activeEl=null,this.mode="NONE"}}function $n(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var fe={exports:{}},Ct;function On(){if(Ct)return fe.exports;Ct=1,fe.exports=m,fe.exports.addWheelListener=m,fe.exports.removeWheelListener=e;function m(t,r,n){t.addEventListener("wheel",r,n)}function e(t,r,n){t.removeEventListener("wheel",r,n)}return fe.exports}var me={exports:{}},Pe,Et;function zn(){if(Et)return Pe;Et=1;var m=4,e=.001,t=1e-7,r=10,n=11,o=1/(n-1),c=typeof Float32Array=="function";function s(v,y){return 1-3*y+3*v}function a(v,y){return 3*y-6*v}function l(v){return 3*v}function d(v,y,w){return((s(y,w)*v+a(y,w))*v+l(y))*v}function h(v,y,w){return 3*s(y,w)*v*v+2*a(y,w)*v+l(y)}function x(v,y,w,b,N){var T,I,q=0;do I=y+(w-y)/2,T=d(I,b,N)-v,T>0?w=I:y=I;while(Math.abs(T)>t&&++q<r);return I}function u(v,y,w,b){for(var N=0;N<m;++N){var T=h(y,w,b);if(T===0)return y;var I=d(y,w,b)-v;y-=I/T}return y}function C(v){return v}return Pe=function(y,w,b,N){if(!(0<=y&&y<=1&&0<=b&&b<=1))throw new Error("bezier x values must be in [0, 1] range");if(y===w&&b===N)return C;for(var T=c?new Float32Array(n):new Array(n),I=0;I<n;++I)T[I]=d(I*o,y,b);function q(E){for(var L=0,R=1,M=n-1;R!==M&&T[R]<=E;++R)L+=o;--R;var $=(E-T[R])/(T[R+1]-T[R]),O=L+$*o,p=h(O,y,b);return p>=e?u(E,O,y,b):p===0?O:x(E,L,L+o,y,b)}return function(L){return L===0?0:L===1?1:d(q(L),w,N)}},Pe}var Mt;function Bn(){if(Mt)return me.exports;Mt=1;var m=zn(),e={ease:m(.25,.1,.25,1),easeIn:m(.42,0,1,1),easeOut:m(0,0,.58,1),easeInOut:m(.42,0,.58,1),linear:m(0,0,1,1)};me.exports=t,me.exports.makeAggregateRaf=s,me.exports.sharedScheduler=s();function t(a,l,d){var h=Object.create(null),x=Object.create(null);d=d||{};var u=typeof d.easing=="function"?d.easing:e[d.easing];u||(d.easing&&console.warn("Unknown easing function in amator: "+d.easing),u=e.ease);var C=typeof d.step=="function"?d.step:r,v=typeof d.done=="function"?d.done:r,y=n(d.scheduler),w=Object.keys(l);w.forEach(function(R){h[R]=a[R],x[R]=l[R]-a[R]});var b=typeof d.duration=="number"?d.duration:400,N=Math.max(1,b*.06),T,I=0;return T=y.next(E),{cancel:q};function q(){y.cancel(T),T=0}function E(){var R=u(I/N);I+=1,L(R),I<=N?(T=y.next(E),C(a)):(T=0,setTimeout(function(){v(a)},0))}function L(R){w.forEach(function(M){a[M]=x[M]*R+h[M]})}}function r(){}function n(a){if(!a){var l=typeof window<"u"&&window.requestAnimationFrame;return l?o():c()}if(typeof a.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof a.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return a}function o(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function c(){return{next:function(a){return setTimeout(a,1e3/60)},cancel:function(a){return clearTimeout(a)}}}function s(){var a=new Set,l=new Set,d=0;return{next:x,cancel:x,clearAll:h};function h(){a.clear(),l.clear(),cancelAnimationFrame(d),d=0}function x(v){l.add(v),u()}function u(){d||(d=requestAnimationFrame(C))}function C(){d=0;var v=l;l=a,a=v,a.forEach(function(y){y()}),a.clear()}}return me.exports}var De,Tt;function Pn(){if(Tt)return De;Tt=1;function m(r){t(r);const n=e(r);return r.on=n.on,r.off=n.off,r.fire=n.fire,r}function e(r){let n=Object.create(null);return{on:function(o,c,s){if(typeof c!="function")throw new Error("callback is expected to be a function");let a=n[o];return a||(a=n[o]=[]),a.push({callback:c,ctx:s}),r},off:function(o,c){if(typeof o>"u")return n=Object.create(null),r;if(n[o])if(typeof c!="function")delete n[o];else{const s=n[o];for(let a=0;a<s.length;++a)s[a].callback===c&&s.splice(a,1)}return r},fire:function(o){const c=n[o];if(!c)return r;let s;arguments.length>1&&(s=Array.prototype.slice.call(arguments,1));for(let a=0;a<c.length;++a){const l=c[a];l.callback.apply(l.ctx,s)}return r}}}function t(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");const n=["on","fire","off"];for(let o=0;o<n.length;++o)if(r.hasOwnProperty(n[o]))throw new Error("Subject cannot be eventified, since it already has property '"+n[o]+"'")}return De=m,De}var Fe,Nt;function Dn(){if(Nt)return Fe;Nt=1,Fe=m;function m(r,n,o){typeof o!="object"&&(o={});var c=typeof o.minVelocity=="number"?o.minVelocity:5,s=typeof o.amplitude=="number"?o.amplitude:.25,a=typeof o.cancelAnimationFrame=="function"?o.cancelAnimationFrame:e(),l=typeof o.requestAnimationFrame=="function"?o.requestAnimationFrame:t(),d,h,x=342,u,C,v,y,w,b,N,T;return{start:q,stop:L,cancel:I};function I(){a(u),a(T)}function q(){d=r(),y=N=C=w=0,h=new Date,a(u),a(T),u=l(E)}function E(){var M=Date.now(),$=M-h;h=M;var O=r(),p=O.x-d.x,V=O.y-d.y;d=O;var H=1e3/(1+$);C=.8*p*H+.2*C,w=.8*V*H+.2*w,u=l(E)}function L(){a(u),a(T);var M=r();v=M.x,b=M.y,h=Date.now(),(C<-c||C>c)&&(y=s*C,v+=y),(w<-c||w>c)&&(N=s*w,b+=N),T=l(R)}function R(){var M=Date.now()-h,$=!1,O=0,p=0;y&&(O=-y*Math.exp(-M/x),O>.5||O<-.5?$=!0:O=y=0),N&&(p=-N*Math.exp(-M/x),p>.5||p<-.5?$=!0:p=N=0),$&&(n(v+O,b+p),T=l(R))}}function e(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function t(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(r){return setTimeout(r,16)}}return Fe}var Ze,Rt;function Fn(){if(Rt)return Ze;Rt=1,Ze=m;function m(r){if(r)return{capture:t,release:t};var n,o,c,s=!1;return{capture:a,release:l};function a(d){s=!0,o=window.document.onselectstart,c=window.document.ondragstart,window.document.onselectstart=e,n=d,n.ondragstart=e}function l(){s&&(s=!1,window.document.onselectstart=o,n&&(n.ondragstart=c))}}function e(r){return r.stopPropagation(),!1}function t(){}return Ze}var Ve,At;function Zn(){if(At)return Ve;At=1,Ve=m;function m(){this.x=0,this.y=0,this.scale=1}return Ve}var Se={exports:{}},It;function Vn(){if(It)return Se.exports;It=1,Se.exports=m,Se.exports.canAttach=e;function m(t,r){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var n=t.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");r.disableKeyboardInteraction||n.setAttribute("tabindex",0);var o={getBBox:s,getScreenCTM:a,getOwner:c,applyTransform:d,initTransform:l};return o;function c(){return n}function s(){var h=t.getBBox();return{left:h.x,top:h.y,width:h.width,height:h.height}}function a(){var h=n.getCTM();return h||n.getScreenCTM()}function l(h){var x=t.getCTM();x===null&&(x=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),h.x=x.e,h.y=x.f,h.scale=x.a,n.removeAttributeNS(null,"viewBox")}function d(h){t.setAttribute("transform","matrix("+h.scale+" 0 0 "+h.scale+" "+h.x+" "+h.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return Se.exports}var Ce={exports:{}},kt;function qn(){if(kt)return Ce.exports;kt=1,Ce.exports=m,Ce.exports.canAttach=e;function m(t,r){var n=e(t);if(!n)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var o=t.parentElement;t.scrollTop=0,r.disableKeyboardInteraction||o.setAttribute("tabindex",0);var c={getBBox:a,getOwner:s,applyTransform:l};return c;function s(){return o}function a(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function l(d){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+d.scale+", 0, 0, "+d.scale+", "+d.x+", "+d.y+")"}}function e(t){return t&&t.parentElement&&t.style}return Ce.exports}var qe,$t;function Hn(){if($t)return qe;$t=1;var m=On(),e=Bn(),t=Pn(),r=Dn(),n=Fn(),o=n(),c=n(!0),s=Zn(),a=Vn(),l=qn(),d=1,h=1.75,x=300,u=200;qe=C;function C(E,L){L=L||{};var R=L.controller;if(R||(a.canAttach(E)?R=a(E,L):l.canAttach(E)&&(R=l(E,L))),!R)throw new Error("Cannot create panzoom for the current type of dom element");var M=R.getOwner(),$={x:0,y:0},O=!1,p=new s;R.initTransform&&R.initTransform(p);var V=typeof L.filterKey=="function"?L.filterKey:w,H=typeof L.pinchSpeed=="number"?L.pinchSpeed:1,B=L.bounds,A=typeof L.maxZoom=="number"?L.maxZoom:Number.POSITIVE_INFINITY,F=typeof L.minZoom=="number"?L.minZoom:0,z=typeof L.boundsPadding=="number"?L.boundsPadding:.05,Z=typeof L.zoomDoubleClickSpeed=="number"?L.zoomDoubleClickSpeed:h,K=L.beforeWheel||w,ie=L.beforeMouseDown||w,Me=typeof L.zoomSpeed=="number"?L.zoomSpeed:d,U=v(L.transformOrigin),Te=L.enableTextSelection?c:o;b(B),L.autocenter&&Vt();var ae,He=0,_e=0,se=0,We=null,je=new Date,Ne,ce=!1,le=!1,W,j,Re,Ae,Ie,G;"smoothScroll"in L&&!L.smoothScroll?G=I():G=r(Xt,nn,L.smoothScroll);var ke,ue,pe,ge=!1;Je();var ve={dispose:rn,moveBy:ee,moveTo:$e,smoothMoveTo:tn,centerOn:en,zoomTo:be,zoomAbs:xe,smoothZoom:we,smoothZoomAbs:dn,showRectangle:Zt,pause:Pt,resume:Dt,isPaused:Ft,getTransform:qt,getMinZoom:Ht,setMinZoom:_t,getMaxZoom:Wt,setMaxZoom:jt,getTransformOrigin:Gt,setTransformOrigin:Ut,getZoomSpeed:Yt,setZoomSpeed:Kt};t(ve);var Ge=typeof L.initialX=="number"?L.initialX:p.x,Ue=typeof L.initialY=="number"?L.initialY:p.y,Ye=typeof L.initialZoom=="number"?L.initialZoom:p.scale;return(Ge!=p.x||Ue!=p.y||Ye!=p.scale)&&xe(Ge,Ue,Ye),ve;function Pt(){et(),ge=!0}function Dt(){ge&&(Je(),ge=!1)}function Ft(){return ge}function Zt(i){var f=M.getBoundingClientRect(),g=X(f.width,f.height),S=i.right-i.left,k=i.bottom-i.top;if(!Number.isFinite(S)||!Number.isFinite(k))throw new Error("Invalid rectangle");var P=g.x/S,D=g.y/k,_=Math.min(P,D);p.x=-(i.left+S/2)*_+g.x/2,p.y=-(i.top+k/2)*_+g.y/2,p.scale=_}function X(i,f){if(R.getScreenCTM){var g=R.getScreenCTM(),S=g.a,k=g.d,P=g.e,D=g.f;$.x=i*S-P,$.y=f*k-D}else $.x=i,$.y=f;return $}function Vt(){var i,f,g=0,S=0,k=Xe();if(k)g=k.left,S=k.top,i=k.right-k.left,f=k.bottom-k.top;else{var P=M.getBoundingClientRect();i=P.width,f=P.height}var D=R.getBBox();if(!(D.width===0||D.height===0)){var _=f/D.height,ne=i/D.width,Q=Math.min(ne,_);p.x=-(D.left+D.width/2)*Q+i/2+g,p.y=-(D.top+D.height/2)*Q+f/2+S,p.scale=Q}}function qt(){return p}function Ht(){return F}function _t(i){F=i}function Wt(){return A}function jt(i){A=i}function Gt(){return U}function Ut(i){U=v(i)}function Yt(){return Me}function Kt(i){if(!Number.isFinite(i))throw new Error("Zoom speed should be a number");Me=i}function Xt(){return{x:p.x,y:p.y}}function $e(i,f){p.x=i,p.y=f,Oe(),te("pan"),ze()}function Ke(i,f){$e(p.x+i,p.y+f)}function Oe(){var i=Xe();if(i){var f=!1,g=Qt(),S=i.left-g.right;return S>0&&(p.x+=S,f=!0),S=i.right-g.left,S<0&&(p.x+=S,f=!0),S=i.top-g.bottom,S>0&&(p.y+=S,f=!0),S=i.bottom-g.top,S<0&&(p.y+=S,f=!0),f}}function Xe(){if(B){if(typeof B=="boolean"){var i=M.getBoundingClientRect(),f=i.width,g=i.height;return{left:f*z,top:g*z,right:f*(1-z),bottom:g*(1-z)}}return B}}function Qt(){var i=R.getBBox(),f=Jt(i.left,i.top);return{left:f.x,top:f.y,right:i.width*p.scale+f.x,bottom:i.height*p.scale+f.y}}function Jt(i,f){return{x:i*p.scale+p.x,y:f*p.scale+p.y}}function ze(){O=!0,ae=window.requestAnimationFrame(on)}function Qe(i,f,g){if(T(i)||T(f)||T(g))throw new Error("zoom requires valid numbers");var S=p.scale*g;if(S<F){if(p.scale===F)return;g=F/p.scale}if(S>A){if(p.scale===A)return;g=A/p.scale}var k=X(i,f);if(p.x=k.x-g*(k.x-p.x),p.y=k.y-g*(k.y-p.y),B&&z===1&&F===1)p.scale*=g,Oe();else{var P=Oe();P||(p.scale*=g)}te("zoom"),ze()}function xe(i,f,g){var S=g/p.scale;Qe(i,f,S)}function en(i){var f=i.ownerSVGElement;if(!f)throw new Error("ui element is required to be within the scene");var g=i.getBoundingClientRect(),S=g.left+g.width/2,k=g.top+g.height/2,P=f.getBoundingClientRect(),D=P.width/2-S,_=P.height/2-k;ee(D,_,!0)}function tn(i,f){ee(i-p.x,f-p.y,!0)}function ee(i,f,g){if(!g)return Ke(i,f);ke&&ke.cancel();var S={x:0,y:0},k={x:i,y:f},P=0,D=0;ke=e(S,k,{step:function(_){Ke(_.x-P,_.y-D),P=_.x,D=_.y}})}function nn(i,f){Le(),$e(i,f)}function rn(){et()}function Je(){M.addEventListener("mousedown",ct,{passive:!1}),M.addEventListener("dblclick",st,{passive:!1}),M.addEventListener("touchstart",nt,{passive:!1}),M.addEventListener("keydown",tt,{passive:!1}),m.addWheelListener(M,ft,{passive:!1}),ze()}function et(){m.removeWheelListener(M,ft),M.removeEventListener("mousedown",ct),M.removeEventListener("keydown",tt),M.removeEventListener("dblclick",st),M.removeEventListener("touchstart",nt),ae&&(window.cancelAnimationFrame(ae),ae=0),G.cancel(),dt(),ht(),Te.release(),Be()}function on(){O&&an()}function an(){O=!1,R.applyTransform(p),te("transform"),ae=0}function tt(i){var f=0,g=0,S=0;if(i.keyCode===38?g=1:i.keyCode===40?g=-1:i.keyCode===37?f=1:i.keyCode===39?f=-1:i.keyCode===189||i.keyCode===109?S=1:(i.keyCode===187||i.keyCode===107)&&(S=-1),!V(i,f,g,S)){if(f||g){i.preventDefault(),i.stopPropagation();var k=M.getBoundingClientRect(),P=Math.min(k.width,k.height),D=.05,_=P*D*f,ne=P*D*g;ee(_,ne)}if(S){var Q=mt(S*100),P=U?he():sn();be(P.x,P.y,Q)}}}function sn(){var i=M.getBoundingClientRect();return{x:i.width/2,y:i.height/2}}function nt(i){if(cn(i),de(),i.touches.length===1)return un(i,i.touches[0]);i.touches.length===2&&(Ie=at(i.touches[0],i.touches[1]),pe=!0,rt())}function cn(i){L.onTouch&&!L.onTouch(i)||(i.stopPropagation(),i.preventDefault())}function ln(i){de(),!(L.onDoubleClick&&!L.onDoubleClick(i))&&(i.preventDefault(),i.stopPropagation())}function un(i){_e=new Date;var f=i.touches[0],g=Y(f);Ne=g;var S=X(g.x,g.y);W=S.x,j=S.y,Re=W,Ae=j,G.cancel(),rt()}function rt(){ce||(ce=!0,document.addEventListener("touchmove",ot),document.addEventListener("touchend",ye),document.addEventListener("touchcancel",ye))}function ot(i){if(i.touches.length===1){i.stopPropagation();var f=i.touches[0],g=Y(f),S=X(g.x,g.y),k=S.x-W,P=S.y-j;k!==0&&P!==0&&pt(),W=S.x,j=S.y,ee(k,P)}else if(i.touches.length===2){pe=!0;var D=i.touches[0],_=i.touches[1],ne=at(D,_),Q=1+(ne/Ie-1)*H,gt=Y(D),vt=Y(_);if(W=(gt.x+vt.x)/2,j=(gt.y+vt.y)/2,U){var g=he();W=g.x,j=g.y}be(W,j,Q),Ie=ne,i.stopPropagation(),i.preventDefault()}}function de(){se&&(clearTimeout(se),se=0)}function it(i){if(L.onClick){de();var f=W-Re,g=j-Ae,S=Math.sqrt(f*f+g*g);S>5||(se=setTimeout(function(){se=0,L.onClick(i)},x))}}function ye(i){if(de(),i.touches.length>0){var f=Y(i.touches[0]),g=X(f.x,f.y);W=g.x,j=g.y}else{var S=new Date;if(S-He<x)if(U){var f=he();we(f.x,f.y,Z)}else we(Ne.x,Ne.y,Z);else S-_e<u&&it(i);He=S,Be(),ht()}}function at(i,f){var g=i.clientX-f.clientX,S=i.clientY-f.clientY;return Math.sqrt(g*g+S*S)}function st(i){ln(i);var f=Y(i);U&&(f=he()),we(f.x,f.y,Z)}function ct(i){if(de(),!ie(i)){if(We=i,je=new Date,ce)return i.stopPropagation(),!1;var f=i.button===1&&window.event!==null||i.button===0;if(f){G.cancel();var g=Y(i),S=X(g.x,g.y);return Re=W=S.x,Ae=j=S.y,document.addEventListener("mousemove",lt),document.addEventListener("mouseup",ut),Te.capture(i.target||i.srcElement),!1}}}function lt(i){if(!ce){pt();var f=Y(i),g=X(f.x,f.y),S=g.x-W,k=g.y-j;W=g.x,j=g.y,ee(S,k)}}function ut(){var i=new Date;i-je<u&&it(We),Te.release(),Be(),dt()}function dt(){document.removeEventListener("mousemove",lt),document.removeEventListener("mouseup",ut),le=!1}function ht(){document.removeEventListener("touchmove",ot),document.removeEventListener("touchend",ye),document.removeEventListener("touchcancel",ye),le=!1,pe=!1,ce=!1}function ft(i){if(!K(i)){G.cancel();var f=i.deltaY;i.deltaMode>0&&(f*=100);var g=mt(f);if(g!==1){var S=U?he():Y(i);be(S.x,S.y,g),i.preventDefault()}}}function Y(i){var f,g,S=M.getBoundingClientRect();return f=i.clientX-S.left,g=i.clientY-S.top,{x:f,y:g}}function we(i,f,g){var S=p.scale,k={scale:S},P={scale:g*S};G.cancel(),Le(),ue=e(k,P,{step:function(D){xe(i,f,D.scale)},done:hn})}function dn(i,f,g){var S=p.scale,k={scale:S},P={scale:g};G.cancel(),Le(),ue=e(k,P,{step:function(D){xe(i,f,D.scale)}})}function he(){var i=M.getBoundingClientRect();return{x:i.width*U.x,y:i.height*U.y}}function be(i,f,g){return G.cancel(),Le(),Qe(i,f,g)}function Le(){ue&&(ue.cancel(),ue=null)}function mt(i){var f=Math.sign(i),g=Math.min(.25,Math.abs(Me*i/128));return 1-f*g}function pt(){le||(te("panstart"),le=!0,G.start())}function Be(){le&&(pe||G.stop(),te("panend"))}function hn(){te("zoomend")}function te(i){ve.fire(i,ve)}}function v(E){if(E){if(typeof E=="object")return(!N(E.x)||!N(E.y))&&y(E),E;y()}}function y(E){throw console.error(E),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function w(){}function b(E){var L=typeof E;if(!(L==="undefined"||L==="boolean")){var R=N(E.left)&&N(E.top)&&N(E.bottom)&&N(E.right);if(!R)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function N(E){return Number.isFinite(E)}function T(E){return Number.isNaN?Number.isNaN(E):E!==E}function I(){return{start:w,stop:w,cancel:w}}function q(){if(typeof document>"u")return;var E=document.getElementsByTagName("script");if(!E)return;for(var L,R=0;R<E.length;++R){var M=E[R];if(M.src&&M.src.match(/\bpanzoom(\.min)?\.js/)){L=M;break}}if(!L)return;var $=L.getAttribute("query");if(!$)return;var O=L.getAttribute("name")||"pz",p=Date.now();V();function V(){var A=document.querySelector($);if(!A){var F=Date.now(),z=F-p;if(z<2e3){setTimeout(V,100);return}console.error("Cannot find the panzoom element",O);return}var Z=H(L);console.log(Z),window[O]=C(A,Z)}function H(A){for(var F=A.attributes,z={},Z=0;Z<F.length;++Z){var K=F[Z],ie=B(K);ie&&(z[ie.name]=ie.value)}return z}function B(A){if(A.name){var F=A.name[0]==="p"&&A.name[1]==="z"&&A.name[2]==="-";if(F){var z=A.name.substr(3),Z=JSON.parse(A.value);return{name:z,value:Z}}}}}return q(),qe}var _n=Hn();const Wn=$n(_n);class jn{pz;currentScale=1;currentX=0;currentY=0;constructor(e,t,r){this.pz=Wn(e,{maxZoom:3,minZoom:.2,bounds:!1,beforeMouseDown:o=>o.target.closest(".db-table")!==null});const n=o=>{const c=o.getTransform();this.currentScale=c.scale,this.currentX=c.x||0,this.currentY=c.y||0,t(this.currentScale),r&&r(this.currentScale,this.currentX,this.currentY)};this.pz.on("zoom",n),this.pz.on("pan",n),this.pz.on("transform",n),this.resetView()}getScale(){return this.currentScale}getTransform(){return{scale:this.currentScale,x:this.currentX,y:this.currentY}}setTransform(e,t,r){this.pz.zoomAbs(0,0,1),this.pz.moveTo(t,r),this.pz.zoomAbs(0,0,e),this.currentScale=e,this.currentX=t,this.currentY=r}zoomIn(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,1.25)}zoomOut(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,.8)}resetView(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.moveTo(e,t),this.pz.zoomAbs(0,0,1),this.currentX=e,this.currentY=t,this.currentScale=1}dispose(){this.pz.dispose()}}class Ot{el;container;constructor(e,t,r){this.container=e,this.el=document.createElement("div"),this.el.className="schema-hud";const n=document.createElement("div");n.className="hud-group";const o=this.createButton(J.Grid,"Toggle Grid"),c=e.classList.contains("grid-visible");o.dataset.state=c?"on":"off",c&&o.classList.add("active"),o.onclick=()=>{const N=!(o.dataset.state==="on");o.dataset.state=N?"on":"off",o.classList.toggle("active",N),N?this.container.classList.add("grid-visible"):this.container.classList.remove("grid-visible"),this.dispatchProjectSettingsChange({showGrid:N})},n.appendChild(o);const s=document.createElement("div");s.className="hud-group";const a=[{value:"Curve",text:"Curve"},{value:"Rectilinear",text:"Rectilinear"},{value:"RoundRectilinear",text:"Round Rectilinear"},{value:"Oblique",text:"Oblique"},{value:"RoundOblique",text:"Round Oblique"}],l=document.createElement("div");l.className="custom-select";const d=document.createElement("div");d.className="select-trigger",d.title="Connection Line Style";const h=document.createElement("span");h.innerText="Curve",d.appendChild(h);const x=document.createElement("div");x.className="select-arrow",x.innerHTML=J.ChevronUp,d.appendChild(x);const u=document.createElement("div");u.className="select-options",d.onclick=b=>{b.stopPropagation(),l.classList.toggle("open")},window.addEventListener("click",b=>{l.contains(b.target)||l.classList.remove("open")}),a.forEach(b=>{const N=document.createElement("div");N.className="select-option",N.innerText=b.text,N.onclick=()=>{h.innerText=b.text,l.querySelectorAll(".select-option").forEach(T=>T.classList.remove("selected")),N.classList.add("selected"),l.classList.remove("open"),r.setLineStyle(b.value),this.dispatchProjectSettingsChange({lineStyle:b.value})},b.value==="Curve"&&N.classList.add("selected"),u.appendChild(N)}),l.appendChild(d),l.appendChild(u),s.appendChild(l);const C=document.createElement("div");C.className="hud-group";const v=this.createButton(J.ZoomIn,"Zoom In");v.onclick=()=>t.zoomIn();const y=this.createButton(J.ZoomOut,"Zoom Out");y.onclick=()=>t.zoomOut();const w=this.createButton(J.Center,"Reset View");w.onclick=()=>t.resetView(),C.append(y,w,v),this.el.append(n,s,C),e.appendChild(this.el)}createButton(e,t){const r=document.createElement("button");return r.className="hud-btn",r.innerHTML=e,r.title=t,r}dispatchProjectSettingsChange(e){const t=new CustomEvent("project-settings-changed",{detail:e});this.container.dispatchEvent(t)}}class Gn{static create(e){const t=document.createElement("div");t.className="sticky-note",t.id=`note-${e.id}`,t.dataset.noteId=e.name,t.style.left=`${e.x}px`,t.style.top=`${e.y}px`,t.style.width=`${e.width}px`,e.color&&(t.style.backgroundColor=e.color,t.style.color="#1f2937");const r=document.createElement("div");r.className="note-content",r.innerText=e.content,t.appendChild(r);const n=document.createElement("div");return n.className="resize-handle",t.appendChild(n),t}}class Un{container;wrapper;connectionManager;dragManager;panZoomManager;hud;parsers={dbml:new wn};constructor(e,t,r){this.container=document.getElementById(e),this.wrapper=document.createElement("div"),this.wrapper.className="schema-wrapper",this.container.appendChild(this.wrapper),this.connectionManager=new St(this.wrapper),this.dragManager=new kn(this.wrapper,this.connectionManager,t),this.panZoomManager=new jn(this.wrapper,n=>{this.updateZoomState(n),this.dragManager.updateScale(n),this.connectionManager.updateScale(n)},(n,o,c)=>{this.updateZoomState(n,o,c),this.dragManager.updateScale(n),this.connectionManager.updateScale(n),r&&r(n,o,c)}),this.hud=new Ot(this.container,this.panZoomManager,this.connectionManager)}updateZoomState(e,t,r){e<.5?this.wrapper.classList.add("semantic-zoom"):this.wrapper.classList.remove("semantic-zoom"),this.container.style.setProperty("--zoom",e.toString()),t!==void 0&&r!==void 0&&(this.container.style.setProperty("--pan-x",`${t}px`),this.container.style.setProperty("--pan-y",`${r}px`))}render(e,t){this.wrapper.innerHTML="",this.connectionManager=new St(this.wrapper),this.dragManager.updateConnectionManager(this.connectionManager);const r=this.panZoomManager.getTransform();if(this.connectionManager.updateScale(r.scale),this.dragManager.updateScale(r.scale),this.updateZoomState(r.scale),this.container.querySelector(".schema-hud")?.remove(),this.hud=new Ot(this.container,this.panZoomManager,this.connectionManager),this.container.style.setProperty("--zoom",r.scale.toString()),this.container.style.setProperty("--pan-x",`${r.x}px`),this.container.style.setProperty("--pan-y",`${r.y}px`),!!t.trim())try{let n=(e||"").toLowerCase().trim();n.startsWith(".")&&(n=n.slice(1));const o=this.parsers[n];if(!o)throw new Error(`Unsupported format: ${e}`);const{tables:c,relationships:s,projectSettings:a,notes:l}=o.parse(t);if(a){if(a.zoom!==void 0||a.panX!==void 0){const v=a.zoom||1,y=a.panX||0,w=a.panY||0;this.panZoomManager.setTransform(v,y,w),a.gridSize?this.container.style.setProperty("--grid-size",`${a.gridSize}px`):this.container.style.setProperty("--grid-size","20px"),this.container.style.setProperty("--zoom",v.toString()),this.container.style.setProperty("--pan-x",`${y}px`),this.container.style.setProperty("--pan-y",`${w}px`)}const u=a.showGrid===!0;u?this.container.classList.add("grid-visible"):this.container.classList.remove("grid-visible");const C=this.container.querySelector('.hud-btn[title="Toggle Grid"]');if(C&&(C.dataset.state=u?"on":"off",u?C.classList.add("active"):C.classList.remove("active")),a.lineStyle){this.connectionManager.setLineStyle(a.lineStyle);const v=this.container.querySelector(".select-trigger"),y=this.container.querySelectorAll(".select-option");v&&y.length&&(v.textContent=a.lineStyle,y.forEach(w=>{w.textContent===a.lineStyle?w.classList.add("selected"):w.classList.remove("selected")}))}l&&Array.isArray(l)&&l.forEach(v=>{const y=Gn.create(v);this.wrapper.appendChild(y)})}const d=350,h=300,x=3;c.forEach((u,C)=>{const v=Rn.create(u);this.wrapper.appendChild(v);let y=u.x!==void 0?u.x:50+C%x*d,w=u.y!==void 0?u.y:50+Math.floor(C/x)*h;if(v.style.left=`${y}px`,v.style.top=`${w}px`,u.width&&(v.style.width=`${u.width}px`),u.color){const b=v.querySelector(".db-table-header");b&&(b.style.backgroundColor=u.color)}}),this.dragManager.setRelationships(s),setTimeout(()=>{this.connectionManager.draw(s)},0)}catch(n){console.error(n),this.wrapper.innerHTML=`<div class="error" style="padding:20px; color:red;">Error: ${n.message}</div>`}}}const Ee=new fn(m=>{switch(m.type){case"UPDATE_CONTENT":Yn.render(m.format,m.content);break;case"UPDATE_THEME":Kn(m.theme);break}}),Yn=new Un("app",(m,e,t,r)=>{Ee.send({type:"UPDATE_TABLE_POS",tableName:m,x:e,y:t,width:r})}),Bt=document.getElementById("app");Bt.addEventListener("project-settings-changed",m=>{const e=m.detail||{};Ee.send({type:"UPDATE_PROJECT_SETTINGS",settings:{lineStyle:e.lineStyle,showGrid:e.showGrid}})});Bt.addEventListener("note-pos-changed",m=>{const e=m.detail;e&&Ee.send({type:"UPDATE_NOTE_POS",name:e.name,x:e.x,y:e.y,width:e.width,height:e.height})});function Kn(m){m==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")}Ee.log("Webview Initialized & Ready");</script>
  <style rel="stylesheet" crossorigin>:root{--icon-pk: #d97706;--icon-fk: #2563eb;--icon-pk-fk: #16a34a;--icon-default: var(--text-secondary)}body.dark{--icon-pk: #fbbf24;--icon-fk: #60a5fa;--icon-pk-fk: #4ade80}.icon-container svg{width:100%;height:100%;display:block;fill:none;stroke:currentColor;stroke-width:2px;stroke-linecap:round;stroke-linejoin:round}.icon-container.fill-mode svg{fill:currentColor;stroke:none}.key-icon{width:14px;height:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px;color:var(--icon-default)}.key-icon svg{width:100%;height:100%;stroke:currentColor;fill:none}.key-icon.pk{color:var(--icon-pk)}.key-icon.fk{color:var(--icon-fk)}.key-icon.pk-fk{color:var(--icon-pk-fk)}.key-icon.empty{width:14px}.table-icon{width:16px;height:16px;display:flex;align-items:center;justify-content:center;opacity:.9;color:var(--header-text)}.table-icon svg{width:100%;height:100%;stroke:currentColor;fill:none}.hud-btn svg,.select-arrow svg{width:18px;height:18px;stroke:currentColor;fill:none}.select-arrow svg{width:12px;height:12px}.db-table{--table-main-color: var(--header-bg);position:absolute;top:0;left:0;min-width:200px;width:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 6px #0000001a;z-index:1;display:flex;flex-direction:column}.db-table.dragging,.db-table.resizing{box-shadow:0 10px 15px #0003;z-index:100}.db-table.dragging{cursor:grabbing}.db-table.resizing{cursor:col-resize}.db-table-header{background:var(--header-bg);background-color:var(--table-main-color);color:var(--header-text);padding:10px;font-weight:700;border-top-left-radius:7px;border-top-right-radius:7px;cursor:grab;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:8px}.db-table-header:active{cursor:grabbing}.header-title-wrapper{display:flex;align-items:center;gap:6px}.table-icon{width:16px;height:16px;display:flex;opacity:.9}.title{font-size:15px;line-height:1.2}.schema-banner{background:#fff3;padding:2px 6px;border-radius:4px;font-size:12px}.table-note{font-size:11px;color:#fffc;margin-top:4px;width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.resize-handle{position:absolute;top:0;right:0;width:12px;height:100%;cursor:col-resize;z-index:50;background:transparent;border-right:4px solid rgba(0,0,0,.1);transition:all .2s;border-top-right-radius:8px;border-bottom-right-radius:8px}.resize-handle:hover,.db-table.resizing .resize-handle{background-color:#3b82f61a;border-right:4px solid var(--header-bg)}.semantic-overlay{position:absolute;inset:-1px;background-color:var(--table-main-color);color:#fff;border-radius:8px;z-index:200;display:flex;justify-content:center;align-items:center;text-align:center;padding:10px;opacity:0;pointer-events:none;transition:opacity .25s ease-in-out}.overlay-text{font-weight:700;font-size:clamp(16px,calc(18px / var(--zoom)),64px);word-break:break-word;line-height:1.2;text-shadow:0 2px 4px rgba(0,0,0,.2)}.schema-wrapper.semantic-zoom .semantic-overlay{opacity:1;pointer-events:auto;cursor:grab}.schema-wrapper.semantic-zoom .db-table.dragging .semantic-overlay{cursor:grabbing}.db-row{display:flex;justify-content:space-between;padding:6px;border-bottom:1px solid var(--table-border);font-size:12px;line-height:1.2;position:relative;transition:background-color .15s ease}.db-row:hover{background-color:#7d7d7d0d}.db-row:last-child{border-bottom:none;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.indexed-row{background:linear-gradient(to right,rgba(var(--header-rgb),.08),transparent)}.row-left{display:flex;align-items:flex-start;gap:8px;flex:1;min-width:0;padding-right:8px}.name-container{display:flex;flex-direction:column;overflow:hidden}.field-name{font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.field-note{font-size:11px;color:var(--text-secondary);margin-top:2px;line-height:1.2;font-style:italic;opacity:.8}.row-right{display:flex;align-items:flex-start;justify-content:flex-end;gap:6px;flex-shrink:0}.type-container{display:flex;flex-direction:column;align-items:flex-end}.field-type{color:var(--text-secondary);font-size:11px;font-family:SF Mono,Monaco,Menlo,Courier New,monospace;text-align:right;background:#9696961a;padding:1px 4px;border-radius:4px}.constrained-type{text-decoration-color:var(--header-bg);text-decoration-thickness:2px}.field-default{font-size:10px;color:var(--text-secondary);opacity:.7;text-align:right;margin-top:2px;max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.badge{font-size:9px;height:12px;padding:0 6px;display:flex;align-items:center;justify-content:center;border-radius:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;box-shadow:0 1px 2px #0000000d}.badge.unique{background:#f3e8ff;color:#7e22ce;border:1px solid rgba(126,34,206,.1)}.badge.not-null{background:#f3f4f6;color:#4b5563;border:1px solid rgba(75,85,99,.1)}.badge.enum{background:#ecfdf5;color:#047857;border:1px solid rgba(4,120,87,.1)}body.dark .db-row:hover{background-color:#ffffff0d}body.dark .field-type{background:#ffffff14;color:#a1a1aa}body.dark .badge.unique{background:#3b0764;color:#d8b4fe;border-color:#581c87}body.dark .badge.not-null{background:#374151;color:#e5e7eb;border-color:#4b5563}body.dark .badge.enum{background:#064e3b;color:#6ee7b7;border-color:#065f46}@keyframes flashHighlight{0%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}50%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 12px rgba(var(--header-rgb),.4)}to{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}}.db-row.highlighted{background-color:rgba(var(--header-rgb),.1);color:var(--text-primary);animation:flashHighlight 1.5s infinite;z-index:10}.db-table.highlighted{border-color:var(--header-bg);animation:flashTable 1.5s infinite;z-index:20}@keyframes flashTable{0%{box-shadow:0 4px 6px #0000001a}50%{box-shadow:0 0 15px rgba(var(--header-rgb),.6)}to{box-shadow:0 4px 6px #0000001a}}.connection-layer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:visible}.connection-group{pointer-events:auto;cursor:pointer}.relation-hit-area{fill:none;stroke:transparent;stroke-width:20px}.relation-line-base{fill:none;stroke:var(--line-color);stroke-width:2px;stroke-linecap:round;transition:stroke .3s,stroke-width .3s}.relation-line-flow{fill:none;stroke:var(--header-bg);stroke-width:2px;stroke-linecap:round;stroke-dasharray:15 150;opacity:.4;animation:flowAnimation 5s linear infinite}@keyframes flowAnimation{to{stroke-dashoffset:165}}@keyframes continuousFlow{to{stroke-dashoffset:24}}.connection-group.highlighted .relation-line-base{stroke:var(--header-bg);stroke-width:3px;opacity:.5}.connection-group.highlighted .relation-line-flow{opacity:1;stroke-width:3px;stroke-dasharray:12 12;animation:continuousFlow .8s linear infinite;filter:drop-shadow(0 0 4px var(--header-bg))}.anchor-port{fill:var(--bg-color);stroke:var(--line-color);stroke-width:2px;transition:all .3s}.anchor-port.highlighted{stroke:var(--header-bg);fill:var(--header-bg);r:5px;filter:drop-shadow(0 0 3px var(--header-bg))}.label-bg{fill:var(--bg-color);stroke:var(--table-border);transition:all .3s}.connection-group.highlighted .label-bg{stroke:var(--header-bg);fill:#fff}.relation-label-text{font-size:10px;font-weight:700;fill:var(--text-secondary);text-anchor:middle;dominant-baseline:middle;pointer-events:none}.connection-group.highlighted .relation-label-text{fill:var(--header-bg)}.sticky-note{position:absolute;min-height:100px;padding:12px;border-radius:2px;box-shadow:0 4px 8px #00000026;font-family:Comic Sans MS,Marker Felt,sans-serif;font-size:13px;line-height:1.5;z-index:5;display:flex;flex-direction:column;cursor:grab;transition:box-shadow .2s,transform .1s;background-image:linear-gradient(#fff6,#fff0)}.sticky-note:active,.sticky-note.dragging{cursor:grabbing;box-shadow:0 10px 20px #0003;transform:scale(1.02);z-index:50}.note-content{white-space:pre-wrap;width:100%;height:100%;overflow:hidden;pointer-events:none}.sticky-note .resize-handle{position:absolute;bottom:0;right:0;top:auto;width:15px;height:15px;cursor:nwse-resize;background:linear-gradient(135deg,transparent 50%,rgba(0,0,0,.1) 50%);border-bottom-right-radius:2px;z-index:10}.schema-hud{position:absolute;bottom:20px;left:20px;right:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 12px #00000026;display:flex;flex-direction:row;align-items:center;padding:6px 12px;gap:12px;z-index:1000;-webkit-user-select:none;user-select:none}.hud-group{display:flex;gap:6px;align-items:center}.hud-group+.hud-group{border-top:none;margin-top:0;border-left:1px solid var(--table-border);padding-left:12px;margin-left:0}.hud-btn{background:transparent;border:1px solid transparent;border-radius:4px;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;cursor:pointer;transition:all .12s;color:var(--text-primary)}.hud-btn:hover,.hud-btn.active{background:rgba(var(--header-rgb),.1);color:var(--header-bg)}.hud-btn:hover{color:var(--header-bg)}.custom-select{position:relative;font-size:12px;min-width:120px}.select-trigger{background:var(--bg-color);color:var(--text-primary);border:1px solid var(--table-border);border-radius:4px;padding:0 8px;cursor:pointer;white-space:nowrap;position:relative;height:28px;display:flex;align-items:center;gap:6px;min-width:100px;justify-content:space-between}.select-arrow{width:12px;height:12px;opacity:.6;display:flex;align-items:center;justify-content:center}.select-options{display:none;position:absolute;bottom:100%;left:0;margin-bottom:8px;background:var(--table-bg);border:1px solid var(--table-border);border-radius:6px;box-shadow:0 -4px 12px #00000026;width:100%;min-width:140px;overflow:hidden;z-index:1001;flex-direction:column}.custom-select.open .select-options{display:flex}.select-option{padding:8px 12px;cursor:pointer;color:var(--text-primary);transition:background .1s}.select-option:hover{background:rgba(var(--header-rgb),.1);color:var(--header-bg)}.select-option.selected{font-weight:700;background:rgba(var(--header-rgb),.05);color:var(--header-bg)}:root{--bg-color: #f4f4f4;--table-bg: #ffffff;--table-border: #d1d5db;--header-bg: #3b82f6;--header-rgb: 59, 130, 246;--header-text: #ffffff;--text-primary: #1f2937;--text-secondary: #6b7280;--line-color: #9ca3af;--grid-line: rgba(0, 0, 0, .04);--axis-line: rgba(0, 0, 0, .08)}body.dark{--bg-color: #1e1e1e;--table-bg: #2b2d30;--table-border: #4e5256;--header-bg: #3574f0;--header-rgb: 53, 116, 240;--header-text: #ffffff;--text-primary: #d1d5db;--text-secondary: #9ca3af;--line-color: #6b7280;--grid-line: rgba(255, 255, 255, .04);--axis-line: rgba(255, 255, 255, .08)}body{margin:0;background:var(--bg-color);color:var(--text-primary);font-family:sans-serif;overflow:hidden}#app{width:100vw;height:100vh;overflow:hidden;position:relative;--zoom: 1;--pan-x: 0px;--pan-y: 0px;--grid-size: 20px}#app.grid-visible{background-image:linear-gradient(to right,var(--axis-line) 2px,transparent 2px),linear-gradient(to bottom,var(--axis-line) 2px,transparent 2px),linear-gradient(to right,var(--grid-line) 1px,transparent 1px),linear-gradient(to bottom,var(--grid-line) 1px,transparent 1px);background-repeat:no-repeat,no-repeat,repeat,repeat;background-position:var(--pan-x) 0,0 var(--pan-y),var(--pan-x) var(--pan-y),var(--pan-x) var(--pan-y);background-size:2px 100%,100% 2px,calc(var(--grid-size) * var(--zoom)) calc(var(--grid-size) * var(--zoom)),calc(var(--grid-size) * var(--zoom)) calc(var(--grid-size) * var(--zoom))}.schema-wrapper{width:100%;height:100%;transform-origin:0 0;position:relative}</style>
</head>

<body>
<div id="app"></div>
</body>

</html>
