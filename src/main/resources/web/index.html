<!-- web/index.html -->
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="./vite.svg"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>web</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();class mn{onMessage;constructor(e){this.onMessage=e,window.addEventListener("message",t=>{const r=t.data;r&&typeof r.type=="string"&&this.onMessage(r)}),this.send({type:"READY"})}send(e){const t=JSON.stringify(e);window.cefQuery?window.cefQuery({request:t}):console.log("Bridge Dev Log:",e)}log(e){this.send({type:"LOG",level:"INFO",message:e})}}function ne(u){return u.replace(/[^a-zA-Z0-9_]/g,"_")}function pn(u){return u.replace(/\/\*[\s\S]*?\*\//g,"").split(`
`).map(t=>{if(t.trim().startsWith("///"))return t;const n=t.indexOf("//");return n!==-1?t[n+2]==="/"?t:t.substring(0,n):t}).join(`
`)}function re(u){const e=new Map;if(!u)return e;const t=[];let r="",n=!1;for(let o=0;o<u.length;o++){const s=u[o];(s==="'"||s==='"')&&(n=!n),s===","&&!n?(t.push(r.trim()),r=""):r+=s}r.trim()&&t.push(r.trim());for(let o of t){if(!o)continue;const s=o.indexOf(":");if(s!==-1){const c=o.substring(0,s).trim(),a=o.substring(s+1).trim();e.set(c.toLowerCase(),a)}else e.set(o.toLowerCase(),"true")}return e}function gn(u,e){const r=u.substring(0,e).split(`
`),n=[];for(let o=r.length-1;o>=0;o--){const s=r[o].trim();if(s)if(s.startsWith("///"))n.unshift(s.replace(/^\/\/\/\s?/,""));else break}return n.length>0?n.join(`
`):void 0}function xt(u){const e=u.trim(),t=/^(.*)\.\((.*)\)$/.exec(e);if(t){const s=t[1],c=t[2];return{table:ne(s),columns:c.split(",").map(a=>a.trim())}}const r=e.split(".");if(r.length<2)return null;const n=r.pop(),o=r.join(".");return{table:ne(o),columns:[n]}}function vn(u){const e={},r=/Project\s*(?:(?:"[^"]*")|(?:[\w]+))?\s*\{([\s\S]*?)\}/i.exec(u);if(r){const n=r[1],o={database_type:"databaseType",note:"note"},s=/(\w+)\s*:\s*(?:'''([\s\S]*?)'''|'([^']*)'|([^ \n}]+))/g;let c;for(;(c=s.exec(n))!==null;){const a=c[1],l=c[2],f=c[3],d=c[4];if(o[a]||a==="note"||a==="database_type"){const g=o[a]||a;let x=l||f||d;e[g]=x}}}return e}function wt(u){const e=[],t=u.split(`
`).map(r=>r.trim()).filter(Boolean);for(let r of t){const n=/^(\(?\s*[\w\.,\s]+\s*\)?)(?:\s*\[(.*?)\])?$/i.exec(r);if(!n)continue;const o=n[1].replace(/^\(/,"").replace(/\)$/,"").split(",").map(c=>c.trim()).filter(Boolean),s=re(n[2]||"");e.push({columns:o,settings:Object.fromEntries(s),raw:r})}return e}function bt(u,e,t,r){const n=re(t);let o=n.has("pk")||n.has("primary key"),s=n.has("unique"),c=n.has("not null"),a=r;if(n.has("note")){let g=n.get("note");g.startsWith("'")&&g.endsWith("'")||g.startsWith('"')&&g.endsWith('"')?a=g.substring(1,g.length-1):a=g}let l=n.get("default");l&&(l.startsWith("'")&&l.endsWith("'")||l.startsWith("`")&&l.endsWith("`"))&&(l=l.substring(1,l.length-1));let f=!1,d;if(n.has("ref")){const g=n.get("ref"),x=/([<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/i.exec(g);x&&(f=!0,d={symbol:x[1],toTable:x[2],toColumn:x[3]})}return{name:u,type:e,isPk:o,isUnique:s,isNotNull:c,isFk:f,note:a,default:l,enumValues:void 0,inlineRef:d}}function Dt(u,e,t,r,n,o){let s="1:n";return t==="<"?s="1:n":t===">"?s="n:1":t==="-"?s="1:1":t==="<>"&&(s="m:n"),{fromTable:u,fromColumns:e,toTable:r,toColumns:n,type:s,settings:o?Object.fromEntries(o):void 0}}function yn(u){const e=[],t=/Ref\s*(?:[a-zA-Z0-9_]+)?\s*\{([\s\S]*?)\}/gi;let r;for(;(r=t.exec(u))!==null;){const o=r[1];St(o,e)}const n=/Ref\s*(?:[a-zA-Z0-9_]+)?\s*:\s*(.*)/gi;for(;(r=n.exec(u))!==null;){const o=r[1];St(o,e)}return e}function St(u,e){const t=u.split(`
`);for(let r of t){if(r=r.trim(),!r||r.startsWith("//"))continue;const o=/^(.*?)\s*(<>|[<>=-])\s*(.*)$/.exec(r);if(!o)continue;const s=o[1].trim(),c=o[2],a=o[3].trim();let l=a,f="";const d=a.indexOf("[");if(d!==-1){l=a.substring(0,d).trim();const y=a.lastIndexOf("]");y!==-1&&(f=a.substring(d+1,y))}const g=xt(s),x=xt(l),b=re(f);g&&x&&e.push(Dt(g.table,g.columns,c,x.table,x.columns,b))}}function xn(u){const e=[],t=[],r=new Map,n=/TablePartial\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/gi;let o;for(;(o=n.exec(u))!==null;){const a=o[1].replace(/"/g,""),l=o[2]||"",f=o[3]||"",d=/indexes\s*\{([\s\S]*?)\}/i.exec(f);let g=[],x=f;d&&(g=wt(d[1]),x=f.replace(d[0],""));const b=[],y=x.split(`
`);let v=[];for(let M of y){const C=M.trim();if(C.startsWith("///")){v.push(C.replace(/^\/\/\/\s?/,""));continue}if(!C||C.startsWith("Note"))continue;const L=/^("?[\w]+"?)\s+([a-zA-Z0-9_()\[\]]+)(?:\s*\[(.*?)\])?/.exec(C);if(L){const A=v.length>0?v.join(`
`):void 0;b.push(bt(L[1].replace(/"/g,""),L[2],L[3]||"",A)),v=[]}}r.set(a,{name:a,settings:re(l),fields:b,indexes:g})}const s=/Table\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*(?:as\s+\w+\s*)?\{([\s\S]*?)\}/gi;let c;for(;(c=s.exec(u))!==null;){const a=c.index,l=gn(u,a),f=c[1].replace(/"/g,""),d=c[2]||"",g=c[3]||"",x=re(d),b=/indexes\s*\{([\s\S]*?)\}/i.exec(g);let y=[],v=g;b&&(y=wt(b[1]),v=g.replace(b[0],""));const C=/^\s*Note(?:\s*:\s*|\s+)(['"])([\s\S]*?)\1/im.exec(v);let R;C&&(R=C[2],v=v.replace(C[0],""));const L=new Map,A=[],V=new Set,T=new Map,w=new Map,N=v.split(`
`);let E=[];for(let m of N){const q=m.trim();if(q.startsWith("///")){E.push(q.replace(/^\/\/\/\s?/,""));continue}if(!q)continue;if(q.startsWith("~")){const I=q.substring(1).trim(),F=r.get(I);if(F){for(const[O,Z]of F.settings)T.set(O,Z);for(const O of F.indexes){const Z=O.columns.join(",").toLowerCase();w.set(Z,O)}for(const O of F.fields)V.has(O.name)||(L.has(O.name)?L.set(O.name,O):(L.set(O.name,O),A.push(O.name)))}E=[];continue}const B=/^("?[\w]+"?)\s+([a-zA-Z0-9_()\[\]]+)(?:\s*\[(.*?)\])?/.exec(q);if(B){const I=B[1].replace(/"/g,""),F=B[2],O=B[3]||"",Z=E.length>0?E.join(`
`):void 0,X=bt(I,F,O,Z);V.add(I),L.has(I)?L.set(I,X):(L.set(I,X),A.push(I)),E=[]}}for(const[m,q]of x)T.set(m,q);for(const m of y){const q=m.columns.join(",").toLowerCase();w.set(q,m)}const $=A.map(m=>L.get(m));let z=l;if(T.has("note")){let m=T.get("note");(m.startsWith("'")&&m.endsWith("'")||m.startsWith('"')&&m.endsWith('"'))&&(m=m.substring(1,m.length-1)),z=m}else R&&(z=R);$.forEach(m=>{m.inlineRef&&t.push(Dt(ne(f),[m.name],m.inlineRef.symbol,ne(m.inlineRef.toTable),[m.inlineRef.toColumn]))}),e.push({id:ne(f),name:f,fields:$,note:z,color:T.get("color")||void 0,width:T.has("width")?parseInt(T.get("width"),10):void 0,x:T.has("x")?parseInt(T.get("x"),10):void 0,y:T.has("y")?parseInt(T.get("y"),10):void 0,settings:Object.fromEntries(T),indexes:Array.from(w.values())})}return{tables:e,inlineRelationships:t}}function wn(u){const e=[],t=/Note\s+(\w+)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/g;let r;for(;(r=t.exec(u))!==null;){const n=r[1],o=r[2]||"";let s=r[3].trim();s.startsWith("'''")&&s.endsWith("'''")?s=s.substring(3,s.length-3):s.startsWith("'")&&s.endsWith("'")&&(s=s.substring(1,s.length-1));const c=re(o);e.push({id:ne(n),name:n,content:s.trim(),x:c.has("x")?parseInt(c.get("x"),10):0,y:c.has("y")?parseInt(c.get("y"),10):0,width:c.has("width")?parseInt(c.get("width"),10):250,color:c.get("color")||"#fff9c4"})}return e}class bn{parse(e){const t=pn(e),r=vn(t),{tables:n,inlineRelationships:o}=xn(t),s=yn(t),c=[...o,...s],a=wn(t);return{tables:n,relationships:c,projectSettings:r,notes:a}}}const Sn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" width="800px" height="800px" viewBox="0 0 24 24"><path d="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>`,Mn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M4 9L20 9M8 9V20M6.2 20H17.8C18.9201 20 19.4802 20 19.908 19.782C20.2843 19.5903 20.5903 19.2843 20.782 18.908C21 18.4802 21 17.9201 21 16.8V7.2C21 6.0799 21 5.51984 20.782 5.09202C20.5903 4.71569 20.2843 4.40973 19.908 4.21799C19.4802 4 18.9201 4 17.8 4H6.2C5.0799 4 4.51984 4 4.09202 4.21799C3.71569 4.40973 3.40973 4.71569 3.21799 5.09202C3 5.51984 3 6.07989 3 7.2V16.8C3 17.9201 3 18.4802 3.21799 18.908C3.40973 19.2843 3.71569 19.5903 4.09202 19.782C4.51984 20 5.07989 20 6.2 20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Cn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M6 12H18M12 6V18" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Tn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M6 12L18 12" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,En=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M15 4V7C15 8.10457 15.8954 9 17 9H20M9 4V7C9 8.10457 8.10457 9 7 9H4M15 20V17C15 15.8954 15.8954 15 17 15H20M9 20V17C9 15.8954 8.10457 15 7 15H4" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,me={Key:Sn,Table:Mn,ZoomIn:Cn,ZoomOut:Tn,Center:En};class Ln{static create(e,t){const r=document.createElement("div");r.className="db-row",r.id=`col-${t}-${e.name}`,e.isUnique&&r.classList.add("indexed-row");const n=document.createElement("div");n.className="row-left";const o=document.createElement("span");o.className="key-icon",e.isPk||e.isFk?(o.innerHTML=me.Key,e.isPk&&e.isFk?(o.classList.add("pk-fk"),o.title="Primary & Foreign Key"):e.isPk?(o.classList.add("pk"),o.title="Primary Key"):(o.classList.add("fk"),o.title="Foreign Key")):o.classList.add("empty"),n.appendChild(o);const s=document.createElement("div");s.className="name-container";const c=document.createElement("span");if(c.className="field-name",c.innerText=e.name,s.appendChild(c),e.note){const d=document.createElement("div");d.className="field-note",d.innerText=e.note,s.appendChild(d)}n.appendChild(s);const a=document.createElement("div");a.className="row-right";const l=document.createElement("div");l.className="type-container";const f=document.createElement("span");if(f.className="field-type",e.isUnique&&f.classList.add("constrained-type"),f.innerText=e.type,l.appendChild(f),e.enumValues&&e.enumValues.length>0){const d=this.createBadge("ENUM","enum");d.title=`Enum values: ${e.enumValues.join(", ")}`,a.appendChild(d)}if(e.isUnique&&a.appendChild(this.createBadge("UQ","unique")),e.isNotNull&&a.appendChild(this.createBadge("NN","not-null")),e.default){const d=document.createElement("div");d.className="field-default",d.innerText=`default: ${e.default}`,l.appendChild(d)}return a.appendChild(l),r.appendChild(n),r.appendChild(a),r}static createBadge(e,t){const r=document.createElement("span");return r.className=`badge ${t}`,r.innerText=e,r}}class Nn{static create(e){const t=document.createElement("div");t.className="db-table",t.id=`table-${e.id}`,t.dataset.tableName=e.name;const r=e.color||"var(--header-bg)";t.style.setProperty("--table-main-color",r),e.width&&(t.style.width=`${e.width}px`);const[n,o]=e.name.includes(".")?e.name.split("."):["",e.name],s=document.createElement("div");s.className="semantic-overlay";const c=document.createElement("div");c.className="overlay-text",c.innerText=o,s.appendChild(c),t.appendChild(s);const a=document.createElement("div");a.className="db-table-header";const l=document.createElement("div");l.className="header-title-wrapper";const f=document.createElement("span");f.className="table-icon",f.innerHTML=me.Table,l.appendChild(f);const d=document.createElement("span");d.className="title",d.innerText=o,l.appendChild(d),a.appendChild(l);const g=document.createElement("span");if(g.className="schema-banner",g.innerText=n||"public",a.appendChild(g),e.note){const b=document.createElement("div");b.className="table-note",b.innerText=e.note,a.appendChild(b)}t.appendChild(a),e.fields.forEach(b=>{t.appendChild(Ln.create(b,e.id))});const x=document.createElement("div");return x.className="resize-handle",x.title="Drag to resize",t.appendChild(x),t}}class In{static MIN_STRAIGHT=20;static MAX_STRAIGHT=80;static LANE_WIDTH=10;static LABEL_OFFSET=25;static MIN_U_TURN_OFFSET=30;static U_TURN_FACTOR=.2;static calculatePath(e,t,r,n,o,s,c,a){const l=(H,B,I)=>I<=1?H.y+H.height/2:H.y+H.height*(B+1)/(I+1),f=l(e,a.fromColIndex,a.fromColTotal),d=l(t,a.toColIndex,a.toColTotal),g={x:e.x+e.width,y:f},x={x:e.x,y:f},b={x:t.x+t.width,y:d},y={x:t.x,y:d},v=e.x<t.x+t.width&&e.x+e.width>t.x;let M,C,R,L;v?(M=g,C=b,R=1,L=1):e.x<t.x?(M=g,C=y,R=1,L=-1):(M=x,C=b,R=-1,L=1);const A=c==="Rectilinear"||c==="RoundRectilinear",V=Math.abs(C.x-M.x);let T=Math.max(this.MIN_STRAIGHT,Math.min(this.MAX_STRAIGHT,V/2));const w=T+(A?a.fromLaneIndex*this.LANE_WIDTH:0),N=T+(A?a.toLaneIndex*this.LANE_WIDTH:0),E={x:M.x+w*R,y:M.y},$={x:C.x+N*L,y:C.y};if(v){const H=Math.max(this.MIN_U_TURN_OFFSET,Math.abs(C.y-M.y)*this.U_TURN_FACTOR),B=A?Math.max(a.fromLaneIndex,a.toLaneIndex)*this.LANE_WIDTH:0;E.x=Math.max(M.x,C.x)+H+B,$.x=E.x}let z="";switch(c){case"Rectilinear":case"RoundRectilinear":{const H=(E.x+$.x)/2,B={x:H,y:M.y},I={x:H,y:C.y};if(c==="Rectilinear")z=`M ${M.x} ${M.y} L ${B.x} ${B.y} L ${I.x} ${I.y} L ${C.x} ${C.y}`;else{const F=Math.min(12,Math.abs(I.y-B.y)/2,Math.abs(B.x-M.x)/2),O=C.y>M.y?1:-1,Z=B.x>M.x?1:-1,X=C.x>I.x?1:-1;z=`M ${M.x} ${M.y} 
               L ${B.x-F*Z} ${B.y} 
               Q ${B.x} ${B.y} ${B.x} ${B.y+F*O} 
               L ${I.x} ${I.y-F*O} 
               Q ${I.x} ${I.y} ${I.x+F*X} ${I.y} 
               L ${C.x} ${C.y}`}break}case"Oblique":z=`M ${M.x} ${M.y} L ${E.x} ${E.y} L ${$.x} ${$.y} L ${C.x} ${C.y}`;break;case"RoundOblique":z=`M ${M.x} ${M.y} 
             L ${E.x} ${E.y} 
             Q ${(E.x+$.x)/2} ${(E.y+$.y)/2} ${$.x} ${$.y} 
             L ${C.x} ${C.y}`;break;default:z=`M ${M.x} ${M.y} C ${E.x} ${E.y}, ${$.x} ${$.y}, ${C.x} ${C.y}`;break}const m=this.getLabelPos(M,E,a.fromStagger),q=this.getLabelPos(C,$,a.toStagger);return{d:z,start:M,end:C,labelStart:{text:a.fromLabel,pos:m},labelEnd:{text:a.toLabel,pos:q},fromId:r,toId:n,fromTableId:o,toTableId:s}}static getLabelPos(e,t,r){const n=t.x-e.x,o=t.y-e.y,s=Math.sqrt(n*n+o*o),a=(this.LABEL_OFFSET+r*18)/(s||1);return{x:e.x+n*a,y:e.y+o*a}}}class Rn{static createGroup(e){const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.classList.add("connection-group"),t.dataset.from=e.fromId,t.dataset.to=e.toId,t.dataset.fromTable=e.fromTableId,t.dataset.toTable=e.toTableId;const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",e.d),r.classList.add("relation-hit-area"),t.appendChild(r);const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",e.d),n.classList.add("relation-line-base"),t.appendChild(n);const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",e.d),o.classList.add("relation-line-flow"),t.appendChild(o),this.createLabels(e).forEach(c=>t.appendChild(c)),t}static createLabels(e){const t=[];return e.labelStart.text&&t.push(this.createLabelBadge(e.labelStart.text,e.labelStart.pos.x,e.labelStart.pos.y)),e.labelEnd.text&&t.push(this.createLabelBadge(e.labelEnd.text,e.labelEnd.pos.x,e.labelEnd.pos.y)),t}static createLabelBadge(e,t,r){const n=document.createElementNS("http://www.w3.org/2000/svg","g");n.classList.add("relation-label-group");const o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttribute("x",(t-9).toString()),o.setAttribute("y",(r-7).toString()),o.setAttribute("width","18"),o.setAttribute("height","14"),o.setAttribute("rx","4"),o.classList.add("label-bg");const s=document.createElementNS("http://www.w3.org/2000/svg","text");return s.setAttribute("x",t.toString()),s.setAttribute("y",(r+1).toString()),s.classList.add("relation-label-text"),s.textContent=e,n.appendChild(o),n.appendChild(s),n}}class Mt{static create(e){const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx",e.x.toString()),t.setAttribute("cy",e.y.toString()),t.setAttribute("r","3.5"),t.classList.add("anchor-port"),t}}class Ct{svgLayer;scale=1;container;currentRelationships=[];currentLineStyle="Curve";constructor(e){this.container=e,this.svgLayer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgLayer.classList.add("connection-layer"),e.appendChild(this.svgLayer),this.setupInteractions()}updateScale(e){this.scale=e}setLineStyle(e){this.currentLineStyle=e,this.draw(this.currentRelationships)}draw(e){this.currentRelationships=e,this.svgLayer.innerHTML="";const t=new Map,r=new Map;e.forEach(c=>{const a=Math.max(1,Math.min(c.fromColumns.length,c.toColumns.length)),l=[];for(let f=0;f<a;f++)l.push({fromColIndex:0,fromColTotal:1,toColIndex:0,toColTotal:1,fromLaneIndex:0,toLaneIndex:0,fromLabel:null,fromStagger:0,toLabel:null,toStagger:0});r.set(c,l)});const n=c=>{if(!t.has(c)){const a=document.getElementById(c);a&&t.set(c,this.getRelativeRect(a))}return t.get(c)},o=new Map,s=new Map;e.forEach(c=>{const a=Math.min(c.fromColumns.length,c.toColumns.length);for(let l=0;l<a;l++){const f=c.fromColumns[l],d=c.toColumns[l],g=`col-${c.fromTable}-${f}`,x=`col-${c.toTable}-${d}`,b=n(g),y=n(x);if(!b||!y)continue;const v=l===0,M=v?this.getLabelString(c.type,!0):"",C=v?this.getLabelString(c.type,!1):"";o.has(g)||o.set(g,[]),o.get(g).push({rel:c,colPairIndex:l,isFrom:!0,rect:b,otherY:y.y+y.height/2,label:M}),o.has(x)||o.set(x,[]),o.get(x).push({rel:c,colPairIndex:l,isFrom:!1,rect:y,otherY:b.y+b.height/2,label:C});const R=b.x<y.x?"right":"left",L=y.x<b.x?"right":"left",A=`${c.fromTable}-${R}`,V=`${c.toTable}-${L}`,T={rel:c,colPairIndex:l,isFrom:!0,rect:b,otherY:y.y+y.height/2,label:""},w={rel:c,colPairIndex:l,isFrom:!1,rect:y,otherY:b.y+b.height/2,label:""};s.has(A)||s.set(A,[]),s.get(A).push(T),s.has(V)||s.set(V,[]),s.get(V).push(w)}});for(const c of o.values()){c.sort((d,g)=>d.otherY-g.otherY);const a=c.length,l=new Set;let f=0;c.forEach((d,g)=>{const x=r.get(d.rel)?.[d.colPairIndex];if(!x)return;let b=null,y=0;d.label&&(l.has(d.label)?(b=d.label,y=0):(l.add(d.label),b=d.label,y=f++)),d.isFrom?(x.fromColIndex=g,x.fromColTotal=a,x.fromLabel=b,x.fromStagger=y):(x.toColIndex=g,x.toColTotal=a,x.toLabel=b,x.toStagger=y)})}for(const[c,a]of s.entries()){if(a.length<=1)continue;const l=a.reduce((g,x)=>g+x.rect.y,0)/a.length,d=a.reduce((g,x)=>g+x.otherY,0)/a.length>l;a.sort((g,x)=>Math.abs(g.rect.y-x.rect.y)>1?g.rect.y-x.rect.y:g.otherY-x.otherY),a.forEach((g,x)=>{const b=r.get(g.rel)?.[g.colPairIndex];if(!b)return;const y=d?a.length-1-x:x;g.isFrom?b.fromLaneIndex=y:b.toLaneIndex=y})}e.forEach(c=>{const a=Math.min(c.fromColumns.length,c.toColumns.length);for(let l=0;l<a;l++){const f=`col-${c.fromTable}-${c.fromColumns[l]}`,d=`col-${c.toTable}-${c.toColumns[l]}`,g=t.get(f),x=t.get(d),b=r.get(c)?.[l];if(g&&x&&b){const y=In.calculatePath(g,x,f,d,`table-${c.fromTable}`,`table-${c.toTable}`,this.currentLineStyle,b),v=Rn.createGroup(y);if(c.settings&&c.settings.color){const R=c.settings.color,L=v.querySelector(".relation-line-base"),A=v.querySelector(".relation-line-flow");L&&(L.style.stroke=R),A&&(A.style.stroke=R)}this.svgLayer.appendChild(v);const M=Mt.create(y.start);M.dataset.anchorId=f,this.svgLayer.appendChild(M);const C=Mt.create(y.end);C.dataset.anchorId=d,this.svgLayer.appendChild(C)}}})}getLabelString(e,t){const r=e.split(":");return t?r[0]:r[1]}getRelativeRect(e){const t=e.getBoundingClientRect(),r=this.svgLayer.getBoundingClientRect();return{x:(t.left-r.left)/this.scale,y:(t.top-r.top)/this.scale,width:t.width/this.scale,height:t.height/this.scale}}setupInteractions(){this.container.addEventListener("mouseover",e=>this.handleHover(e,!0)),this.container.addEventListener("mouseout",e=>this.handleHover(e,!1))}handleHover(e,t){if(!t){this.clearHighlights();return}const r=e.target,n=r.closest(".connection-group");if(n){this.activateConnection(n);return}const o=r.closest(".db-row");if(o&&o.id){this.activateColumn(o.id);return}const s=r.closest(".db-table");if(s&&s.id){this.activateTable(s.id);return}}clearHighlights(){document.querySelectorAll(".highlighted").forEach(t=>t.classList.remove("highlighted"))}activateConnection(e){e.classList.add("highlighted");const t=e.dataset.from,r=e.dataset.to;t&&this.setHighlight(t),r&&this.setHighlight(r),this.highlightAnchorsForLine(t,r)}activateColumn(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from="${e}"], [data-to="${e}"]`).forEach(r=>{r.classList.add("highlighted");const n=r;n.dataset.from!==e&&this.setHighlight(n.dataset.from),n.dataset.to!==e&&this.setHighlight(n.dataset.to),this.highlightAnchorsForLine(n.dataset.from,n.dataset.to)})}activateTable(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from-table="${e}"], [data-to-table="${e}"]`).forEach(r=>{r.classList.add("highlighted");const n=r;this.setHighlight(n.dataset.from),this.setHighlight(n.dataset.to),this.highlightAnchorsForLine(n.dataset.from,n.dataset.to)})}setHighlight(e){if(!e)return;const t=document.getElementById(e);t&&t.classList.add("highlighted")}highlightAnchorsForLine(e,t){e&&this.svgLayer.querySelectorAll(`[data-anchor-id="${e}"]`).forEach(n=>n.classList.add("highlighted")),t&&this.svgLayer.querySelectorAll(`[data-anchor-id="${t}"]`).forEach(n=>n.classList.add("highlighted"))}}class An{activeEl=null;mode="NONE";initialMouse={x:0,y:0};initialVal={x:0,y:0,width:0,height:0};scale=1;relationships=[];connectionManager;onUpdate;wrapper;constructor(e,t,r){this.wrapper=e,this.connectionManager=t,this.onUpdate=r,e.addEventListener("mousedown",n=>this.onMouseDown(n)),window.addEventListener("mousemove",n=>this.onMouseMove(n)),window.addEventListener("mouseup",()=>this.onMouseUp())}updateConnectionManager(e){this.connectionManager=e}setRelationships(e){this.relationships=e}updateScale(e){this.scale=e}onMouseDown(e){const t=e.target;if(t.classList.contains("resize-handle")){const n=t.parentElement;n&&this.startResize(n,e);return}if(t.closest(".db-table-header")||t.closest(".semantic-overlay")){const n=t.closest(".db-table");n&&this.startDrag(n,e);return}const r=t.closest(".sticky-note");if(r){this.startDrag(r,e);return}}startDrag(e,t){this.mode="DRAG",this.activeEl=e,this.initialVal.x=e.offsetLeft,this.initialVal.y=e.offsetTop,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("dragging")}startResize(e,t){this.mode="RESIZE",this.activeEl=e,this.initialVal.width=e.offsetWidth,this.initialVal.height=e.offsetHeight,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("resizing"),document.body.style.cursor="nwse-resize"}onMouseMove(e){if(!this.activeEl)return;const t=(e.clientX-this.initialMouse.x)/this.scale,r=(e.clientY-this.initialMouse.y)/this.scale;if(this.mode==="DRAG")this.activeEl.style.left=`${this.initialVal.x+t}px`,this.activeEl.style.top=`${this.initialVal.y+r}px`,this.activeEl.style.transform="none",this.activeEl.classList.contains("db-table")&&this.connectionManager.draw(this.relationships);else if(this.mode==="RESIZE"){const n=Math.max(100,this.initialVal.width+t);if(this.activeEl.style.width=`${n}px`,this.activeEl.classList.contains("sticky-note")){const o=Math.max(100,this.initialVal.height+r);this.activeEl.style.height=`${o}px`}this.activeEl.classList.contains("db-table")&&this.connectionManager.draw(this.relationships)}}onMouseUp(){if(!this.activeEl)return;const e=this.activeEl,t=Math.round(parseInt(e.style.left||"0",10)),r=Math.round(parseInt(e.style.top||"0",10)),n=Math.round(e.getBoundingClientRect().width/this.scale),o=Math.round(e.getBoundingClientRect().height/this.scale);if(e.classList.contains("db-table")){const s=e.querySelector(".title"),c=e.dataset&&e.dataset.tableName||(s?s.textContent||"":e.id.replace("table-",""));c&&this.onUpdate(c,t,r,n)}else if(e.classList.contains("sticky-note")){const s=e.dataset.noteId||e.id.replace("note-",""),c=new CustomEvent("note-pos-changed",{detail:{name:s,x:t,y:r,width:n,height:o},bubbles:!0});this.wrapper.dispatchEvent(c)}e.classList.remove("dragging"),e.classList.remove("resizing"),document.body.style.cursor="",this.activeEl=null,this.mode="NONE"}}function kn(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var he={exports:{}},Tt;function $n(){if(Tt)return he.exports;Tt=1,he.exports=u,he.exports.addWheelListener=u,he.exports.removeWheelListener=e;function u(t,r,n){t.addEventListener("wheel",r,n)}function e(t,r,n){t.removeEventListener("wheel",r,n)}return he.exports}var fe={exports:{}},Be,Et;function zn(){if(Et)return Be;Et=1;var u=4,e=.001,t=1e-7,r=10,n=11,o=1/(n-1),s=typeof Float32Array=="function";function c(y,v){return 1-3*v+3*y}function a(y,v){return 3*v-6*y}function l(y){return 3*y}function f(y,v,M){return((c(v,M)*y+a(v,M))*y+l(v))*y}function d(y,v,M){return 3*c(v,M)*y*y+2*a(v,M)*y+l(v)}function g(y,v,M,C,R){var L,A,V=0;do A=v+(M-v)/2,L=f(A,C,R)-y,L>0?M=A:v=A;while(Math.abs(L)>t&&++V<r);return A}function x(y,v,M,C){for(var R=0;R<u;++R){var L=d(v,M,C);if(L===0)return v;var A=f(v,M,C)-y;v-=A/L}return v}function b(y){return y}return Be=function(v,M,C,R){if(!(0<=v&&v<=1&&0<=C&&C<=1))throw new Error("bezier x values must be in [0, 1] range");if(v===M&&C===R)return b;for(var L=s?new Float32Array(n):new Array(n),A=0;A<n;++A)L[A]=f(A*o,v,C);function V(T){for(var w=0,N=1,E=n-1;N!==E&&L[N]<=T;++N)w+=o;--N;var $=(T-L[N])/(L[N+1]-L[N]),z=w+$*o,m=d(z,v,C);return m>=e?x(T,z,v,C):m===0?z:g(T,w,w+o,v,C)}return function(w){return w===0?0:w===1?1:f(V(w),M,R)}},Be}var Lt;function On(){if(Lt)return fe.exports;Lt=1;var u=zn(),e={ease:u(.25,.1,.25,1),easeIn:u(.42,0,1,1),easeOut:u(0,0,.58,1),easeInOut:u(.42,0,.58,1),linear:u(0,0,1,1)};fe.exports=t,fe.exports.makeAggregateRaf=c,fe.exports.sharedScheduler=c();function t(a,l,f){var d=Object.create(null),g=Object.create(null);f=f||{};var x=typeof f.easing=="function"?f.easing:e[f.easing];x||(f.easing&&console.warn("Unknown easing function in amator: "+f.easing),x=e.ease);var b=typeof f.step=="function"?f.step:r,y=typeof f.done=="function"?f.done:r,v=n(f.scheduler),M=Object.keys(l);M.forEach(function(N){d[N]=a[N],g[N]=l[N]-a[N]});var C=typeof f.duration=="number"?f.duration:400,R=Math.max(1,C*.06),L,A=0;return L=v.next(T),{cancel:V};function V(){v.cancel(L),L=0}function T(){var N=x(A/R);A+=1,w(N),A<=R?(L=v.next(T),b(a)):(L=0,setTimeout(function(){y(a)},0))}function w(N){M.forEach(function(E){a[E]=g[E]*N+d[E]})}}function r(){}function n(a){if(!a){var l=typeof window<"u"&&window.requestAnimationFrame;return l?o():s()}if(typeof a.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof a.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return a}function o(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function s(){return{next:function(a){return setTimeout(a,1e3/60)},cancel:function(a){return clearTimeout(a)}}}function c(){var a=new Set,l=new Set,f=0;return{next:g,cancel:g,clearAll:d};function d(){a.clear(),l.clear(),cancelAnimationFrame(f),f=0}function g(y){l.add(y),x()}function x(){f||(f=requestAnimationFrame(b))}function b(){f=0;var y=l;l=a,a=y,a.forEach(function(v){v()}),a.clear()}}return fe.exports}var De,Nt;function Bn(){if(Nt)return De;Nt=1;function u(r){t(r);const n=e(r);return r.on=n.on,r.off=n.off,r.fire=n.fire,r}function e(r){let n=Object.create(null);return{on:function(o,s,c){if(typeof s!="function")throw new Error("callback is expected to be a function");let a=n[o];return a||(a=n[o]=[]),a.push({callback:s,ctx:c}),r},off:function(o,s){if(typeof o>"u")return n=Object.create(null),r;if(n[o])if(typeof s!="function")delete n[o];else{const c=n[o];for(let a=0;a<c.length;++a)c[a].callback===s&&c.splice(a,1)}return r},fire:function(o){const s=n[o];if(!s)return r;let c;arguments.length>1&&(c=Array.prototype.slice.call(arguments,1));for(let a=0;a<s.length;++a){const l=s[a];l.callback.apply(l.ctx,c)}return r}}}function t(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");const n=["on","fire","off"];for(let o=0;o<n.length;++o)if(r.hasOwnProperty(n[o]))throw new Error("Subject cannot be eventified, since it already has property '"+n[o]+"'")}return De=u,De}var Pe,It;function Dn(){if(It)return Pe;It=1,Pe=u;function u(r,n,o){typeof o!="object"&&(o={});var s=typeof o.minVelocity=="number"?o.minVelocity:5,c=typeof o.amplitude=="number"?o.amplitude:.25,a=typeof o.cancelAnimationFrame=="function"?o.cancelAnimationFrame:e(),l=typeof o.requestAnimationFrame=="function"?o.requestAnimationFrame:t(),f,d,g=342,x,b,y,v,M,C,R,L;return{start:V,stop:w,cancel:A};function A(){a(x),a(L)}function V(){f=r(),v=R=b=M=0,d=new Date,a(x),a(L),x=l(T)}function T(){var E=Date.now(),$=E-d;d=E;var z=r(),m=z.x-f.x,q=z.y-f.y;f=z;var H=1e3/(1+$);b=.8*m*H+.2*b,M=.8*q*H+.2*M,x=l(T)}function w(){a(x),a(L);var E=r();y=E.x,C=E.y,d=Date.now(),(b<-s||b>s)&&(v=c*b,y+=v),(M<-s||M>s)&&(R=c*M,C+=R),L=l(N)}function N(){var E=Date.now()-d,$=!1,z=0,m=0;v&&(z=-v*Math.exp(-E/g),z>.5||z<-.5?$=!0:z=v=0),R&&(m=-R*Math.exp(-E/g),m>.5||m<-.5?$=!0:m=R=0),$&&(n(y+z,C+m),L=l(N))}}function e(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function t(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(r){return setTimeout(r,16)}}return Pe}var Fe,Rt;function Pn(){if(Rt)return Fe;Rt=1,Fe=u;function u(r){if(r)return{capture:t,release:t};var n,o,s,c=!1;return{capture:a,release:l};function a(f){c=!0,o=window.document.onselectstart,s=window.document.ondragstart,window.document.onselectstart=e,n=f,n.ondragstart=e}function l(){c&&(c=!1,window.document.onselectstart=o,n&&(n.ondragstart=s))}}function e(r){return r.stopPropagation(),!1}function t(){}return Fe}var Ze,At;function Fn(){if(At)return Ze;At=1,Ze=u;function u(){this.x=0,this.y=0,this.scale=1}return Ze}var Me={exports:{}},kt;function Zn(){if(kt)return Me.exports;kt=1,Me.exports=u,Me.exports.canAttach=e;function u(t,r){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var n=t.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");r.disableKeyboardInteraction||n.setAttribute("tabindex",0);var o={getBBox:c,getScreenCTM:a,getOwner:s,applyTransform:f,initTransform:l};return o;function s(){return n}function c(){var d=t.getBBox();return{left:d.x,top:d.y,width:d.width,height:d.height}}function a(){var d=n.getCTM();return d||n.getScreenCTM()}function l(d){var g=t.getCTM();g===null&&(g=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),d.x=g.e,d.y=g.f,d.scale=g.a,n.removeAttributeNS(null,"viewBox")}function f(d){t.setAttribute("transform","matrix("+d.scale+" 0 0 "+d.scale+" "+d.x+" "+d.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return Me.exports}var Ce={exports:{}},$t;function qn(){if($t)return Ce.exports;$t=1,Ce.exports=u,Ce.exports.canAttach=e;function u(t,r){var n=e(t);if(!n)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var o=t.parentElement;t.scrollTop=0,r.disableKeyboardInteraction||o.setAttribute("tabindex",0);var s={getBBox:a,getOwner:c,applyTransform:l};return s;function c(){return o}function a(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function l(f){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+f.scale+", 0, 0, "+f.scale+", "+f.x+", "+f.y+")"}}function e(t){return t&&t.parentElement&&t.style}return Ce.exports}var qe,zt;function Vn(){if(zt)return qe;zt=1;var u=$n(),e=On(),t=Bn(),r=Dn(),n=Pn(),o=n(),s=n(!0),c=Fn(),a=Zn(),l=qn(),f=1,d=1.75,g=300,x=200;qe=b;function b(T,w){w=w||{};var N=w.controller;if(N||(a.canAttach(T)?N=a(T,w):l.canAttach(T)&&(N=l(T,w))),!N)throw new Error("Cannot create panzoom for the current type of dom element");var E=N.getOwner(),$={x:0,y:0},z=!1,m=new c;N.initTransform&&N.initTransform(m);var q=typeof w.filterKey=="function"?w.filterKey:M,H=typeof w.pinchSpeed=="number"?w.pinchSpeed:1,B=w.bounds,I=typeof w.maxZoom=="number"?w.maxZoom:Number.POSITIVE_INFINITY,F=typeof w.minZoom=="number"?w.minZoom:0,O=typeof w.boundsPadding=="number"?w.boundsPadding:.05,Z=typeof w.zoomDoubleClickSpeed=="number"?w.zoomDoubleClickSpeed:d,X=w.beforeWheel||M,oe=w.beforeMouseDown||M,Te=typeof w.zoomSpeed=="number"?w.zoomSpeed:f,U=y(w.transformOrigin),Ee=w.enableTextSelection?s:o;C(B),w.autocenter&&Vt();var ie,We=0,_e=0,ae=0,je=null,Ye=new Date,Le,se=!1,ce=!1,_,j,Ne,Ie,Re,Y;"smoothScroll"in w&&!w.smoothScroll?Y=A():Y=r(Qt,rn,w.smoothScroll);var Ae,le,pe,ge=!1;et();var ve={dispose:on,moveBy:J,moveTo:ke,smoothMoveTo:nn,centerOn:tn,zoomTo:be,zoomAbs:ye,smoothZoom:we,smoothZoomAbs:hn,showRectangle:qt,pause:Pt,resume:Ft,isPaused:Zt,getTransform:Ht,getMinZoom:Wt,setMinZoom:_t,getMaxZoom:jt,setMaxZoom:Yt,getTransformOrigin:Ut,setTransformOrigin:Gt,getZoomSpeed:Xt,setZoomSpeed:Kt};t(ve);var Ue=typeof w.initialX=="number"?w.initialX:m.x,Ge=typeof w.initialY=="number"?w.initialY:m.y,Xe=typeof w.initialZoom=="number"?w.initialZoom:m.scale;return(Ue!=m.x||Ge!=m.y||Xe!=m.scale)&&ye(Ue,Ge,Xe),ve;function Pt(){tt(),ge=!0}function Ft(){ge&&(et(),ge=!1)}function Zt(){return ge}function qt(i){var h=E.getBoundingClientRect(),p=K(h.width,h.height),S=i.right-i.left,k=i.bottom-i.top;if(!Number.isFinite(S)||!Number.isFinite(k))throw new Error("Invalid rectangle");var D=p.x/S,P=p.y/k,W=Math.min(D,P);m.x=-(i.left+S/2)*W+p.x/2,m.y=-(i.top+k/2)*W+p.y/2,m.scale=W}function K(i,h){if(N.getScreenCTM){var p=N.getScreenCTM(),S=p.a,k=p.d,D=p.e,P=p.f;$.x=i*S-D,$.y=h*k-P}else $.x=i,$.y=h;return $}function Vt(){var i,h,p=0,S=0,k=Qe();if(k)p=k.left,S=k.top,i=k.right-k.left,h=k.bottom-k.top;else{var D=E.getBoundingClientRect();i=D.width,h=D.height}var P=N.getBBox();if(!(P.width===0||P.height===0)){var W=h/P.height,te=i/P.width,Q=Math.min(te,W);m.x=-(P.left+P.width/2)*Q+i/2+p,m.y=-(P.top+P.height/2)*Q+h/2+S,m.scale=Q}}function Ht(){return m}function Wt(){return F}function _t(i){F=i}function jt(){return I}function Yt(i){I=i}function Ut(){return U}function Gt(i){U=y(i)}function Xt(){return Te}function Kt(i){if(!Number.isFinite(i))throw new Error("Zoom speed should be a number");Te=i}function Qt(){return{x:m.x,y:m.y}}function ke(i,h){m.x=i,m.y=h,$e(),ee("pan"),ze()}function Ke(i,h){ke(m.x+i,m.y+h)}function $e(){var i=Qe();if(i){var h=!1,p=Jt(),S=i.left-p.right;return S>0&&(m.x+=S,h=!0),S=i.right-p.left,S<0&&(m.x+=S,h=!0),S=i.top-p.bottom,S>0&&(m.y+=S,h=!0),S=i.bottom-p.top,S<0&&(m.y+=S,h=!0),h}}function Qe(){if(B){if(typeof B=="boolean"){var i=E.getBoundingClientRect(),h=i.width,p=i.height;return{left:h*O,top:p*O,right:h*(1-O),bottom:p*(1-O)}}return B}}function Jt(){var i=N.getBBox(),h=en(i.left,i.top);return{left:h.x,top:h.y,right:i.width*m.scale+h.x,bottom:i.height*m.scale+h.y}}function en(i,h){return{x:i*m.scale+m.x,y:h*m.scale+m.y}}function ze(){z=!0,ie=window.requestAnimationFrame(an)}function Je(i,h,p){if(L(i)||L(h)||L(p))throw new Error("zoom requires valid numbers");var S=m.scale*p;if(S<F){if(m.scale===F)return;p=F/m.scale}if(S>I){if(m.scale===I)return;p=I/m.scale}var k=K(i,h);if(m.x=k.x-p*(k.x-m.x),m.y=k.y-p*(k.y-m.y),B&&O===1&&F===1)m.scale*=p,$e();else{var D=$e();D||(m.scale*=p)}ee("zoom"),ze()}function ye(i,h,p){var S=p/m.scale;Je(i,h,S)}function tn(i){var h=i.ownerSVGElement;if(!h)throw new Error("ui element is required to be within the scene");var p=i.getBoundingClientRect(),S=p.left+p.width/2,k=p.top+p.height/2,D=h.getBoundingClientRect(),P=D.width/2-S,W=D.height/2-k;J(P,W,!0)}function nn(i,h){J(i-m.x,h-m.y,!0)}function J(i,h,p){if(!p)return Ke(i,h);Ae&&Ae.cancel();var S={x:0,y:0},k={x:i,y:h},D=0,P=0;Ae=e(S,k,{step:function(W){Ke(W.x-D,W.y-P),D=W.x,P=W.y}})}function rn(i,h){Se(),ke(i,h)}function on(){tt()}function et(){E.addEventListener("mousedown",lt,{passive:!1}),E.addEventListener("dblclick",ct,{passive:!1}),E.addEventListener("touchstart",rt,{passive:!1}),E.addEventListener("keydown",nt,{passive:!1}),u.addWheelListener(E,mt,{passive:!1}),ze()}function tt(){u.removeWheelListener(E,mt),E.removeEventListener("mousedown",lt),E.removeEventListener("keydown",nt),E.removeEventListener("dblclick",ct),E.removeEventListener("touchstart",rt),ie&&(window.cancelAnimationFrame(ie),ie=0),Y.cancel(),ht(),ft(),Ee.release(),Oe()}function an(){z&&sn()}function sn(){z=!1,N.applyTransform(m),ee("transform"),ie=0}function nt(i){var h=0,p=0,S=0;if(i.keyCode===38?p=1:i.keyCode===40?p=-1:i.keyCode===37?h=1:i.keyCode===39?h=-1:i.keyCode===189||i.keyCode===109?S=1:(i.keyCode===187||i.keyCode===107)&&(S=-1),!q(i,h,p,S)){if(h||p){i.preventDefault(),i.stopPropagation();var k=E.getBoundingClientRect(),D=Math.min(k.width,k.height),P=.05,W=D*P*h,te=D*P*p;J(W,te)}if(S){var Q=pt(S*100),D=U?de():cn();be(D.x,D.y,Q)}}}function cn(){var i=E.getBoundingClientRect();return{x:i.width/2,y:i.height/2}}function rt(i){if(ln(i),ue(),i.touches.length===1)return dn(i,i.touches[0]);i.touches.length===2&&(Re=st(i.touches[0],i.touches[1]),pe=!0,ot())}function ln(i){w.onTouch&&!w.onTouch(i)||(i.stopPropagation(),i.preventDefault())}function un(i){ue(),!(w.onDoubleClick&&!w.onDoubleClick(i))&&(i.preventDefault(),i.stopPropagation())}function dn(i){_e=new Date;var h=i.touches[0],p=G(h);Le=p;var S=K(p.x,p.y);_=S.x,j=S.y,Ne=_,Ie=j,Y.cancel(),ot()}function ot(){se||(se=!0,document.addEventListener("touchmove",it),document.addEventListener("touchend",xe),document.addEventListener("touchcancel",xe))}function it(i){if(i.touches.length===1){i.stopPropagation();var h=i.touches[0],p=G(h),S=K(p.x,p.y),k=S.x-_,D=S.y-j;k!==0&&D!==0&&gt(),_=S.x,j=S.y,J(k,D)}else if(i.touches.length===2){pe=!0;var P=i.touches[0],W=i.touches[1],te=st(P,W),Q=1+(te/Re-1)*H,vt=G(P),yt=G(W);if(_=(vt.x+yt.x)/2,j=(vt.y+yt.y)/2,U){var p=de();_=p.x,j=p.y}be(_,j,Q),Re=te,i.stopPropagation(),i.preventDefault()}}function ue(){ae&&(clearTimeout(ae),ae=0)}function at(i){if(w.onClick){ue();var h=_-Ne,p=j-Ie,S=Math.sqrt(h*h+p*p);S>5||(ae=setTimeout(function(){ae=0,w.onClick(i)},g))}}function xe(i){if(ue(),i.touches.length>0){var h=G(i.touches[0]),p=K(h.x,h.y);_=p.x,j=p.y}else{var S=new Date;if(S-We<g)if(U){var h=de();we(h.x,h.y,Z)}else we(Le.x,Le.y,Z);else S-_e<x&&at(i);We=S,Oe(),ft()}}function st(i,h){var p=i.clientX-h.clientX,S=i.clientY-h.clientY;return Math.sqrt(p*p+S*S)}function ct(i){un(i);var h=G(i);U&&(h=de()),we(h.x,h.y,Z)}function lt(i){if(ue(),!oe(i)){if(je=i,Ye=new Date,se)return i.stopPropagation(),!1;var h=i.button===1&&window.event!==null||i.button===0;if(h){Y.cancel();var p=G(i),S=K(p.x,p.y);return Ne=_=S.x,Ie=j=S.y,document.addEventListener("mousemove",ut),document.addEventListener("mouseup",dt),Ee.capture(i.target||i.srcElement),!1}}}function ut(i){if(!se){gt();var h=G(i),p=K(h.x,h.y),S=p.x-_,k=p.y-j;_=p.x,j=p.y,J(S,k)}}function dt(){var i=new Date;i-Ye<x&&at(je),Ee.release(),Oe(),ht()}function ht(){document.removeEventListener("mousemove",ut),document.removeEventListener("mouseup",dt),ce=!1}function ft(){document.removeEventListener("touchmove",it),document.removeEventListener("touchend",xe),document.removeEventListener("touchcancel",xe),ce=!1,pe=!1,se=!1}function mt(i){if(!X(i)){Y.cancel();var h=i.deltaY;i.deltaMode>0&&(h*=100);var p=pt(h);if(p!==1){var S=U?de():G(i);be(S.x,S.y,p),i.preventDefault()}}}function G(i){var h,p,S=E.getBoundingClientRect();return h=i.clientX-S.left,p=i.clientY-S.top,{x:h,y:p}}function we(i,h,p){var S=m.scale,k={scale:S},D={scale:p*S};Y.cancel(),Se(),le=e(k,D,{step:function(P){ye(i,h,P.scale)},done:fn})}function hn(i,h,p){var S=m.scale,k={scale:S},D={scale:p};Y.cancel(),Se(),le=e(k,D,{step:function(P){ye(i,h,P.scale)}})}function de(){var i=E.getBoundingClientRect();return{x:i.width*U.x,y:i.height*U.y}}function be(i,h,p){return Y.cancel(),Se(),Je(i,h,p)}function Se(){le&&(le.cancel(),le=null)}function pt(i){var h=Math.sign(i),p=Math.min(.25,Math.abs(Te*i/128));return 1-h*p}function gt(){ce||(ee("panstart"),ce=!0,Y.start())}function Oe(){ce&&(pe||Y.stop(),ee("panend"))}function fn(){ee("zoomend")}function ee(i){ve.fire(i,ve)}}function y(T){if(T){if(typeof T=="object")return(!R(T.x)||!R(T.y))&&v(T),T;v()}}function v(T){throw console.error(T),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function M(){}function C(T){var w=typeof T;if(!(w==="undefined"||w==="boolean")){var N=R(T.left)&&R(T.top)&&R(T.bottom)&&R(T.right);if(!N)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function R(T){return Number.isFinite(T)}function L(T){return Number.isNaN?Number.isNaN(T):T!==T}function A(){return{start:M,stop:M,cancel:M}}function V(){if(typeof document>"u")return;var T=document.getElementsByTagName("script");if(!T)return;for(var w,N=0;N<T.length;++N){var E=T[N];if(E.src&&E.src.match(/\bpanzoom(\.min)?\.js/)){w=E;break}}if(!w)return;var $=w.getAttribute("query");if(!$)return;var z=w.getAttribute("name")||"pz",m=Date.now();q();function q(){var I=document.querySelector($);if(!I){var F=Date.now(),O=F-m;if(O<2e3){setTimeout(q,100);return}console.error("Cannot find the panzoom element",z);return}var Z=H(w);console.log(Z),window[z]=b(I,Z)}function H(I){for(var F=I.attributes,O={},Z=0;Z<F.length;++Z){var X=F[Z],oe=B(X);oe&&(O[oe.name]=oe.value)}return O}function B(I){if(I.name){var F=I.name[0]==="p"&&I.name[1]==="z"&&I.name[2]==="-";if(F){var O=I.name.substr(3),Z=JSON.parse(I.value);return{name:O,value:Z}}}}}return V(),qe}var Hn=Vn();const Wn=kn(Hn);class _n{pz;currentScale=1;currentX=0;currentY=0;minZoom=.2;maxZoom=3;constructor(e,t,r){this.pz=Wn(e,{maxZoom:this.maxZoom,minZoom:this.minZoom,bounds:!1,beforeMouseDown:o=>o.target.closest(".db-table")!==null,beforeWheel:o=>{if(!o.shiftKey)return!1;const s=Math.abs(o.deltaX)>Math.abs(o.deltaY);let c=s?o.deltaX:o.deltaY;if(s&&(c=-c),c===0)return o.preventDefault(),!0;const a=c<0,l=.05,f=a?1+l:1-l;let d=this.currentScale*f;return d=Math.max(this.minZoom,Math.min(this.maxZoom,d)),o.preventDefault(),this.pz.zoomAbs(o.clientX,o.clientY,d),!0}});const n=o=>{const s=o.getTransform();this.currentScale=s.scale,this.currentX=s.x||0,this.currentY=s.y||0,t(this.currentScale),r&&r(this.currentScale,this.currentX,this.currentY)};this.pz.on("zoom",n),this.pz.on("pan",n),this.pz.on("transform",n),this.resetView()}getScale(){return this.currentScale}getTransform(){return{scale:this.currentScale,x:this.currentX,y:this.currentY}}setTransform(e,t,r){this.pz.zoomAbs(0,0,1),this.pz.moveTo(t,r),this.pz.zoomAbs(0,0,e),this.currentScale=e,this.currentX=t,this.currentY=r}zoomIn(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,1.25)}zoomOut(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,.8)}resetView(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.moveTo(e,t),this.pz.zoomAbs(0,0,1),this.currentX=e,this.currentY=t,this.currentScale=1}dispose(){this.pz.dispose()}}class Ot{el;container;constructor(e,t){this.container=e,this.el=document.createElement("div"),this.el.className="schema-hud";const r=document.createElement("div");r.className="hud-group";const n=this.createButton(me.ZoomIn,"Zoom In");n.onclick=()=>t.zoomIn();const o=this.createButton(me.ZoomOut,"Zoom Out");o.onclick=()=>t.zoomOut();const s=this.createButton(me.Center,"Reset View");s.onclick=()=>t.resetView(),r.append(o,s,n),this.el.append(r),e.appendChild(this.el)}createButton(e,t){const r=document.createElement("button");return r.className="hud-btn",r.innerHTML=e,r.title=t,r}}class jn{static create(e){const t=document.createElement("div");t.className="sticky-note",t.id=`note-${e.id}`,t.dataset.noteId=e.name,t.style.left=`${e.x}px`,t.style.top=`${e.y}px`,t.style.width=`${e.width}px`,e.color&&(t.style.backgroundColor=e.color,t.style.color="#1f2937");const r=document.createElement("div");r.className="note-content",r.innerText=e.content,t.appendChild(r);const n=document.createElement("div");return n.className="resize-handle",t.appendChild(n),t}}class Yn{container;wrapper;connectionManager;dragManager;panZoomManager;hud;parsers={dbml:new bn};constructor(e,t,r){this.container=document.getElementById(e),this.wrapper=document.createElement("div"),this.wrapper.className="schema-wrapper",this.container.appendChild(this.wrapper),this.connectionManager=new Ct(this.wrapper),this.dragManager=new An(this.wrapper,this.connectionManager,t),this.panZoomManager=new _n(this.wrapper,n=>{this.updateZoomState(n),this.dragManager.updateScale(n),this.connectionManager.updateScale(n)},(n,o,s)=>{this.updateZoomState(n,o,s),this.dragManager.updateScale(n),this.connectionManager.updateScale(n),r&&r(n,o,s)}),this.hud=new Ot(this.container,this.panZoomManager)}updateVisuals(e){this.container.style.setProperty("--grid-size",`${e.gridSize}px`),e.showGrid?this.container.classList.add("grid-visible"):this.container.classList.remove("grid-visible"),this.connectionManager.setLineStyle(e.lineStyle)}updateZoomState(e,t,r){e<.5?this.wrapper.classList.add("semantic-zoom"):this.wrapper.classList.remove("semantic-zoom"),this.container.style.setProperty("--zoom",e.toString()),t!==void 0&&r!==void 0&&(this.container.style.setProperty("--pan-x",`${t}px`),this.container.style.setProperty("--pan-y",`${r}px`))}render(e,t,r){this.wrapper.innerHTML="",this.connectionManager=new Ct(this.wrapper),this.dragManager.updateConnectionManager(this.connectionManager);const n=this.panZoomManager.getTransform();if(this.connectionManager.updateScale(n.scale),this.dragManager.updateScale(n.scale),this.updateZoomState(n.scale),this.container.querySelector(".schema-hud")?.remove(),this.hud=new Ot(this.container,this.panZoomManager),this.container.style.setProperty("--zoom",n.scale.toString()),this.container.style.setProperty("--pan-x",`${n.x}px`),this.container.style.setProperty("--pan-y",`${n.y}px`),!!t.trim())try{let o=(e||"").toLowerCase().trim();o.startsWith(".")&&(o=o.slice(1));const s=this.parsers[o];if(!s)throw new Error(`Unsupported format: ${e}`);const{tables:c,relationships:a,projectSettings:l,notes:f}=s.parse(t);if(r&&this.updateVisuals(r),l&&(l.zoom!==void 0||l.panX!==void 0)){const b=l.zoom||1,y=l.panX||0,v=l.panY||0;this.panZoomManager.setTransform(b,y,v),this.container.style.setProperty("--zoom",b.toString()),this.container.style.setProperty("--pan-x",`${y}px`),this.container.style.setProperty("--pan-y",`${v}px`)}const d=350,g=300,x=3;c.forEach((b,y)=>{const v=Nn.create(b);this.wrapper.appendChild(v);let M=b.x!==void 0?b.x:50+y%x*d,C=b.y!==void 0?b.y:50+Math.floor(y/x)*g;v.style.left=`${M}px`,v.style.top=`${C}px`,b.width&&(v.style.width=`${b.width}px`)}),this.dragManager.setRelationships(a),f&&f.forEach(b=>{this.wrapper.appendChild(jn.create(b))}),setTimeout(()=>{this.connectionManager.draw(a)},0)}catch(o){console.error(o),this.wrapper.innerHTML=`<div class="error" style="padding:20px; color:red;">Error: ${o.message}</div>`}}}let Ve={lineStyle:"Curve",showGrid:!0,gridSize:20};const He=new mn(u=>{switch(u.type){case"UPDATE_GLOBAL_SETTINGS":Ve={lineStyle:u.lineStyle,showGrid:u.showGrid,gridSize:u.gridSize},Bt.updateVisuals(Ve);break;case"UPDATE_CONTENT":Bt.render(u.format,u.content,Ve);break;case"UPDATE_THEME":Gn(u.theme);break}}),Bt=new Yn("app",(u,e,t,r)=>{He.send({type:"UPDATE_TABLE_POS",tableName:u,x:e,y:t,width:r})}),Un=document.getElementById("app");Un.addEventListener("note-pos-changed",u=>{const e=u.detail;e&&He.send({type:"UPDATE_NOTE_POS",name:e.name,x:e.x,y:e.y,width:e.width,height:e.height})});function Gn(u){u==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")}He.log("Webview Initialized & Ready");</script>
  <style rel="stylesheet" crossorigin>:root{--icon-pk: #d97706;--icon-fk: #2563eb;--icon-pk-fk: #16a34a;--icon-default: var(--text-secondary)}body.dark{--icon-pk: #fbbf24;--icon-fk: #60a5fa;--icon-pk-fk: #4ade80}.key-icon{width:14px;height:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px;color:var(--icon-default)}.key-icon svg,.key-icon svg path,.key-icon svg circle,.key-icon svg rect{fill:currentColor!important;stroke:none!important;width:100%;height:100%}.key-icon.pk{color:var(--icon-pk)}.key-icon.fk{color:var(--icon-fk)}.key-icon.pk-fk{color:var(--icon-pk-fk)}.key-icon.empty{width:14px}.table-icon{width:16px;height:16px;display:flex;align-items:center;justify-content:center;opacity:.9;color:inherit}.hud-btn,.select-arrow{color:var(--text-primary)}.table-icon svg,.table-icon svg *,.hud-btn svg,.hud-btn svg *,.select-arrow svg,.select-arrow svg *{fill:none!important;stroke:currentColor!important;stroke-width:2px!important;stroke-linecap:round;stroke-linejoin:round;vector-effect:non-scaling-stroke}.hud-btn svg{width:18px;height:18px}.select-arrow svg{width:12px;height:12px;opacity:.6}.db-table{--table-main-color: var(--header-bg);position:absolute;top:0;left:0;min-width:200px;width:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 6px #0000001a;z-index:1;display:flex;flex-direction:column}.db-table.dragging,.db-table.resizing{box-shadow:0 10px 15px #0003;z-index:100}.db-table.dragging{cursor:grabbing}.db-table.resizing{cursor:col-resize}.db-table-header{background:var(--header-bg);background-color:var(--table-main-color);color:var(--header-text);padding:10px;font-weight:700;border-top-left-radius:7px;border-top-right-radius:7px;cursor:grab;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:8px}.db-table-header:active{cursor:grabbing}.header-title-wrapper{display:flex;align-items:center;gap:6px}.table-icon{width:16px;height:16px;display:flex;opacity:.9}.title{font-size:15px;line-height:1.2}.schema-banner{background:#fff3;padding:2px 6px;border-radius:4px;font-size:12px}.table-note{font-size:11px;color:#fffc;margin-top:4px;width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.resize-handle{position:absolute;top:0;right:0;width:12px;height:100%;cursor:col-resize;z-index:50;background:transparent;border-right:4px solid rgba(0,0,0,.1);transition:all .2s;border-top-right-radius:8px;border-bottom-right-radius:8px}.resize-handle:hover,.db-table.resizing .resize-handle{background-color:#3b82f61a;border-right:4px solid var(--header-bg)}.semantic-overlay{position:absolute;inset:-1px;background-color:var(--table-main-color);color:#fff;border-radius:8px;z-index:200;display:flex;justify-content:center;align-items:center;text-align:center;padding:10px;opacity:0;pointer-events:none;transition:opacity .25s ease-in-out}.overlay-text{font-weight:700;font-size:clamp(16px,calc(18px / var(--zoom)),64px);word-break:break-word;line-height:1.2;text-shadow:0 2px 4px rgba(0,0,0,.2)}.schema-wrapper.semantic-zoom .semantic-overlay{opacity:1;pointer-events:auto;cursor:grab}.schema-wrapper.semantic-zoom .db-table.dragging .semantic-overlay{cursor:grabbing}.db-row{display:flex;justify-content:space-between;padding:6px;border-bottom:1px solid var(--table-border);font-size:12px;line-height:1.2;position:relative;transition:background-color .15s ease}.db-row:hover{background-color:#7d7d7d0d}.db-row:last-child{border-bottom:none;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.indexed-row{background:linear-gradient(to right,rgba(var(--header-rgb),.08),transparent)}.row-left{display:flex;align-items:flex-start;gap:8px;flex:1;min-width:0;padding-right:8px}.name-container{display:flex;flex-direction:column;overflow:hidden}.field-name{font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.field-note{font-size:11px;color:var(--text-secondary);margin-top:2px;line-height:1.2;font-style:italic;opacity:.8}.row-right{display:flex;align-items:flex-start;justify-content:flex-end;gap:6px;flex-shrink:0}.type-container{display:flex;flex-direction:column;align-items:flex-end}.field-type{color:var(--text-secondary);font-size:11px;font-family:SF Mono,Monaco,Menlo,Courier New,monospace;text-align:right;background:#9696961a;padding:1px 4px;border-radius:4px}.constrained-type{text-decoration-color:var(--header-bg);text-decoration-thickness:2px}.field-default{font-size:10px;color:var(--text-secondary);opacity:.7;text-align:right;margin-top:2px;max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.badge{font-size:9px;height:12px;padding:0 6px;display:flex;align-items:center;justify-content:center;border-radius:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;box-shadow:0 1px 2px #0000000d}.badge.unique{background:#f3e8ff;color:#7e22ce;border:1px solid rgba(126,34,206,.1)}.badge.not-null{background:#f3f4f6;color:#4b5563;border:1px solid rgba(75,85,99,.1)}.badge.enum{background:#ecfdf5;color:#047857;border:1px solid rgba(4,120,87,.1)}body.dark .db-row:hover{background-color:#ffffff0d}body.dark .field-type{background:#ffffff14;color:#a1a1aa}body.dark .badge.unique{background:#3b0764;color:#d8b4fe;border-color:#581c87}body.dark .badge.not-null{background:#374151;color:#e5e7eb;border-color:#4b5563}body.dark .badge.enum{background:#064e3b;color:#6ee7b7;border-color:#065f46}@keyframes flashHighlight{0%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}50%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 12px rgba(var(--header-rgb),.4)}to{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}}.db-row.highlighted{background-color:rgba(var(--header-rgb),.1);color:var(--text-primary);animation:flashHighlight 1.5s infinite;z-index:10}.db-table.highlighted{border-color:var(--header-bg);animation:flashTable 1.5s infinite;z-index:20}@keyframes flashTable{0%{box-shadow:0 4px 6px #0000001a}50%{box-shadow:0 0 15px rgba(var(--header-rgb),.6)}to{box-shadow:0 4px 6px #0000001a}}.connection-layer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:visible}.connection-group{pointer-events:auto;cursor:pointer}.relation-hit-area{fill:none;stroke:transparent;stroke-width:20px}.relation-line-base{fill:none;stroke:var(--line-color);stroke-width:2px;stroke-linecap:round;transition:stroke .3s,stroke-width .3s}.relation-line-flow{fill:none;stroke:var(--header-bg);stroke-width:2px;stroke-linecap:round;stroke-dasharray:15 150;opacity:.4;animation:flowAnimation 5s linear infinite}@keyframes flowAnimation{to{stroke-dashoffset:165}}@keyframes continuousFlow{to{stroke-dashoffset:24}}.connection-group.highlighted .relation-line-base{stroke:var(--header-bg);stroke-width:3px;opacity:.5}.connection-group.highlighted .relation-line-flow{opacity:1;stroke-width:3px;stroke-dasharray:12 12;animation:continuousFlow .8s linear infinite;filter:drop-shadow(0 0 4px var(--header-bg))}.anchor-port{fill:var(--bg-color);stroke:var(--line-color);stroke-width:2px;transition:all .3s}.anchor-port.highlighted{stroke:var(--header-bg);fill:var(--header-bg);r:5px;filter:drop-shadow(0 0 3px var(--header-bg))}.label-bg{fill:var(--bg-color);stroke:var(--table-border);transition:all .3s}.connection-group.highlighted .label-bg{stroke:var(--header-bg);fill:#fff}.relation-label-text{font-size:10px;font-weight:700;fill:var(--text-secondary);text-anchor:middle;dominant-baseline:middle;pointer-events:none}.connection-group.highlighted .relation-label-text{fill:var(--header-bg)}.sticky-note{position:absolute;min-height:100px;padding:12px;border-radius:2px;box-shadow:0 4px 8px #00000026;font-family:Comic Sans MS,Marker Felt,sans-serif;font-size:13px;line-height:1.5;z-index:5;display:flex;flex-direction:column;cursor:grab;transition:box-shadow .2s,transform .1s;box-sizing:border-box;background-image:linear-gradient(#fff6,#fff0)}.sticky-note:active,.sticky-note.dragging{cursor:grabbing;box-shadow:0 10px 20px #0003;transform:scale(1.02);z-index:50}.note-content{white-space:pre-wrap;width:100%;height:100%;overflow:hidden;pointer-events:none}.sticky-note .resize-handle{position:absolute;bottom:0;right:0;top:auto;width:15px;height:15px;cursor:nwse-resize;border:none;border-radius:0 0 2px;background:linear-gradient(135deg,transparent 50%,rgba(0,0,0,.1) 50%);z-index:10}.schema-hud{position:absolute;bottom:20px;left:20px;right:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 12px #00000026;display:flex;flex-direction:row;align-items:center;padding:6px 12px;gap:12px;z-index:1000;-webkit-user-select:none;user-select:none}.hud-group{display:flex;gap:6px;align-items:center}.hud-group+.hud-group{border-top:none;margin-top:0;border-left:1px solid var(--table-border);padding-left:12px;margin-left:0}.hud-btn{background:transparent;border:1px solid transparent;border-radius:4px;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;cursor:pointer;transition:all .12s;color:var(--text-primary)}.hud-btn:hover,.hud-btn.active{background:rgba(var(--header-rgb),.1);color:var(--header-bg)}.hud-btn:hover{color:var(--header-bg)}.custom-select{position:relative;font-size:12px;min-width:120px}.select-trigger{background:var(--bg-color);color:var(--text-primary);border:1px solid var(--table-border);border-radius:4px;padding:0 8px;cursor:pointer;white-space:nowrap;position:relative;height:28px;display:flex;align-items:center;gap:6px;min-width:100px;justify-content:space-between}.select-arrow{width:12px;height:12px;opacity:.6;display:flex;align-items:center;justify-content:center}.select-options{display:none;position:absolute;bottom:100%;left:0;margin-bottom:8px;background:var(--table-bg);border:1px solid var(--table-border);border-radius:6px;box-shadow:0 -4px 12px #00000026;width:100%;min-width:140px;overflow:hidden;z-index:1001;flex-direction:column}.custom-select.open .select-options{display:flex}.select-option{padding:8px 12px;cursor:pointer;color:var(--text-primary);transition:background .1s}.select-option:hover{background:rgba(var(--header-rgb),.1);color:var(--header-bg)}.select-option.selected{font-weight:700;background:rgba(var(--header-rgb),.05);color:var(--header-bg)}*,*:before,*:after{box-sizing:border-box}:root{--bg-color: #f4f4f4;--table-bg: #ffffff;--table-border: #d1d5db;--header-bg: #3b82f6;--header-rgb: 59, 130, 246;--header-text: #ffffff;--text-primary: #1f2937;--text-secondary: #6b7280;--line-color: #9ca3af;--grid-line: rgba(0, 0, 0, .04);--axis-line: rgba(0, 0, 0, .08)}body.dark{--bg-color: #1e1e1e;--table-bg: #2b2d30;--table-border: #4e5256;--header-bg: #3574f0;--header-rgb: 53, 116, 240;--header-text: #ffffff;--text-primary: #d1d5db;--text-secondary: #9ca3af;--line-color: #6b7280;--grid-line: rgba(255, 255, 255, .04);--axis-line: rgba(255, 255, 255, .08)}body{margin:0;background:var(--bg-color);color:var(--text-primary);font-family:sans-serif;overflow:hidden}#app{width:100vw;height:100vh;overflow:hidden;position:relative;--zoom: 1;--pan-x: 0px;--pan-y: 0px;--grid-size: 20px}#app.grid-visible{background-image:linear-gradient(to right,var(--axis-line) 2px,transparent 2px),linear-gradient(to bottom,var(--axis-line) 2px,transparent 2px),linear-gradient(to right,var(--grid-line) 1px,transparent 1px),linear-gradient(to bottom,var(--grid-line) 1px,transparent 1px);background-repeat:no-repeat,no-repeat,repeat,repeat;background-position:var(--pan-x) 0,0 var(--pan-y),var(--pan-x) var(--pan-y),var(--pan-x) var(--pan-y);background-size:2px 100%,100% 2px,calc(var(--grid-size) * var(--zoom)) calc(var(--grid-size) * var(--zoom)),calc(var(--grid-size) * var(--zoom)) calc(var(--grid-size) * var(--zoom))}.schema-wrapper{width:100%;height:100%;transform-origin:0 0;position:relative}</style>
</head>

<body>
<div id="app"></div>
</body>

</html>
