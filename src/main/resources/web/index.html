<!-- web/index.html -->
<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="./vite.svg"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>web</title>
  <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();class un{onMessage;constructor(e){this.onMessage=e,window.addEventListener("message",t=>{const r=t.data;r&&typeof r.type=="string"&&this.onMessage(r)}),this.send({type:"READY"})}send(e){const t=JSON.stringify(e);window.cefQuery?window.cefQuery({request:t}):console.log("Bridge Dev Log:",e)}log(e){this.send({type:"LOG",level:"INFO",message:e})}}function Ce(p){return p.replace(/[^a-zA-Z0-9_]/g,"_")}function dn(p){return p.replace(/\/\*[\s\S]*?\*\//g,"").split(`
`).map(t=>{if(t.trim().startsWith("///"))return t;const n=t.indexOf("//");return n!==-1?t[n+2]==="/"?t:t.substring(0,n):t}).join(`
`)}function fe(p){const e=new Map;if(!p)return e;const t=[];let r="",n=!1;for(let o=0;o<p.length;o++){const s=p[o];(s==="'"||s==='"')&&(n=!n),s===","&&!n?(t.push(r.trim()),r=""):r+=s}r.trim()&&t.push(r.trim());for(let o of t){if(!o)continue;const s=o.indexOf(":");if(s!==-1){const c=o.substring(0,s).trim(),a=o.substring(s+1).trim();e.set(c.toLowerCase(),a)}else e.set(o.toLowerCase(),"true")}return e}function hn(p,e){const r=p.substring(0,e).split(`
`),n=[];for(let o=r.length-1;o>=0;o--){const s=r[o].trim();if(s)if(s.startsWith("///"))n.unshift(s.replace(/^\/\/\/\s?/,""));else break}return n.length>0?n.join(`
`):void 0}function fn(p){const e={},r=/Project\s*(?:(?:"[^"]*")|(?:[\w]+))?\s*\{([\s\S]*?)\}/i.exec(p);if(r){const n=r[1],o={line_style:"lineStyle",show_grid:"showGrid",grid_size:"gridSize",database_type:"databaseType",note:"note"},s=/(\w+)\s*:\s*(?:'''([\s\S]*?)'''|'([^']*)'|([^ \n}]+))/g;let c;for(;(c=s.exec(n))!==null;){const a=c[1],h=c[2],u=c[3],d=c[4],g=o[a]||a;let l=h||u||d;l==="true"&&(l=!0),l==="false"&&(l=!1),!isNaN(Number(l))&&l!==""&&typeof l=="string"&&(l.includes("'")||(l=Number(l))),e[g]=l}}return e}function yt(p){const e=[],t=p.split(`
`).map(r=>r.trim()).filter(Boolean);for(let r of t){const n=/^(\(?\s*[\w\.,\s]+\s*\)?)(?:\s*\[(.*?)\])?$/i.exec(r);if(!n)continue;const o=n[1].replace(/^\(/,"").replace(/\)$/,"").split(",").map(c=>c.trim()).filter(Boolean),s=fe(n[2]||"");e.push({columns:o,settings:Object.fromEntries(s),raw:r})}return e}function $t(p,e,t,r,n){const o=c=>c.replace(/"/g,"");let s="1:n";return t==="<"?s="1:n":t===">"?s="n:1":t==="-"?s="1:1":t==="<>"&&(s="m:n"),{fromTable:Ce(o(p)),fromColumn:o(e),toTable:Ce(o(r)),toColumn:o(n),type:s}}function mn(p){const e=[],t=/("?[\w.]+"?)\.("?[\w"]+"?)\s*(<>|[<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/g,r=/Ref\s*[^{:]*[:\{]\s*([^}]+)\s*\}?/gi;let n;for(;(n=r.exec(p))!==null;){const o=n[1];let s;for(;(s=t.exec(o))!==null;)e.push($t(s[1],s[2],s[3],s[4],s[5]))}return e}function pn(p,e,t,r){const n=fe(t);let o=n.has("pk")||n.has("primary key"),s=n.has("unique"),c=n.has("not null"),a=r;if(n.has("note")){let g=n.get("note");g.startsWith("'")&&g.endsWith("'")||g.startsWith('"')&&g.endsWith('"')?a=g.substring(1,g.length-1):a=g}let h=n.get("default");h&&(h.startsWith("'")&&h.endsWith("'")||h.startsWith("`")&&h.endsWith("`"))&&(h=h.substring(1,h.length-1));let u=!1,d;if(n.has("ref")){const g=n.get("ref"),l=/([<>=-])\s*("?[\w.]+"?)\.("?[\w"]+"?)/i.exec(g);l&&(u=!0,d={symbol:l[1],toTable:l[2],toColumn:l[3]})}return{name:p,type:e,isPk:o,isUnique:s,isNotNull:c,isFk:u,note:a,default:h,enumValues:void 0,inlineRef:d}}function xt(p){const e=[],t=p.split(`
`);let r=[];for(let n of t){const o=n.trim();if(o.startsWith("///")){r.push(o.replace(/^\/\/\/\s?/,""));continue}if(!o||o.startsWith("Note"))continue;const c=/^("?[\w]+"?)\s+([a-zA-Z0-9_()\[\]]+)(?:\s*\[(.*?)\])?/.exec(o);if(c){const a=c[1].replace(/"/g,""),h=c[2],u=c[3]||"",d=r.length>0?r.join(`
`):void 0;e.push(pn(a,h,u,d)),r=[]}else(o.startsWith("indexes")||o.startsWith("Note"))&&(r=[])}return{fields:e}}function gn(p){const e=[],t=[],r=new Map,n=/TablePartial\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/gi;let o;for(;(o=n.exec(p))!==null;){const a=o[1].replace(/"/g,""),h=o[2]||"",u=o[3]||"",d=/indexes\s*\{([\s\S]*?)\}/i.exec(u);let g=[],l=u;d&&(g=yt(d[1]),l=u.replace(d[0],""));const{fields:E}=xt(l);r.set(a,{name:a,settings:fe(h),fields:E,indexes:g})}const s=/Table\s+("?[\w.]+"?)\s*(?:\[(.*?)\])?\s*(?:as\s+\w+\s*)?\{([\s\S]*?)\}/gi;let c;for(;(c=s.exec(p))!==null;){const a=c.index,h=hn(p,a),u=c[1].replace(/"/g,""),d=c[2]||"",g=c[3]||"",l=fe(d),E=/indexes\s*\{([\s\S]*?)\}/i.exec(g);let x=[],v=g;E&&(x=yt(E[1]),v=g.replace(E[0],""));const L=/^\s*Note(?:\s*:\s*|\s+)(['"])([\s\S]*?)\1/im.exec(v);let M;L&&(M=L[2],v=v.replace(L[0],""));let A=h;if(l.has("note")){let S=l.get("note");(S.startsWith("'")&&S.endsWith("'")||S.startsWith('"')&&S.endsWith('"'))&&(S=S.substring(1,S.length-1)),A=S}else M&&(A=M);const{fields:I}=xt(v),H=new Map;I.forEach(S=>H.set(S.name,S)),I.forEach(S=>{S.inlineRef&&t.push($t(u,S.name,S.inlineRef.symbol,S.inlineRef.toTable,S.inlineRef.toColumn))}),e.push({id:Ce(u),name:u,fields:I,note:A,color:l.get("color")||void 0,width:l.has("width")?parseInt(l.get("width"),10):void 0,x:l.has("x")?parseInt(l.get("x"),10):void 0,y:l.has("y")?parseInt(l.get("y"),10):void 0,settings:Object.fromEntries(l),indexes:x})}return{tables:e,inlineRelationships:t}}function vn(p){const e=[],t=/Note\s+(\w+)\s*(?:\[(.*?)\])?\s*\{([\s\S]*?)\}/g;let r;for(;(r=t.exec(p))!==null;){const n=r[1],o=r[2]||"";let s=r[3].trim();s.startsWith("'''")&&s.endsWith("'''")?s=s.substring(3,s.length-3):s.startsWith("'")&&s.endsWith("'")&&(s=s.substring(1,s.length-1));const c=fe(o);e.push({id:Ce(n),name:n,content:s.trim(),x:c.has("x")?parseInt(c.get("x"),10):0,y:c.has("y")?parseInt(c.get("y"),10):0,width:c.has("width")?parseInt(c.get("width"),10):250,color:c.get("color")||"#fff9c4"})}return e}class yn{parse(e){const t=dn(e),r=fn(t),{tables:n,inlineRelationships:o}=gn(t),s=mn(t),c=[...o,...s],a=vn(t);return{tables:n,relationships:c,projectSettings:r,notes:a}}}const xn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" width="800px" height="800px" viewBox="0 0 24 24"><path d="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>`,wn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M4 9L20 9M8 9V20M6.2 20H17.8C18.9201 20 19.4802 20 19.908 19.782C20.2843 19.5903 20.5903 19.2843 20.782 18.908C21 18.4802 21 17.9201 21 16.8V7.2C21 6.0799 21 5.51984 20.782 5.09202C20.5903 4.71569 20.2843 4.40973 19.908 4.21799C19.4802 4 18.9201 4 17.8 4H6.2C5.0799 4 4.51984 4 4.09202 4.21799C3.71569 4.40973 3.40973 4.71569 3.21799 5.09202C3 5.51984 3 6.07989 3 7.2V16.8C3 17.9201 3 18.4802 3.21799 18.908C3.40973 19.2843 3.71569 19.5903 4.09202 19.782C4.51984 20 5.07989 20 6.2 20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,bn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M6 12H18M12 6V18" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Ln=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M6 12L18 12" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Sn=`<?xml version="1.0" encoding="utf-8"?>\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->\r
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r
<path d="M15 4V7C15 8.10457 15.8954 9 17 9H20M9 4V7C9 8.10457 8.10457 9 7 9H4M15 20V17C15 15.8954 15.8954 15 17 15H20M9 20V17C9 15.8954 8.10457 15 7 15H4" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r
</svg>`,Cn=`<?xml version="1.0" encoding="utf-8"?>
\r\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">\r
  <title>grid</title>\r
  <g id="Layer_2" data-name="Layer 2">\r
    <g id="invisible_box" data-name="invisible box">\r
      <rect width="48" height="48" fill="none"/>\r
    </g>\r
    <g id="icons_Q2" data-name="icons Q2">\r
      <path d="M44,26a2,2,0,0,0,0-4H38V14h6a2,2,0,0,0,0-4H38V4a2,2,0,0,0-4,0v6H26V4a2,2,0,0,0-4,0v6H14V4a2,2,0,0,0-4,0v6H4a2,2,0,0,0,0,4h6v8H4a2,2,0,0,0,0,4h6v8H4a2,2,0,0,0,0,4h6v6a2,2,0,0,0,4,0V38h8v6a2,2,0,0,0,4,0V38h8v6a2,2,0,0,0,4,0V38h6a2,2,0,0,0,0-4H38V26ZM34,14v8H26V14ZM14,14h8v8H14Zm0,20V26h8v8Zm20,0H26V26h8Z"/>\r
    </g>\r
  </g>\r
</svg>`,En=`<?xml version="1.0" encoding="UTF-8"?>\r
\x3C!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\r
    <title>up_fill</title>\r
    <g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\r
        <g id="Arrow" transform="translate(-434.000000, -48.000000)">\r
            <g id="up_fill" transform="translate(434.000000, 48.000000)">\r
                <path d="M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z" id="MingCute" fill-rule="nonzero">
\r</path>\r
                <path d="M10.9393,7.93932 C11.5251,7.35354 12.4749,7.35354 13.0607,7.93932 L18.7175,13.5962 C19.3033,14.182 19.3033,15.1317 18.7175,15.7175 C18.1317,16.3033 17.182,16.3033 16.5962,15.7175 L12,11.1213 L7.40381,15.7175 C6.81802,16.3033 5.86827,16.3033 5.28248,15.7175 C4.6967,15.1317 4.6967,14.182 5.28249,13.5962 L10.9393,7.93932 Z" id="路径" fill="#09244B">
\r</path>\r
            </g>\r
        </g>\r
    </g>\r
</svg>`,Q={Key:xn,Table:wn,ZoomIn:bn,ZoomOut:Ln,Center:Sn,Grid:Cn,ChevronUp:En};class Tn{static create(e,t){const r=document.createElement("div");r.className="db-row",r.id=`col-${t}-${e.name}`,e.isUnique&&r.classList.add("indexed-row");const n=document.createElement("div");n.className="row-left";const o=document.createElement("span");o.className="key-icon",e.isPk||e.isFk?(o.innerHTML=Q.Key,e.isPk&&e.isFk?(o.classList.add("pk-fk"),o.title="Primary & Foreign Key"):e.isPk?(o.classList.add("pk"),o.title="Primary Key"):(o.classList.add("fk"),o.title="Foreign Key")):o.classList.add("empty"),n.appendChild(o);const s=document.createElement("div");s.className="name-container";const c=document.createElement("span");if(c.className="field-name",c.innerText=e.name,s.appendChild(c),e.note){const d=document.createElement("div");d.className="field-note",d.innerText=e.note,s.appendChild(d)}n.appendChild(s);const a=document.createElement("div");a.className="row-right";const h=document.createElement("div");h.className="type-container";const u=document.createElement("span");if(u.className="field-type",e.isUnique&&u.classList.add("constrained-type"),u.innerText=e.type,h.appendChild(u),e.enumValues&&e.enumValues.length>0){const d=this.createBadge("ENUM","enum");d.title=`Enum values: ${e.enumValues.join(", ")}`,a.appendChild(d)}if(e.isUnique&&a.appendChild(this.createBadge("UQ","unique")),e.isNotNull&&a.appendChild(this.createBadge("NN","not-null")),e.default){const d=document.createElement("div");d.className="field-default",d.innerText=`default: ${e.default}`,h.appendChild(d)}return a.appendChild(h),r.appendChild(n),r.appendChild(a),r}static createBadge(e,t){const r=document.createElement("span");return r.className=`badge ${t}`,r.innerText=e,r}}class Mn{static create(e){const t=document.createElement("div");t.className="db-table",t.id=`table-${e.id}`,t.dataset.tableName=e.name;const r=e.color||"var(--header-bg)";t.style.setProperty("--table-main-color",r),e.width&&(t.style.width=`${e.width}px`);const[n,o]=e.name.includes(".")?e.name.split("."):["",e.name],s=document.createElement("div");s.className="semantic-overlay";const c=document.createElement("div");c.className="overlay-text",c.innerText=o,s.appendChild(c),t.appendChild(s);const a=document.createElement("div");a.className="db-table-header";const h=document.createElement("div");h.className="header-title-wrapper";const u=document.createElement("span");u.className="table-icon",u.innerHTML=Q.Table,h.appendChild(u);const d=document.createElement("span");d.className="title",d.innerText=o,h.appendChild(d),a.appendChild(h);const g=document.createElement("span");if(g.className="schema-banner",g.innerText=n||"public",a.appendChild(g),e.note){const E=document.createElement("div");E.className="table-note",E.innerText=e.note,a.appendChild(E)}t.appendChild(a),e.fields.forEach(E=>{t.appendChild(Tn.create(E,e.id))});const l=document.createElement("div");return l.className="resize-handle",l.title="Drag to resize",t.appendChild(l),t}}class Nn{static MIN_STRAIGHT=20;static MAX_STRAIGHT=80;static LANE_WIDTH=10;static LABEL_OFFSET=25;static calculatePath(e,t,r,n,o,s,c,a){const h=(V,D,k)=>k<=1?V.y+V.height/2:V.y+V.height*(D+1)/(k+1),u=h(e,a.fromColIndex,a.fromColTotal),d=h(t,a.toColIndex,a.toColTotal),g={x:e.x+e.width,y:u},l={x:e.x,y:u},E={x:t.x+t.width,y:d},x={x:t.x,y:d},v=e.x<t.x+t.width&&e.x+e.width>t.x;let y,L,M,A;v?(y=g,L=E,M=1,A=1):e.x<t.x?(y=g,L=x,M=1,A=-1):(y=l,L=E,M=-1,A=1);const I=c==="Rectilinear"||c==="RoundRectilinear",H=Math.abs(L.x-y.x);let S=Math.max(this.MIN_STRAIGHT,Math.min(this.MAX_STRAIGHT,H/2));const b=S+(I?a.fromLaneIndex*this.LANE_WIDTH:0),N=S+(I?a.toLaneIndex*this.LANE_WIDTH:0),T={x:y.x+b*M,y:y.y},$={x:L.x+N*A,y:L.y};if(v){const V=Math.max(40,Math.abs(L.y-y.y)*.5),D=I?Math.max(a.fromLaneIndex,a.toLaneIndex)*this.LANE_WIDTH:0;T.x=Math.max(y.x,L.x)+V+D,$.x=T.x}let B="";switch(c){case"Rectilinear":case"RoundRectilinear":{const V=(T.x+$.x)/2,D={x:V,y:y.y},k={x:V,y:L.y};if(c==="Rectilinear")B=`M ${y.x} ${y.y} L ${D.x} ${D.y} L ${k.x} ${k.y} L ${L.x} ${L.y}`;else{const P=Math.min(12,Math.abs(k.y-D.y)/2,Math.abs(D.x-y.x)/2),Z=L.y>y.y?1:-1,q=D.x>y.x?1:-1,ne=L.x>k.x?1:-1;B=`M ${y.x} ${y.y} 
               L ${D.x-P*q} ${D.y} 
               Q ${D.x} ${D.y} ${D.x} ${D.y+P*Z} 
               L ${k.x} ${k.y-P*Z} 
               Q ${k.x} ${k.y} ${k.x+P*ne} ${k.y} 
               L ${L.x} ${L.y}`}break}case"Oblique":B=`M ${y.x} ${y.y} L ${T.x} ${T.y} L ${$.x} ${$.y} L ${L.x} ${L.y}`;break;case"RoundOblique":B=`M ${y.x} ${y.y} 
             L ${T.x} ${T.y} 
             Q ${(T.x+$.x)/2} ${(T.y+$.y)/2} ${$.x} ${$.y} 
             L ${L.x} ${L.y}`;break;default:B=`M ${y.x} ${y.y} C ${T.x} ${T.y}, ${$.x} ${$.y}, ${L.x} ${L.y}`;break}const C=this.getLabelPos(y,T,a.fromStagger),U=this.getLabelPos(L,$,a.toStagger);return{d:B,start:y,end:L,labelStart:{text:a.fromLabel,pos:C},labelEnd:{text:a.toLabel,pos:U},fromId:r,toId:n,fromTableId:o,toTableId:s}}static getLabelPos(e,t,r){const n=t.x-e.x,o=t.y-e.y,s=Math.sqrt(n*n+o*o),a=(this.LABEL_OFFSET+r*18)/(s||1);return{x:e.x+n*a,y:e.y+o*a}}}class An{static createGroup(e){const t=document.createElementNS("http://www.w3.org/2000/svg","g");t.classList.add("connection-group"),t.dataset.from=e.fromId,t.dataset.to=e.toId,t.dataset.fromTable=e.fromTableId,t.dataset.toTable=e.toTableId;const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",e.d),r.classList.add("relation-hit-area"),t.appendChild(r);const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",e.d),n.classList.add("relation-line-base"),t.appendChild(n);const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d",e.d),o.classList.add("relation-line-flow"),t.appendChild(o),this.createLabels(e).forEach(c=>t.appendChild(c)),t}static createLabels(e){const t=[];return e.labelStart.text&&t.push(this.createLabelBadge(e.labelStart.text,e.labelStart.pos.x,e.labelStart.pos.y)),e.labelEnd.text&&t.push(this.createLabelBadge(e.labelEnd.text,e.labelEnd.pos.x,e.labelEnd.pos.y)),t}static createLabelBadge(e,t,r){const n=document.createElementNS("http://www.w3.org/2000/svg","g");n.classList.add("relation-label-group");const o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttribute("x",(t-9).toString()),o.setAttribute("y",(r-7).toString()),o.setAttribute("width","18"),o.setAttribute("height","14"),o.setAttribute("rx","4"),o.classList.add("label-bg");const s=document.createElementNS("http://www.w3.org/2000/svg","text");return s.setAttribute("x",t.toString()),s.setAttribute("y",(r+1).toString()),s.classList.add("relation-label-text"),s.textContent=e,n.appendChild(o),n.appendChild(s),n}}class wt{static create(e){const t=document.createElementNS("http://www.w3.org/2000/svg","circle");return t.setAttribute("cx",e.x.toString()),t.setAttribute("cy",e.y.toString()),t.setAttribute("r","3.5"),t.classList.add("anchor-port"),t}}class bt{svgLayer;scale=1;container;currentRelationships=[];currentLineStyle="Curve";constructor(e){this.container=e,this.svgLayer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgLayer.classList.add("connection-layer"),e.appendChild(this.svgLayer),this.setupInteractions()}updateScale(e){this.scale=e}setLineStyle(e){this.currentLineStyle=e,this.draw(this.currentRelationships)}draw(e){this.currentRelationships=e,this.svgLayer.innerHTML="";const t=new Map,r=new Map;e.forEach(c=>{r.set(c,{fromColIndex:0,fromColTotal:1,toColIndex:0,toColTotal:1,fromLaneIndex:0,toLaneIndex:0,fromLabel:null,fromStagger:0,toLabel:null,toStagger:0})});const n=new Map,o=c=>{if(!t.has(c)){const a=document.getElementById(c);a&&t.set(c,this.getRelativeRect(a))}return t.get(c)};e.forEach(c=>{const a=`col-${c.fromTable}-${c.fromColumn}`,h=`col-${c.toTable}-${c.toColumn}`,u=o(a),d=o(h);if(!u||!d)return;const g=this.getLabelString(c.type,!0),l=this.getLabelString(c.type,!1);n.has(a)||n.set(a,[]),n.get(a).push({rel:c,isFrom:!0,rect:u,otherY:d.y+d.height/2,label:g}),n.has(h)||n.set(h,[]),n.get(h).push({rel:c,isFrom:!1,rect:d,otherY:u.y+u.height/2,label:l})});for(const c of n.values()){c.sort((d,g)=>d.otherY-g.otherY);const a=c.length,h=new Set;let u=0;c.forEach((d,g)=>{const l=r.get(d.rel);if(!l)return;let E=null,x=0;h.has(d.label)||(h.add(d.label),E=d.label,x=u++),d.isFrom?(l.fromColIndex=g,l.fromColTotal=a,l.fromLabel=E,l.fromStagger=x):(l.toColIndex=g,l.toColTotal=a,l.toLabel=E,l.toStagger=x)})}const s=new Map;e.forEach(c=>{const a=`col-${c.fromTable}-${c.fromColumn}`,h=`col-${c.toTable}-${c.toColumn}`,u=t.get(a),d=t.get(h);if(!u||!d)return;const g=u.x<d.x?"right":"left",l=d.x<u.x?"right":"left",E=`${c.fromTable}-${g}`,x=`${c.toTable}-${l}`,v={rel:c,isFrom:!0,rect:u,otherY:d.y+d.height/2,label:""},y={rel:c,isFrom:!1,rect:d,otherY:u.y+u.height/2,label:""};s.has(E)||s.set(E,[]),s.get(E).push(v),s.has(x)||s.set(x,[]),s.get(x).push(y)});for(const[c,a]of s.entries()){if(a.length<=1)continue;const h=a.reduce((g,l)=>g+l.rect.y,0)/a.length,d=a.reduce((g,l)=>g+l.otherY,0)/a.length>h;a.sort((g,l)=>Math.abs(g.rect.y-l.rect.y)>1?g.rect.y-l.rect.y:g.otherY-l.otherY),a.forEach((g,l)=>{const E=r.get(g.rel);if(!E)return;const x=d?a.length-1-l:l;g.isFrom?E.fromLaneIndex=x:E.toLaneIndex=x})}e.forEach(c=>{const a=`col-${c.fromTable}-${c.fromColumn}`,h=`col-${c.toTable}-${c.toColumn}`,u=t.get(a),d=t.get(h),g=r.get(c);if(u&&d&&g){const l=Nn.calculatePath(u,d,a,h,`table-${c.fromTable}`,`table-${c.toTable}`,this.currentLineStyle,g),E=An.createGroup(l);this.svgLayer.appendChild(E);const x=wt.create(l.start);x.dataset.anchorId=a,this.svgLayer.appendChild(x);const v=wt.create(l.end);v.dataset.anchorId=h,this.svgLayer.appendChild(v)}})}getLabelString(e,t){const r=e.split(":");return t?r[0]:r[1]}getRelativeRect(e){const t=e.getBoundingClientRect(),r=this.svgLayer.getBoundingClientRect();return{x:(t.left-r.left)/this.scale,y:(t.top-r.top)/this.scale,width:t.width/this.scale,height:t.height/this.scale}}setupInteractions(){this.container.addEventListener("mouseover",e=>this.handleHover(e,!0)),this.container.addEventListener("mouseout",e=>this.handleHover(e,!1))}handleHover(e,t){if(!t){this.clearHighlights();return}const r=e.target,n=r.closest(".connection-group");if(n){this.activateConnection(n);return}const o=r.closest(".db-row");if(o&&o.id){this.activateColumn(o.id);return}const s=r.closest(".db-table");if(s&&s.id){this.activateTable(s.id);return}}clearHighlights(){document.querySelectorAll(".highlighted").forEach(t=>t.classList.remove("highlighted"))}activateConnection(e){e.classList.add("highlighted");const t=e.dataset.from,r=e.dataset.to;t&&this.setHighlight(t),r&&this.setHighlight(r),this.highlightAnchorsForLine(t,r)}activateColumn(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from="${e}"], [data-to="${e}"]`).forEach(r=>{r.classList.add("highlighted");const n=r;n.dataset.from!==e&&this.setHighlight(n.dataset.from),n.dataset.to!==e&&this.setHighlight(n.dataset.to),this.highlightAnchorsForLine(n.dataset.from,n.dataset.to)})}activateTable(e){this.setHighlight(e),this.svgLayer.querySelectorAll(`[data-from-table="${e}"], [data-to-table="${e}"]`).forEach(r=>{r.classList.add("highlighted");const n=r;this.setHighlight(n.dataset.from),this.setHighlight(n.dataset.to),this.highlightAnchorsForLine(n.dataset.from,n.dataset.to)})}setHighlight(e){if(!e)return;const t=document.getElementById(e);t&&t.classList.add("highlighted")}highlightAnchorsForLine(e,t){e&&this.svgLayer.querySelectorAll(`[data-anchor-id="${e}"]`).forEach(n=>n.classList.add("highlighted")),t&&this.svgLayer.querySelectorAll(`[data-anchor-id="${t}"]`).forEach(n=>n.classList.add("highlighted"))}}class Rn{activeEl=null;mode="NONE";initialMouse={x:0,y:0};initialVal={x:0,y:0,width:0,height:0};scale=1;relationships=[];connectionManager;onUpdate;wrapper;constructor(e,t,r){this.wrapper=e,this.connectionManager=t,this.onUpdate=r,e.addEventListener("mousedown",n=>this.onMouseDown(n)),window.addEventListener("mousemove",n=>this.onMouseMove(n)),window.addEventListener("mouseup",()=>this.onMouseUp())}updateConnectionManager(e){this.connectionManager=e}setRelationships(e){this.relationships=e}updateScale(e){this.scale=e}onMouseDown(e){const t=e.target;if(t.classList.contains("resize-handle")){const n=t.parentElement;n&&this.startResize(n,e);return}if(t.closest(".db-table-header")||t.closest(".semantic-overlay")){const n=t.closest(".db-table");n&&this.startDrag(n,e);return}const r=t.closest(".sticky-note");if(r){this.startDrag(r,e);return}}startDrag(e,t){this.mode="DRAG",this.activeEl=e,this.initialVal.x=e.offsetLeft,this.initialVal.y=e.offsetTop,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("dragging")}startResize(e,t){this.mode="RESIZE",this.activeEl=e,this.initialVal.width=e.offsetWidth,this.initialVal.height=e.offsetHeight,this.initialMouse={x:t.clientX,y:t.clientY},t.stopPropagation(),t.preventDefault(),e.classList.add("resizing"),document.body.style.cursor="nwse-resize"}onMouseMove(e){if(!this.activeEl)return;const t=(e.clientX-this.initialMouse.x)/this.scale,r=(e.clientY-this.initialMouse.y)/this.scale;if(this.mode==="DRAG")this.activeEl.style.left=`${this.initialVal.x+t}px`,this.activeEl.style.top=`${this.initialVal.y+r}px`,this.activeEl.style.transform="none",this.activeEl.classList.contains("db-table")&&this.connectionManager.draw(this.relationships);else if(this.mode==="RESIZE"){const n=Math.max(100,this.initialVal.width+t);if(this.activeEl.style.width=`${n}px`,this.activeEl.classList.contains("sticky-note")){const o=Math.max(100,this.initialVal.height+r);this.activeEl.style.height=`${o}px`}this.activeEl.classList.contains("db-table")&&this.connectionManager.draw(this.relationships)}}onMouseUp(){if(!this.activeEl)return;const e=this.activeEl,t=Math.round(parseInt(e.style.left||"0",10)),r=Math.round(parseInt(e.style.top||"0",10)),n=Math.round(e.getBoundingClientRect().width/this.scale),o=Math.round(e.getBoundingClientRect().height/this.scale);if(e.classList.contains("db-table")){const s=e.querySelector(".title"),c=e.dataset&&e.dataset.tableName||(s?s.textContent||"":e.id.replace("table-",""));c&&this.onUpdate(c,t,r,n)}else if(e.classList.contains("sticky-note")){const s=e.dataset.noteId||e.id.replace("note-",""),c=new CustomEvent("note-pos-changed",{detail:{name:s,x:t,y:r,width:n,height:o},bubbles:!0});this.wrapper.dispatchEvent(c)}e.classList.remove("dragging"),e.classList.remove("resizing"),document.body.style.cursor="",this.activeEl=null,this.mode="NONE"}}function kn(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var de={exports:{}},Lt;function In(){if(Lt)return de.exports;Lt=1,de.exports=p,de.exports.addWheelListener=p,de.exports.removeWheelListener=e;function p(t,r,n){t.addEventListener("wheel",r,n)}function e(t,r,n){t.removeEventListener("wheel",r,n)}return de.exports}var he={exports:{}},Oe,St;function $n(){if(St)return Oe;St=1;var p=4,e=.001,t=1e-7,r=10,n=11,o=1/(n-1),s=typeof Float32Array=="function";function c(x,v){return 1-3*v+3*x}function a(x,v){return 3*v-6*x}function h(x){return 3*x}function u(x,v,y){return((c(v,y)*x+a(v,y))*x+h(v))*x}function d(x,v,y){return 3*c(v,y)*x*x+2*a(v,y)*x+h(v)}function g(x,v,y,L,M){var A,I,H=0;do I=v+(y-v)/2,A=u(I,L,M)-x,A>0?y=I:v=I;while(Math.abs(A)>t&&++H<r);return I}function l(x,v,y,L){for(var M=0;M<p;++M){var A=d(v,y,L);if(A===0)return v;var I=u(v,y,L)-x;v-=I/A}return v}function E(x){return x}return Oe=function(v,y,L,M){if(!(0<=v&&v<=1&&0<=L&&L<=1))throw new Error("bezier x values must be in [0, 1] range");if(v===y&&L===M)return E;for(var A=s?new Float32Array(n):new Array(n),I=0;I<n;++I)A[I]=u(I*o,v,L);function H(S){for(var b=0,N=1,T=n-1;N!==T&&A[N]<=S;++N)b+=o;--N;var $=(S-A[N])/(A[N+1]-A[N]),B=b+$*o,C=d(B,v,L);return C>=e?l(S,B,v,L):C===0?B:g(S,b,b+o,v,L)}return function(b){return b===0?0:b===1?1:u(H(b),y,M)}},Oe}var Ct;function Bn(){if(Ct)return he.exports;Ct=1;var p=$n(),e={ease:p(.25,.1,.25,1),easeIn:p(.42,0,1,1),easeOut:p(0,0,.58,1),easeInOut:p(.42,0,.58,1),linear:p(0,0,1,1)};he.exports=t,he.exports.makeAggregateRaf=c,he.exports.sharedScheduler=c();function t(a,h,u){var d=Object.create(null),g=Object.create(null);u=u||{};var l=typeof u.easing=="function"?u.easing:e[u.easing];l||(u.easing&&console.warn("Unknown easing function in amator: "+u.easing),l=e.ease);var E=typeof u.step=="function"?u.step:r,x=typeof u.done=="function"?u.done:r,v=n(u.scheduler),y=Object.keys(h);y.forEach(function(N){d[N]=a[N],g[N]=h[N]-a[N]});var L=typeof u.duration=="number"?u.duration:400,M=Math.max(1,L*.06),A,I=0;return A=v.next(S),{cancel:H};function H(){v.cancel(A),A=0}function S(){var N=l(I/M);I+=1,b(N),I<=M?(A=v.next(S),E(a)):(A=0,setTimeout(function(){x(a)},0))}function b(N){y.forEach(function(T){a[T]=g[T]*N+d[T]})}}function r(){}function n(a){if(!a){var h=typeof window<"u"&&window.requestAnimationFrame;return h?o():s()}if(typeof a.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof a.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return a}function o(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function s(){return{next:function(a){return setTimeout(a,1e3/60)},cancel:function(a){return clearTimeout(a)}}}function c(){var a=new Set,h=new Set,u=0;return{next:g,cancel:g,clearAll:d};function d(){a.clear(),h.clear(),cancelAnimationFrame(u),u=0}function g(x){h.add(x),l()}function l(){u||(u=requestAnimationFrame(E))}function E(){u=0;var x=h;h=a,a=x,a.forEach(function(v){v()}),a.clear()}}return he.exports}var De,Et;function zn(){if(Et)return De;Et=1;function p(r){t(r);const n=e(r);return r.on=n.on,r.off=n.off,r.fire=n.fire,r}function e(r){let n=Object.create(null);return{on:function(o,s,c){if(typeof s!="function")throw new Error("callback is expected to be a function");let a=n[o];return a||(a=n[o]=[]),a.push({callback:s,ctx:c}),r},off:function(o,s){if(typeof o>"u")return n=Object.create(null),r;if(n[o])if(typeof s!="function")delete n[o];else{const c=n[o];for(let a=0;a<c.length;++a)c[a].callback===s&&c.splice(a,1)}return r},fire:function(o){const s=n[o];if(!s)return r;let c;arguments.length>1&&(c=Array.prototype.slice.call(arguments,1));for(let a=0;a<s.length;++a){const h=s[a];h.callback.apply(h.ctx,c)}return r}}}function t(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");const n=["on","fire","off"];for(let o=0;o<n.length;++o)if(r.hasOwnProperty(n[o]))throw new Error("Subject cannot be eventified, since it already has property '"+n[o]+"'")}return De=p,De}var Pe,Tt;function On(){if(Tt)return Pe;Tt=1,Pe=p;function p(r,n,o){typeof o!="object"&&(o={});var s=typeof o.minVelocity=="number"?o.minVelocity:5,c=typeof o.amplitude=="number"?o.amplitude:.25,a=typeof o.cancelAnimationFrame=="function"?o.cancelAnimationFrame:e(),h=typeof o.requestAnimationFrame=="function"?o.requestAnimationFrame:t(),u,d,g=342,l,E,x,v,y,L,M,A;return{start:H,stop:b,cancel:I};function I(){a(l),a(A)}function H(){u=r(),v=M=E=y=0,d=new Date,a(l),a(A),l=h(S)}function S(){var T=Date.now(),$=T-d;d=T;var B=r(),C=B.x-u.x,U=B.y-u.y;u=B;var V=1e3/(1+$);E=.8*C*V+.2*E,y=.8*U*V+.2*y,l=h(S)}function b(){a(l),a(A);var T=r();x=T.x,L=T.y,d=Date.now(),(E<-s||E>s)&&(v=c*E,x+=v),(y<-s||y>s)&&(M=c*y,L+=M),A=h(N)}function N(){var T=Date.now()-d,$=!1,B=0,C=0;v&&(B=-v*Math.exp(-T/g),B>.5||B<-.5?$=!0:B=v=0),M&&(C=-M*Math.exp(-T/g),C>.5||C<-.5?$=!0:C=M=0),$&&(n(x+B,L+C),A=h(N))}}function e(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function t(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(r){return setTimeout(r,16)}}return Pe}var Fe,Mt;function Dn(){if(Mt)return Fe;Mt=1,Fe=p;function p(r){if(r)return{capture:t,release:t};var n,o,s,c=!1;return{capture:a,release:h};function a(u){c=!0,o=window.document.onselectstart,s=window.document.ondragstart,window.document.onselectstart=e,n=u,n.ondragstart=e}function h(){c&&(c=!1,window.document.onselectstart=o,n&&(n.ondragstart=s))}}function e(r){return r.stopPropagation(),!1}function t(){}return Fe}var Ve,Nt;function Pn(){if(Nt)return Ve;Nt=1,Ve=p;function p(){this.x=0,this.y=0,this.scale=1}return Ve}var Le={exports:{}},At;function Fn(){if(At)return Le.exports;At=1,Le.exports=p,Le.exports.canAttach=e;function p(t,r){if(!e(t))throw new Error("svg element is required for svg.panzoom to work");var n=t.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");r.disableKeyboardInteraction||n.setAttribute("tabindex",0);var o={getBBox:c,getScreenCTM:a,getOwner:s,applyTransform:u,initTransform:h};return o;function s(){return n}function c(){var d=t.getBBox();return{left:d.x,top:d.y,width:d.width,height:d.height}}function a(){var d=n.getCTM();return d||n.getScreenCTM()}function h(d){var g=t.getCTM();g===null&&(g=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),d.x=g.e,d.y=g.f,d.scale=g.a,n.removeAttributeNS(null,"viewBox")}function u(d){t.setAttribute("transform","matrix("+d.scale+" 0 0 "+d.scale+" "+d.x+" "+d.y+")")}}function e(t){return t&&t.ownerSVGElement&&t.getCTM}return Le.exports}var Se={exports:{}},Rt;function Vn(){if(Rt)return Se.exports;Rt=1,Se.exports=p,Se.exports.canAttach=e;function p(t,r){var n=e(t);if(!n)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var o=t.parentElement;t.scrollTop=0,r.disableKeyboardInteraction||o.setAttribute("tabindex",0);var s={getBBox:a,getOwner:c,applyTransform:h};return s;function c(){return o}function a(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function h(u){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+u.scale+", 0, 0, "+u.scale+", "+u.x+", "+u.y+")"}}function e(t){return t&&t.parentElement&&t.style}return Se.exports}var Ze,kt;function Zn(){if(kt)return Ze;kt=1;var p=In(),e=Bn(),t=zn(),r=On(),n=Dn(),o=n(),s=n(!0),c=Pn(),a=Fn(),h=Vn(),u=1,d=1.75,g=300,l=200;Ze=E;function E(S,b){b=b||{};var N=b.controller;if(N||(a.canAttach(S)?N=a(S,b):h.canAttach(S)&&(N=h(S,b))),!N)throw new Error("Cannot create panzoom for the current type of dom element");var T=N.getOwner(),$={x:0,y:0},B=!1,C=new c;N.initTransform&&N.initTransform(C);var U=typeof b.filterKey=="function"?b.filterKey:y,V=typeof b.pinchSpeed=="number"?b.pinchSpeed:1,D=b.bounds,k=typeof b.maxZoom=="number"?b.maxZoom:Number.POSITIVE_INFINITY,P=typeof b.minZoom=="number"?b.minZoom:0,Z=typeof b.boundsPadding=="number"?b.boundsPadding:.05,q=typeof b.zoomDoubleClickSpeed=="number"?b.zoomDoubleClickSpeed:d,ne=b.beforeWheel||y,re=b.beforeMouseDown||y,Ee=typeof b.zoomSpeed=="number"?b.zoomSpeed:u,_=x(b.transformOrigin),Te=b.enableTextSelection?s:o;L(D),b.autocenter&&Pt();var oe,He=0,We=0,ie=0,Ge=null,je=new Date,Me,ae=!1,se=!1,W,G,Ne,Ae,Re,j;"smoothScroll"in b&&!b.smoothScroll?j=I():j=r(Yt,Jt,b.smoothScroll);var ke,ce,me,pe=!1;Je();var ge={dispose:en,moveBy:J,moveTo:Ie,smoothMoveTo:Qt,centerOn:Xt,zoomTo:we,zoomAbs:ve,smoothZoom:xe,smoothZoomAbs:cn,showRectangle:Dt,pause:Bt,resume:zt,isPaused:Ot,getTransform:Ft,getMinZoom:Vt,setMinZoom:Zt,getMaxZoom:qt,setMaxZoom:Ht,getTransformOrigin:Wt,setTransformOrigin:Gt,getZoomSpeed:jt,setZoomSpeed:_t};t(ge);var _e=typeof b.initialX=="number"?b.initialX:C.x,Ye=typeof b.initialY=="number"?b.initialY:C.y,Ue=typeof b.initialZoom=="number"?b.initialZoom:C.scale;return(_e!=C.x||Ye!=C.y||Ue!=C.scale)&&ve(_e,Ye,Ue),ge;function Bt(){et(),pe=!0}function zt(){pe&&(Je(),pe=!1)}function Ot(){return pe}function Dt(i){var f=T.getBoundingClientRect(),m=K(f.width,f.height),w=i.right-i.left,R=i.bottom-i.top;if(!Number.isFinite(w)||!Number.isFinite(R))throw new Error("Invalid rectangle");var z=m.x/w,O=m.y/R,F=Math.min(z,O);C.x=-(i.left+w/2)*F+m.x/2,C.y=-(i.top+R/2)*F+m.y/2,C.scale=F}function K(i,f){if(N.getScreenCTM){var m=N.getScreenCTM(),w=m.a,R=m.d,z=m.e,O=m.f;$.x=i*w-z,$.y=f*R-O}else $.x=i,$.y=f;return $}function Pt(){var i,f,m=0,w=0,R=Xe();if(R)m=R.left,w=R.top,i=R.right-R.left,f=R.bottom-R.top;else{var z=T.getBoundingClientRect();i=z.width,f=z.height}var O=N.getBBox();if(!(O.width===0||O.height===0)){var F=f/O.height,te=i/O.width,X=Math.min(te,F);C.x=-(O.left+O.width/2)*X+i/2+m,C.y=-(O.top+O.height/2)*X+f/2+w,C.scale=X}}function Ft(){return C}function Vt(){return P}function Zt(i){P=i}function qt(){return k}function Ht(i){k=i}function Wt(){return _}function Gt(i){_=x(i)}function jt(){return Ee}function _t(i){if(!Number.isFinite(i))throw new Error("Zoom speed should be a number");Ee=i}function Yt(){return{x:C.x,y:C.y}}function Ie(i,f){C.x=i,C.y=f,$e(),ee("pan"),Be()}function Ke(i,f){Ie(C.x+i,C.y+f)}function $e(){var i=Xe();if(i){var f=!1,m=Ut(),w=i.left-m.right;return w>0&&(C.x+=w,f=!0),w=i.right-m.left,w<0&&(C.x+=w,f=!0),w=i.top-m.bottom,w>0&&(C.y+=w,f=!0),w=i.bottom-m.top,w<0&&(C.y+=w,f=!0),f}}function Xe(){if(D){if(typeof D=="boolean"){var i=T.getBoundingClientRect(),f=i.width,m=i.height;return{left:f*Z,top:m*Z,right:f*(1-Z),bottom:m*(1-Z)}}return D}}function Ut(){var i=N.getBBox(),f=Kt(i.left,i.top);return{left:f.x,top:f.y,right:i.width*C.scale+f.x,bottom:i.height*C.scale+f.y}}function Kt(i,f){return{x:i*C.scale+C.x,y:f*C.scale+C.y}}function Be(){B=!0,oe=window.requestAnimationFrame(tn)}function Qe(i,f,m){if(A(i)||A(f)||A(m))throw new Error("zoom requires valid numbers");var w=C.scale*m;if(w<P){if(C.scale===P)return;m=P/C.scale}if(w>k){if(C.scale===k)return;m=k/C.scale}var R=K(i,f);if(C.x=R.x-m*(R.x-C.x),C.y=R.y-m*(R.y-C.y),D&&Z===1&&P===1)C.scale*=m,$e();else{var z=$e();z||(C.scale*=m)}ee("zoom"),Be()}function ve(i,f,m){var w=m/C.scale;Qe(i,f,w)}function Xt(i){var f=i.ownerSVGElement;if(!f)throw new Error("ui element is required to be within the scene");var m=i.getBoundingClientRect(),w=m.left+m.width/2,R=m.top+m.height/2,z=f.getBoundingClientRect(),O=z.width/2-w,F=z.height/2-R;J(O,F,!0)}function Qt(i,f){J(i-C.x,f-C.y,!0)}function J(i,f,m){if(!m)return Ke(i,f);ke&&ke.cancel();var w={x:0,y:0},R={x:i,y:f},z=0,O=0;ke=e(w,R,{step:function(F){Ke(F.x-z,F.y-O),z=F.x,O=F.y}})}function Jt(i,f){be(),Ie(i,f)}function en(){et()}function Je(){T.addEventListener("mousedown",ct,{passive:!1}),T.addEventListener("dblclick",st,{passive:!1}),T.addEventListener("touchstart",nt,{passive:!1}),T.addEventListener("keydown",tt,{passive:!1}),p.addWheelListener(T,ft,{passive:!1}),Be()}function et(){p.removeWheelListener(T,ft),T.removeEventListener("mousedown",ct),T.removeEventListener("keydown",tt),T.removeEventListener("dblclick",st),T.removeEventListener("touchstart",nt),oe&&(window.cancelAnimationFrame(oe),oe=0),j.cancel(),dt(),ht(),Te.release(),ze()}function tn(){B&&nn()}function nn(){B=!1,N.applyTransform(C),ee("transform"),oe=0}function tt(i){var f=0,m=0,w=0;if(i.keyCode===38?m=1:i.keyCode===40?m=-1:i.keyCode===37?f=1:i.keyCode===39?f=-1:i.keyCode===189||i.keyCode===109?w=1:(i.keyCode===187||i.keyCode===107)&&(w=-1),!U(i,f,m,w)){if(f||m){i.preventDefault(),i.stopPropagation();var R=T.getBoundingClientRect(),z=Math.min(R.width,R.height),O=.05,F=z*O*f,te=z*O*m;J(F,te)}if(w){var X=mt(w*100),z=_?ue():rn();we(z.x,z.y,X)}}}function rn(){var i=T.getBoundingClientRect();return{x:i.width/2,y:i.height/2}}function nt(i){if(on(i),le(),i.touches.length===1)return sn(i,i.touches[0]);i.touches.length===2&&(Re=at(i.touches[0],i.touches[1]),me=!0,rt())}function on(i){b.onTouch&&!b.onTouch(i)||(i.stopPropagation(),i.preventDefault())}function an(i){le(),!(b.onDoubleClick&&!b.onDoubleClick(i))&&(i.preventDefault(),i.stopPropagation())}function sn(i){We=new Date;var f=i.touches[0],m=Y(f);Me=m;var w=K(m.x,m.y);W=w.x,G=w.y,Ne=W,Ae=G,j.cancel(),rt()}function rt(){ae||(ae=!0,document.addEventListener("touchmove",ot),document.addEventListener("touchend",ye),document.addEventListener("touchcancel",ye))}function ot(i){if(i.touches.length===1){i.stopPropagation();var f=i.touches[0],m=Y(f),w=K(m.x,m.y),R=w.x-W,z=w.y-G;R!==0&&z!==0&&pt(),W=w.x,G=w.y,J(R,z)}else if(i.touches.length===2){me=!0;var O=i.touches[0],F=i.touches[1],te=at(O,F),X=1+(te/Re-1)*V,gt=Y(O),vt=Y(F);if(W=(gt.x+vt.x)/2,G=(gt.y+vt.y)/2,_){var m=ue();W=m.x,G=m.y}we(W,G,X),Re=te,i.stopPropagation(),i.preventDefault()}}function le(){ie&&(clearTimeout(ie),ie=0)}function it(i){if(b.onClick){le();var f=W-Ne,m=G-Ae,w=Math.sqrt(f*f+m*m);w>5||(ie=setTimeout(function(){ie=0,b.onClick(i)},g))}}function ye(i){if(le(),i.touches.length>0){var f=Y(i.touches[0]),m=K(f.x,f.y);W=m.x,G=m.y}else{var w=new Date;if(w-He<g)if(_){var f=ue();xe(f.x,f.y,q)}else xe(Me.x,Me.y,q);else w-We<l&&it(i);He=w,ze(),ht()}}function at(i,f){var m=i.clientX-f.clientX,w=i.clientY-f.clientY;return Math.sqrt(m*m+w*w)}function st(i){an(i);var f=Y(i);_&&(f=ue()),xe(f.x,f.y,q)}function ct(i){if(le(),!re(i)){if(Ge=i,je=new Date,ae)return i.stopPropagation(),!1;var f=i.button===1&&window.event!==null||i.button===0;if(f){j.cancel();var m=Y(i),w=K(m.x,m.y);return Ne=W=w.x,Ae=G=w.y,document.addEventListener("mousemove",lt),document.addEventListener("mouseup",ut),Te.capture(i.target||i.srcElement),!1}}}function lt(i){if(!ae){pt();var f=Y(i),m=K(f.x,f.y),w=m.x-W,R=m.y-G;W=m.x,G=m.y,J(w,R)}}function ut(){var i=new Date;i-je<l&&it(Ge),Te.release(),ze(),dt()}function dt(){document.removeEventListener("mousemove",lt),document.removeEventListener("mouseup",ut),se=!1}function ht(){document.removeEventListener("touchmove",ot),document.removeEventListener("touchend",ye),document.removeEventListener("touchcancel",ye),se=!1,me=!1,ae=!1}function ft(i){if(!ne(i)){j.cancel();var f=i.deltaY;i.deltaMode>0&&(f*=100);var m=mt(f);if(m!==1){var w=_?ue():Y(i);we(w.x,w.y,m),i.preventDefault()}}}function Y(i){var f,m,w=T.getBoundingClientRect();return f=i.clientX-w.left,m=i.clientY-w.top,{x:f,y:m}}function xe(i,f,m){var w=C.scale,R={scale:w},z={scale:m*w};j.cancel(),be(),ce=e(R,z,{step:function(O){ve(i,f,O.scale)},done:ln})}function cn(i,f,m){var w=C.scale,R={scale:w},z={scale:m};j.cancel(),be(),ce=e(R,z,{step:function(O){ve(i,f,O.scale)}})}function ue(){var i=T.getBoundingClientRect();return{x:i.width*_.x,y:i.height*_.y}}function we(i,f,m){return j.cancel(),be(),Qe(i,f,m)}function be(){ce&&(ce.cancel(),ce=null)}function mt(i){var f=Math.sign(i),m=Math.min(.25,Math.abs(Ee*i/128));return 1-f*m}function pt(){se||(ee("panstart"),se=!0,j.start())}function ze(){se&&(me||j.stop(),ee("panend"))}function ln(){ee("zoomend")}function ee(i){ge.fire(i,ge)}}function x(S){if(S){if(typeof S=="object")return(!M(S.x)||!M(S.y))&&v(S),S;v()}}function v(S){throw console.error(S),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function y(){}function L(S){var b=typeof S;if(!(b==="undefined"||b==="boolean")){var N=M(S.left)&&M(S.top)&&M(S.bottom)&&M(S.right);if(!N)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function M(S){return Number.isFinite(S)}function A(S){return Number.isNaN?Number.isNaN(S):S!==S}function I(){return{start:y,stop:y,cancel:y}}function H(){if(typeof document>"u")return;var S=document.getElementsByTagName("script");if(!S)return;for(var b,N=0;N<S.length;++N){var T=S[N];if(T.src&&T.src.match(/\bpanzoom(\.min)?\.js/)){b=T;break}}if(!b)return;var $=b.getAttribute("query");if(!$)return;var B=b.getAttribute("name")||"pz",C=Date.now();U();function U(){var k=document.querySelector($);if(!k){var P=Date.now(),Z=P-C;if(Z<2e3){setTimeout(U,100);return}console.error("Cannot find the panzoom element",B);return}var q=V(b);console.log(q),window[B]=E(k,q)}function V(k){for(var P=k.attributes,Z={},q=0;q<P.length;++q){var ne=P[q],re=D(ne);re&&(Z[re.name]=re.value)}return Z}function D(k){if(k.name){var P=k.name[0]==="p"&&k.name[1]==="z"&&k.name[2]==="-";if(P){var Z=k.name.substr(3),q=JSON.parse(k.value);return{name:Z,value:q}}}}}return H(),Ze}var qn=Zn();const Hn=kn(qn);class Wn{pz;currentScale=1;currentX=0;currentY=0;constructor(e,t,r){this.pz=Hn(e,{maxZoom:3,minZoom:.2,bounds:!1,beforeMouseDown:o=>o.target.closest(".db-table")!==null});const n=o=>{const s=o.getTransform();this.currentScale=s.scale,this.currentX=s.x||0,this.currentY=s.y||0,t(this.currentScale),r&&r(this.currentScale,this.currentX,this.currentY)};this.pz.on("zoom",n),this.pz.on("pan",n),this.pz.on("transform",n),this.resetView()}getScale(){return this.currentScale}getTransform(){return{scale:this.currentScale,x:this.currentX,y:this.currentY}}setTransform(e,t,r){this.pz.zoomAbs(0,0,1),this.pz.moveTo(t,r),this.pz.zoomAbs(0,0,e),this.currentScale=e,this.currentX=t,this.currentY=r}zoomIn(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,1.25)}zoomOut(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.smoothZoom(e,t,.8)}resetView(){const e=window.innerWidth/2,t=window.innerHeight/2;this.pz.moveTo(e,t),this.pz.zoomAbs(0,0,1),this.currentX=e,this.currentY=t,this.currentScale=1}dispose(){this.pz.dispose()}}class It{el;container;constructor(e,t,r){this.container=e,this.el=document.createElement("div"),this.el.className="schema-hud";const n=document.createElement("div");n.className="hud-group";const o=this.createButton(Q.Grid,"Toggle Grid"),s=e.classList.contains("grid-visible");o.dataset.state=s?"on":"off",s&&o.classList.add("active"),o.onclick=()=>{const M=!(o.dataset.state==="on");o.dataset.state=M?"on":"off",o.classList.toggle("active",M),M?this.container.classList.add("grid-visible"):this.container.classList.remove("grid-visible"),this.dispatchProjectSettingsChange({showGrid:M})},n.appendChild(o);const c=document.createElement("div");c.className="hud-group";const a=[{value:"Curve",text:"Curve"},{value:"Rectilinear",text:"Rectilinear"},{value:"RoundRectilinear",text:"Round Rectilinear"},{value:"Oblique",text:"Oblique"},{value:"RoundOblique",text:"Round Oblique"}],h=document.createElement("div");h.className="custom-select";const u=document.createElement("div");u.className="select-trigger",u.title="Connection Line Style";const d=document.createElement("span");d.innerText="Curve",u.appendChild(d);const g=document.createElement("div");g.className="select-arrow",g.innerHTML=Q.ChevronUp,u.appendChild(g);const l=document.createElement("div");l.className="select-options",u.onclick=L=>{L.stopPropagation(),h.classList.toggle("open")},window.addEventListener("click",L=>{h.contains(L.target)||h.classList.remove("open")}),a.forEach(L=>{const M=document.createElement("div");M.className="select-option",M.innerText=L.text,M.onclick=()=>{d.innerText=L.text,h.querySelectorAll(".select-option").forEach(A=>A.classList.remove("selected")),M.classList.add("selected"),h.classList.remove("open"),r.setLineStyle(L.value),this.dispatchProjectSettingsChange({lineStyle:L.value})},L.value==="Curve"&&M.classList.add("selected"),l.appendChild(M)}),h.appendChild(u),h.appendChild(l),c.appendChild(h);const E=document.createElement("div");E.className="hud-group";const x=this.createButton(Q.ZoomIn,"Zoom In");x.onclick=()=>t.zoomIn();const v=this.createButton(Q.ZoomOut,"Zoom Out");v.onclick=()=>t.zoomOut();const y=this.createButton(Q.Center,"Reset View");y.onclick=()=>t.resetView(),E.append(v,y,x),this.el.append(n,c,E),e.appendChild(this.el)}createButton(e,t){const r=document.createElement("button");return r.className="hud-btn",r.innerHTML=e,r.title=t,r}dispatchProjectSettingsChange(e){const t=new CustomEvent("project-settings-changed",{detail:e});this.container.dispatchEvent(t)}}class Gn{static create(e){const t=document.createElement("div");t.className="sticky-note",t.id=`note-${e.id}`,t.dataset.noteId=e.name,t.style.left=`${e.x}px`,t.style.top=`${e.y}px`,t.style.width=`${e.width}px`,e.color&&(t.style.backgroundColor=e.color,t.style.color="#1f2937");const r=document.createElement("div");r.className="note-content",r.innerText=e.content,t.appendChild(r);const n=document.createElement("div");return n.className="resize-handle",t.appendChild(n),t}}class jn{container;wrapper;connectionManager;dragManager;panZoomManager;hud;parsers={dbml:new yn};constructor(e,t,r){this.container=document.getElementById(e),this.wrapper=document.createElement("div"),this.wrapper.className="schema-wrapper",this.container.appendChild(this.wrapper),this.connectionManager=new bt(this.wrapper),this.dragManager=new Rn(this.wrapper,this.connectionManager,t),this.panZoomManager=new Wn(this.wrapper,n=>{this.updateZoomState(n),this.dragManager.updateScale(n),this.connectionManager.updateScale(n)},(n,o,s)=>{this.updateZoomState(n,o,s),this.dragManager.updateScale(n),this.connectionManager.updateScale(n),r&&r(n,o,s)}),this.hud=new It(this.container,this.panZoomManager,this.connectionManager)}updateZoomState(e,t,r){e<.5?this.wrapper.classList.add("semantic-zoom"):this.wrapper.classList.remove("semantic-zoom"),this.container.style.setProperty("--zoom",e.toString()),t!==void 0&&r!==void 0&&(this.container.style.setProperty("--pan-x",`${t}px`),this.container.style.setProperty("--pan-y",`${r}px`))}render(e,t){this.wrapper.innerHTML="",this.connectionManager=new bt(this.wrapper),this.dragManager.updateConnectionManager(this.connectionManager);const r=this.panZoomManager.getTransform();if(this.connectionManager.updateScale(r.scale),this.dragManager.updateScale(r.scale),this.updateZoomState(r.scale),this.container.querySelector(".schema-hud")?.remove(),this.hud=new It(this.container,this.panZoomManager,this.connectionManager),this.container.style.setProperty("--zoom",r.scale.toString()),this.container.style.setProperty("--pan-x",`${r.x}px`),this.container.style.setProperty("--pan-y",`${r.y}px`),!!t.trim())try{let n=(e||"").toLowerCase().trim();n.startsWith(".")&&(n=n.slice(1));const o=this.parsers[n];if(!o)throw new Error(`Unsupported format: ${e}`);const{tables:s,relationships:c,projectSettings:a,notes:h}=o.parse(t);if(a){if(a.zoom!==void 0||a.panX!==void 0){const x=a.zoom||1,v=a.panX||0,y=a.panY||0;this.panZoomManager.setTransform(x,v,y),a.gridSize?this.container.style.setProperty("--grid-size",`${a.gridSize}px`):this.container.style.setProperty("--grid-size","20px"),this.container.style.setProperty("--zoom",x.toString()),this.container.style.setProperty("--pan-x",`${v}px`),this.container.style.setProperty("--pan-y",`${y}px`)}const l=a.showGrid===!0;l?this.container.classList.add("grid-visible"):this.container.classList.remove("grid-visible");const E=this.container.querySelector('.hud-btn[title="Toggle Grid"]');if(E&&(E.dataset.state=l?"on":"off",l?E.classList.add("active"):E.classList.remove("active")),a.lineStyle){this.connectionManager.setLineStyle(a.lineStyle);const x=this.container.querySelector(".select-trigger"),v=this.container.querySelectorAll(".select-option");x&&v.length&&(x.textContent=a.lineStyle,v.forEach(y=>{y.textContent===a.lineStyle?y.classList.add("selected"):y.classList.remove("selected")}))}h&&Array.isArray(h)&&h.forEach(x=>{const v=Gn.create(x);this.wrapper.appendChild(v)})}const u=350,d=300,g=3;s.forEach((l,E)=>{const x=Mn.create(l);this.wrapper.appendChild(x);let v=l.x!==void 0?l.x:50+E%g*u,y=l.y!==void 0?l.y:50+Math.floor(E/g)*d;if(x.style.left=`${v}px`,x.style.top=`${y}px`,l.width&&(x.style.width=`${l.width}px`),l.color){const L=x.querySelector(".db-table-header");L&&(L.style.backgroundColor=l.color)}}),this.dragManager.setRelationships(c),setTimeout(()=>{this.connectionManager.draw(c)},0)}catch(n){console.error(n),this.wrapper.innerHTML=`<div class="error" style="padding:20px; color:red;">Error: ${n.message}</div>`}}}const qe=new un(p=>{switch(p.type){case"UPDATE_CONTENT":_n.render(p.format,p.content);break;case"UPDATE_THEME":Un(p.theme);break}}),_n=new jn("app",(p,e,t,r)=>{qe.send({type:"UPDATE_TABLE_POS",tableName:p,x:e,y:t,width:r})}),Yn=document.getElementById("app");Yn.addEventListener("project-settings-changed",p=>{const e=p.detail||{};qe.send({type:"UPDATE_PROJECT_SETTINGS",settings:{lineStyle:e.lineStyle,showGrid:e.showGrid}})});function Un(p){p==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")}qe.log("Webview Initialized & Ready");</script>
  <style rel="stylesheet" crossorigin>:root{--icon-pk: #d97706;--icon-fk: #2563eb;--icon-pk-fk: #16a34a;--icon-default: var(--text-secondary)}body.dark{--icon-pk: #fbbf24;--icon-fk: #60a5fa;--icon-pk-fk: #4ade80}.icon-container svg{width:100%;height:100%;display:block;fill:none;stroke:currentColor;stroke-width:2px;stroke-linecap:round;stroke-linejoin:round}.icon-container.fill-mode svg{fill:currentColor;stroke:none}.key-icon{width:14px;height:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px;color:var(--icon-default)}.key-icon svg{width:100%;height:100%;stroke:currentColor;fill:none}.key-icon.pk{color:var(--icon-pk)}.key-icon.fk{color:var(--icon-fk)}.key-icon.pk-fk{color:var(--icon-pk-fk)}.key-icon.empty{width:14px}.table-icon{width:16px;height:16px;display:flex;align-items:center;justify-content:center;opacity:.9;color:var(--header-text)}.table-icon svg{width:100%;height:100%;stroke:currentColor;fill:none}.hud-btn svg,.select-arrow svg{width:18px;height:18px;stroke:currentColor;fill:none}.select-arrow svg{width:12px;height:12px}.db-table{--table-main-color: var(--header-bg);position:absolute;top:0;left:0;min-width:200px;width:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 6px #0000001a;z-index:1;display:flex;flex-direction:column}.db-table.dragging,.db-table.resizing{box-shadow:0 10px 15px #0003;z-index:100}.db-table.dragging{cursor:grabbing}.db-table.resizing{cursor:col-resize}.db-table-header{background:var(--header-bg);background-color:var(--table-main-color);color:var(--header-text);padding:10px;font-weight:700;border-top-left-radius:7px;border-top-right-radius:7px;cursor:grab;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:8px}.db-table-header:active{cursor:grabbing}.header-title-wrapper{display:flex;align-items:center;gap:6px}.table-icon{width:16px;height:16px;display:flex;opacity:.9}.title{font-size:15px;line-height:1.2}.schema-banner{background:#fff3;padding:2px 6px;border-radius:4px;font-size:12px}.table-note{font-size:11px;color:#fffc;margin-top:4px;width:100%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.resize-handle{position:absolute;top:0;right:0;width:12px;height:100%;cursor:col-resize;z-index:50;background:transparent;border-right:4px solid rgba(0,0,0,.1);transition:all .2s;border-top-right-radius:8px;border-bottom-right-radius:8px}.resize-handle:hover,.db-table.resizing .resize-handle{background-color:#3b82f61a;border-right:4px solid var(--header-bg)}.semantic-overlay{position:absolute;inset:-1px;background-color:var(--table-main-color);color:#fff;border-radius:8px;z-index:200;display:flex;justify-content:center;align-items:center;text-align:center;padding:10px;opacity:0;pointer-events:none;transition:opacity .25s ease-in-out}.overlay-text{font-weight:700;font-size:clamp(16px,calc(18px / var(--zoom)),64px);word-break:break-word;line-height:1.2;text-shadow:0 2px 4px rgba(0,0,0,.2)}.schema-wrapper.semantic-zoom .semantic-overlay{opacity:1;pointer-events:auto;cursor:grab}.schema-wrapper.semantic-zoom .db-table.dragging .semantic-overlay{cursor:grabbing}.db-row{display:flex;justify-content:space-between;padding:6px;border-bottom:1px solid var(--table-border);font-size:12px;line-height:1.2;position:relative;transition:background-color .15s ease}.db-row:hover{background-color:#7d7d7d0d}.db-row:last-child{border-bottom:none;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.indexed-row{background:linear-gradient(to right,rgba(var(--header-rgb),.08),transparent)}.row-left{display:flex;align-items:flex-start;gap:8px;flex:1;min-width:0;padding-right:8px}.name-container{display:flex;flex-direction:column;overflow:hidden}.field-name{font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.field-note{font-size:11px;color:var(--text-secondary);margin-top:2px;line-height:1.2;font-style:italic;opacity:.8}.row-right{display:flex;align-items:flex-start;justify-content:flex-end;gap:6px;flex-shrink:0}.type-container{display:flex;flex-direction:column;align-items:flex-end}.field-type{color:var(--text-secondary);font-size:11px;font-family:SF Mono,Monaco,Menlo,Courier New,monospace;text-align:right;background:#9696961a;padding:1px 4px;border-radius:4px}.constrained-type{text-decoration-color:var(--header-bg);text-decoration-thickness:2px}.field-default{font-size:10px;color:var(--text-secondary);opacity:.7;text-align:right;margin-top:2px;max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.badge{font-size:9px;height:12px;padding:0 6px;display:flex;align-items:center;justify-content:center;border-radius:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;box-shadow:0 1px 2px #0000000d}.badge.unique{background:#f3e8ff;color:#7e22ce;border:1px solid rgba(126,34,206,.1)}.badge.not-null{background:#f3f4f6;color:#4b5563;border:1px solid rgba(75,85,99,.1)}.badge.enum{background:#ecfdf5;color:#047857;border:1px solid rgba(4,120,87,.1)}body.dark .db-row:hover{background-color:#ffffff0d}body.dark .field-type{background:#ffffff14;color:#a1a1aa}body.dark .badge.unique{background:#3b0764;color:#d8b4fe;border-color:#581c87}body.dark .badge.not-null{background:#374151;color:#e5e7eb;border-color:#4b5563}body.dark .badge.enum{background:#064e3b;color:#6ee7b7;border-color:#065f46}@keyframes flashHighlight{0%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}50%{box-shadow:inset 3px 0 0 var(--header-bg),0 0 12px rgba(var(--header-rgb),.4)}to{box-shadow:inset 3px 0 0 var(--header-bg),0 0 #0000}}.db-row.highlighted{background-color:rgba(var(--header-rgb),.1);color:var(--text-primary);animation:flashHighlight 1.5s infinite;z-index:10}.db-table.highlighted{border-color:var(--header-bg);animation:flashTable 1.5s infinite;z-index:20}@keyframes flashTable{0%{box-shadow:0 4px 6px #0000001a}50%{box-shadow:0 0 15px rgba(var(--header-rgb),.6)}to{box-shadow:0 4px 6px #0000001a}}.connection-layer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:visible}.connection-group{pointer-events:auto;cursor:pointer}.relation-hit-area{fill:none;stroke:transparent;stroke-width:20px}.relation-line-base{fill:none;stroke:var(--line-color);stroke-width:2px;stroke-linecap:round;transition:stroke .3s,stroke-width .3s}.relation-line-flow{fill:none;stroke:var(--header-bg);stroke-width:2px;stroke-linecap:round;stroke-dasharray:15 150;opacity:.4;animation:flowAnimation 5s linear infinite}@keyframes flowAnimation{to{stroke-dashoffset:165}}@keyframes continuousFlow{to{stroke-dashoffset:24}}.connection-group.highlighted .relation-line-base{stroke:var(--header-bg);stroke-width:3px;opacity:.5}.connection-group.highlighted .relation-line-flow{opacity:1;stroke-width:3px;stroke-dasharray:12 12;animation:continuousFlow .8s linear infinite;filter:drop-shadow(0 0 4px var(--header-bg))}.anchor-port{fill:var(--bg-color);stroke:var(--line-color);stroke-width:2px;transition:all .3s}.anchor-port.highlighted{stroke:var(--header-bg);fill:var(--header-bg);r:5px;filter:drop-shadow(0 0 3px var(--header-bg))}.label-bg{fill:var(--bg-color);stroke:var(--table-border);transition:all .3s}.connection-group.highlighted .label-bg{stroke:var(--header-bg);fill:#fff}.relation-label-text{font-size:10px;font-weight:700;fill:var(--text-secondary);text-anchor:middle;dominant-baseline:middle;pointer-events:none}.connection-group.highlighted .relation-label-text{fill:var(--header-bg)}.sticky-note{position:absolute;min-height:100px;padding:12px;border-radius:2px;box-shadow:0 4px 8px #00000026;font-family:Comic Sans MS,Marker Felt,sans-serif;font-size:13px;line-height:1.5;z-index:5;display:flex;flex-direction:column;cursor:grab;transition:box-shadow .2s,transform .1s;background-image:linear-gradient(#fff6,#fff0)}.sticky-note:active,.sticky-note.dragging{cursor:grabbing;box-shadow:0 10px 20px #0003;transform:scale(1.02);z-index:50}.note-content{white-space:pre-wrap;width:100%;height:100%;overflow:hidden;pointer-events:none}.sticky-note .resize-handle{position:absolute;bottom:0;right:0;width:15px;height:15px;cursor:nwse-resize;background:linear-gradient(135deg,transparent 50%,rgba(0,0,0,.1) 50%);border-radius:0 0 2px}.schema-hud{position:absolute;bottom:20px;left:20px;right:auto;background:var(--table-bg);border:1px solid var(--table-border);border-radius:8px;box-shadow:0 4px 12px #00000026;display:flex;flex-direction:row;align-items:center;padding:6px 12px;gap:12px;z-index:1000;-webkit-user-select:none;user-select:none}.hud-group{display:flex;gap:6px;align-items:center}.hud-group+.hud-group{border-top:none;margin-top:0;border-left:1px solid var(--table-border);padding-left:12px;margin-left:0}.hud-btn{background:transparent;border:1px solid transparent;border-radius:4px;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;cursor:pointer;transition:all .12s;color:var(--text-primary)}.hud-btn:hover,.hud-btn.active{background:rgba(var(--header-rgb),.1);color:var(--header-bg)}.hud-btn:hover{color:var(--header-bg)}.custom-select{position:relative;font-size:12px;min-width:120px}.select-trigger{background:var(--bg-color);color:var(--text-primary);border:1px solid var(--table-border);border-radius:4px;padding:0 8px;cursor:pointer;white-space:nowrap;position:relative;height:28px;display:flex;align-items:center;gap:6px;min-width:100px;justify-content:space-between}.select-arrow{width:12px;height:12px;opacity:.6;display:flex;align-items:center;justify-content:center}.select-options{display:none;position:absolute;bottom:100%;left:0;margin-bottom:8px;background:var(--table-bg);border:1px solid var(--table-border);border-radius:6px;box-shadow:0 -4px 12px #00000026;width:100%;min-width:140px;overflow:hidden;z-index:1001;flex-direction:column}.custom-select.open .select-options{display:flex}.select-option{padding:8px 12px;cursor:pointer;color:var(--text-primary);transition:background .1s}.select-option:hover{background:rgba(var(--header-rgb),.1);color:var(--header-bg)}.select-option.selected{font-weight:700;background:rgba(var(--header-rgb),.05);color:var(--header-bg)}:root{--bg-color: #f4f4f4;--table-bg: #ffffff;--table-border: #d1d5db;--header-bg: #3b82f6;--header-rgb: 59, 130, 246;--header-text: #ffffff;--text-primary: #1f2937;--text-secondary: #6b7280;--line-color: #9ca3af;--grid-line: rgba(0, 0, 0, .04);--axis-line: rgba(0, 0, 0, .08)}body.dark{--bg-color: #1e1e1e;--table-bg: #2b2d30;--table-border: #4e5256;--header-bg: #3574f0;--header-rgb: 53, 116, 240;--header-text: #ffffff;--text-primary: #d1d5db;--text-secondary: #9ca3af;--line-color: #6b7280;--grid-line: rgba(255, 255, 255, .04);--axis-line: rgba(255, 255, 255, .08)}body{margin:0;background:var(--bg-color);color:var(--text-primary);font-family:sans-serif;overflow:hidden}#app{width:100vw;height:100vh;overflow:hidden;position:relative;--zoom: 1;--pan-x: 0px;--pan-y: 0px;--grid-size: 20px}#app.grid-visible{background-image:linear-gradient(to right,var(--axis-line) 2px,transparent 2px),linear-gradient(to bottom,var(--axis-line) 2px,transparent 2px),linear-gradient(to right,var(--grid-line) 1px,transparent 1px),linear-gradient(to bottom,var(--grid-line) 1px,transparent 1px);background-repeat:no-repeat,no-repeat,repeat,repeat;background-position:var(--pan-x) 0,0 var(--pan-y),var(--pan-x) var(--pan-y),var(--pan-x) var(--pan-y);background-size:2px 100%,100% 2px,calc(var(--grid-size) * var(--zoom)) calc(var(--grid-size) * var(--zoom)),calc(var(--grid-size) * var(--zoom)) calc(var(--grid-size) * var(--zoom))}.schema-wrapper{width:100%;height:100%;transform-origin:0 0;position:relative}</style>
</head>

<body>
<div id="app"></div>
</body>

</html>
